import{d as h,_ as v,r as g,o as s,K as l,a as o,w as b,aA as y,N as d,c as I,e as i,a7 as a,f as r,ar as u,t as c,M as D,L as T,af as p}from"./index.cb4db607.js";import{Q as M}from"./QPage.c8b96aad.js";import{u as E,a as C}from"./backend_connection.1b13fdb1.js";import{P as S}from"./ProfilePimsDetailForm.454b81f2.js";import"./axios.6e1fcf85.js";const $=h({name:"ProfilePimsDetailDialogComponent",components:{ProfilePimsDetailForm:S},setup(){},data(){return{enterpimsdialog:{visible:!1}}},methods:{launch_dialog(){this.enterpimsdialog.visible=!0;const e=this;setTimeout(function(){e.$refs.ProfilePimsDetailForm.blank_data()},10)},enterpimsdialogclick(){this.enterpimsdialog.visible=!1}}});function A(e,t,m,f,k,P){const _=g("ProfilePimsDetailForm");return s(),l("div",null,[o(y,{modelValue:e.enterpimsdialog.visible,"onUpdate:modelValue":t[0]||(t[0]=n=>e.enterpimsdialog.visible=n),persistent:""},{default:b(()=>[o(_,{ref:"ProfilePimsDetailForm",onProcess_done:e.enterpimsdialogclick,onClick_cancel:e.enterpimsdialogclick},null,8,["onProcess_done","onClick_cancel"])]),_:1},8,["modelValue"])])}var F=v($,[["render",A]]);const L=h({name:"ProfilePage",setup(){return{backend_connection_store:E()}},components:{ProfilePimsDetailDialog:F},data(){return{}},computed:{isLoggedin(){return this.backend_connection_store.isLoggedin},user_profile(){return this.backend_connection_store.user_profile},pimsverfiylink(){const e=window.location.origin+"/#/v/"+this.user_profile.pims.verify_code+"/"+this.user_profile.pims.number;return"Robert - Please verify my PIMS "+this.user_profile.pims.first_name+"/"+this.user_profile.pims.last_name+" ("+this.user_profile.pims.number+') <a href="'+e+'" target="_new">'+e+"</a>"}},methods:{clickcopypimsverfiylink(){const e=this,t={ok:function(m){d.create({color:"bg-grey-2",message:"Copied text to clipboard "+e.pimsverfiylink,timeout:2e3})},error:function(m){d.create({color:"negative",message:"Copy to clipboard failed",timeout:2e3})}};C.copyTextToClipboard2(this.pimsverfiylink,t)},logout(){this.backend_connection_store.logout(),this.$router.push("/tools")},clickenterpimsinformation(){this.$refs.ProfilePimsDetailDialog.launch_dialog()},pimsinfo(){const e=this;let t="Enter PIMS details";this.user_profile.pims.state==="WAITINGVERIFICATION"&&(t="Change PIMS details"),this.$q.dialog({title:"PIMS Membership Details",message:"Extra site features are available to users who have a verified PIMS membership.",html:!0,ok:{push:!0,label:t,color:"secondary"},cancel:{push:!0,label:"Close",color:"primary"}}).onOk(()=>{e.clickenterpimsinformation()})},deleteaccount(){const e=this;this.$q.dialog({title:"Delete Account",message:"Deleting your account will wipe all your user data from our system. This inclues all saved properties. Are you sure? (Type DELETE below to confirm)",html:!1,ok:{push:!0,label:"Delete",color:"red"},cancel:{push:!0,label:"Cancel",color:"primary"},prompt:{model:"",type:"text"}}).onOk(t=>{if(t.trim()!=="DELETE"){d.create({color:"red",message:"Failed - You must type DELETE in the text box",timeout:2e3});return}const m={ok:function(f){e.logout(),d.create({color:"bg-grey-2",message:"User account deleted",timeout:2e3})},error:function(f){d.create({color:"bg-grey-2",message:"Account deletion failed "+f,timeout:2e3})}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/delete",method:"GET",data:t,callback:m})})}},mounted(){this.isLoggedin||this.$router.push("/tools")}}),N={rows:""},w=i("h3",{style:{margin:"0px"}},"User Profile",-1),V={key:0,class:"notice"},R=i("h4",null,"Details",-1),B={class:"section"},z={class:"section"},O={key:0},x=i("div",null,"PIMS Membership details not entered - Extra site features are available to Academy/PIMS members.",-1),Q={align:"center"},U={key:1},G=i("div",null,"PIMS details entered but not verified. To verify please send a message in the Samuel Leeds Academy chat with the following text:",-1),q=["innerHTML"],H={key:2},W=i("div",null,[i("h5",null,"PIMS member")],-1),K={key:3},Y=i("div",null,"Extra site features are available to Academy/PIMS members. PIMS Membership details verification failed",-1),j={align:"center"},J={class:"bottom-buttons"};function X(e,t,m,f,k,P){const _=g("ProfilePimsDetailDialog");return s(),I(M,{class:"flex flex-center"},{default:b(()=>[i("div",N,[w,e.user_profile.pims.state!=="VERIFIED"?(s(),l("div",V,[o(a,{name:"info",size:"md",color:"green"}),r(" Enter and verify your PIMS membership details to activate Property Pipeline Builder early access.")])):u("",!0),R,i("div",B,[i("div",null,"User: "+c(e.user_profile.name),1),i("div",null,"Email: "+c(e.user_profile.email),1),i("div",null,[r("Roles: "),i("ul",null,[(s(!0),l(T,null,D(e.user_profile.roles,n=>(s(),l("div",{key:n},[i("li",null,c(n),1)]))),128))])])]),i("div",z,[i("h4",null,[r("PIMS Membership "),o(p,{round:"",dense:"",flat:"",icon:"info",onClick:e.pimsinfo},null,8,["onClick"])]),e.user_profile.pims.state==="NOTENTERED"?(s(),l("div",O,[x,i("div",Q,[o(p,{label:"Enter PIMS information",color:"primary",onClick:e.clickenterpimsinformation},null,8,["onClick"])]),i("div",null,[r("PIMS Membership verified: "),o(a,{name:"cancel",color:"red",size:"32px"})])])):u("",!0),e.user_profile.pims.state==="WAITINGVERIFICATION"?(s(),l("div",U,[G,i("div",{class:"pimstext",onClick:t[0]||(t[0]=(...n)=>e.clickcopypimsverfiylink&&e.clickcopypimsverfiylink(...n))},[i("div",{innerHTML:e.pimsverfiylink},null,8,q),r("\xA0 "),o(a,{class:"float-right",name:"content_copy",size:"16px"})]),i("div",null,[r("PIMS Membership verified: "),o(a,{name:"cancel",color:"red",size:"32px"})])])):u("",!0),e.user_profile.pims.state==="VERIFIED"?(s(),l("div",H,[W,i("div",null,c(e.user_profile.pims.first_name)+" "+c(e.user_profile.pims.last_name)+" - PIMS number "+c(e.user_profile.pims.number),1),i("div",null,[r("PIMS Membership verified: "),o(a,{name:"check_box",color:"green",size:"32px"})])])):u("",!0),e.user_profile.pims.state==="VERIFICATIONFAILED"?(s(),l("div",K,[Y,i("div",j,[o(p,{label:"Retry entering PIMS information",color:"primary",onClick:e.clickenterpimsinformation},null,8,["onClick"])]),i("div",null,[r("PIMS Membership verified: "),o(a,{name:"cancel",color:"red",size:"32px"})])])):u("",!0)]),i("div",J,[o(p,{class:"bottom-button",onClick:e.logout,color:"secondary",label:"Logout"},null,8,["onClick"]),o(p,{class:"bottom-button",onClick:e.deleteaccount,color:"red",label:"Delete my account"},null,8,["onClick"])])]),o(_,{ref:"ProfilePimsDetailDialog"},null,512)]),_:1})}var se=v(L,[["render",X]]);export{se as default};
