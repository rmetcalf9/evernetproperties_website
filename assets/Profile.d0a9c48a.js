import{d as v,N as c,_ as k,o as l,K as d,a,w as h,a7 as I,ag as y,ae as u,e as o,af as m,bc as M,f as r,aw as T,an as E,ax as D,r as S,c as V,a8 as p,ar as g,t as f,M as A,L as N}from"./index.2bd747a3.js";import{Q as $}from"./QPage.94e01773.js";import{u as P,a as F}from"./backend_connection.c8337322.js";import{C as L}from"./ClosePopup.1500799d.js";import{a as R}from"./axios.6e1fcf85.js";var _={early_access:{title:"Early Access Terms and Conditions",html:`
      <h1>Early Access</h1>

      <p>This is an early access product and features are subject to change. Features may be added, removed or moved. As part of the program we hope to gain your feedback in order to shape future versions of the product.</p>

      <h1>User account</h1>
      <p>Your user account is verified against your PIMS membership and you may not share access to your account with any third parties. We may at any time withdraw or pause access to your user account. You may delete your user account at any time by using the provided option in your user profile. This will result in loss of access to data stored in the system.</p>

      <h1>Responsibility</h1>
      <p>You are solely responsible for your use of the service and its outputs.</p>

      <h1>Data</h1>
      <p>By signing up for the early access program you are consenting for Evernet Properties to store and process your data for the purposes of operating the system. We will not make use of the data stored in your projects except where you have given consent.</p>

      <p>We may share the data with third parties for the purpose of providing extra details of the deal. Examples include and are not limited to. sharing location to generate maps and sharing address to generate valuation reports.</p>

      <h1>Data Breaches</h1>
      <p>We commit to using best practices when storing your user data. We accept no liability for consequences for data breaches but will endeavour to notify users when these occur.</p>

    `}};const U={email:"We collect your email address so that we can contact you with updates on the service.",phone:"We collect your phone number as we may call you to find out how you are getting on."},W=v({name:"ProfilePimsDetailDialogComponent",setup(){return{backend_connection_store:P()}},data(){return{enterpimsdialog:{visible:!1,number:"",first_name:"",last_name:"",phone:"",email:"",company_name:"",agreetoc:!1}}},methods:{notify_why(e){this.$q.dialog({title:void 0,message:U[e],html:!1}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})},show_toc(){this.$q.dialog({title:_.early_access.title,message:'<div class="toc_dialog">'+_.early_access.html+"</div>",html:!0,fullWidth:!0}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})},launch_dialog(){this.enterpimsdialog.number="",this.enterpimsdialog.first_name="",this.enterpimsdialog.last_name="",this.enterpimsdialog.phone="",this.enterpimsdialog.email="",this.enterpimsdialog.company_name="",this.enterpimsdialog.agreetoc=!1,this.enterpimsdialog.visible=!0},enterpimsdialogclick(){if(!this.enterpimsdialog.agreetoc)return;const e=["numberref","first_nameref","last_nameref","phoneref","emailref"];for(const n of e)this.$refs[n].validate();for(const n of e)if(this.$refs[n].hasError)return;const i={number:this.enterpimsdialog.number,first_name:this.enterpimsdialog.first_name,last_name:this.enterpimsdialog.last_name},s={ok:this.submitpimsinfo_success,error:this.submitpimsinfo_fail};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/pimsdetails",method:"POST",data:i,callback:s}),this.enterpimsdialog.visible=!1},submitpimsinfo_success(e){this.backend_connection_store.update_user_profile({user_profile:e.data});const i=window.location.origin+"/v/"+e.data.pims.verify_code+"/"+e.data.pims.number;var s=new FormData;s.append("xnQsjsdp","89e18b1e88ffaffedbeef0c32091b44516c268788a1971f957ab3e29b6e6e670"),s.append("zc_gad",""),s.append("xmIwtLD","5cda33fce5eaeaa7ca374dff23d1501c751fd3395004fbff2c04c9a8e9c4fa2b0672ff88667c9f8e63ae8860514dcb5b"),s.append("actionType","UG90ZW50aWFscw=="),s.append("returnURL",void 0),s.append("Potential Name",e.data.frontend_instance+" Website "+e.data.pims.last_name),s.append("Contacts.First Name",e.data.pims.first_name),s.append("Contacts.Last Name",e.data.pims.last_name),s.append("Contacts.Phone",this.enterpimsdialog.phone),s.append("Contacts.Email",this.enterpimsdialog.email),s.append("Contacts.CONTACTCF3",e.data.email),s.append("Accounts.Account Name",""),s.append("Contacts.CONTACTCF1",e.data.pims.number),s.append("Contacts.CONTACTCF2",e.data.id),s.append("POTENTIALCF3",i),s.append("Pipeline","PPB Early Access Signup Standard"),s.append("Stage","Signup Requested"),R({method:"post",url:"https://bigin.zoho.eu/crm/WebForm",data:s,headers:{"Content-Type":"multipart/form-data"}}).then(function(n){}).catch(function(n){console.log("Failed to register on CRM"),console.log(n)}),c.create({color:"bg-grey-2",message:"New PIMS details saved - Please request Verification by sending Whatsapp message on the academy group",timeout:2e3})},submitpimsinfo_fail(e){console.log("ERROR failed to update PIMS information ",e),c.create({color:"bg-grey-2",message:"Failed to update PIMS information "+e,timeout:2e3})}}}),O=o("div",{class:"text-h6"},"Your PIMS membership details to sign up for Early Access",-1),Q=o("div",null,[r("Details must match what appears on the "),o("a",{href:"https://www.thepims.co.uk/members/",target:"_new"},"PIMS website"),r(".")],-1),B={class:"row"},q={class:"row"};function z(e,i,s,n,C,w){return l(),d("div",null,[a(D,{modelValue:e.enterpimsdialog.visible,"onUpdate:modelValue":i[10]||(i[10]=t=>e.enterpimsdialog.visible=t),persistent:""},{default:h(()=>[a(I,null,{default:h(()=>[a(y,null,{default:h(()=>[O]),_:1}),a(y,{class:"q-pt-none"},{default:h(()=>[Q,a(u,{modelValue:e.enterpimsdialog.number,"onUpdate:modelValue":i[0]||(i[0]=t=>e.enterpimsdialog.number=t),label:"PIMS Number",rules:[t=>t.trim().length>4||"Minimum 5 characters",t=>t.trim().match(/^\d+$/)!==null||"Numeric characters only"],ref:"numberref"},null,8,["modelValue","rules"]),a(u,{modelValue:e.enterpimsdialog.first_name,"onUpdate:modelValue":i[1]||(i[1]=t=>e.enterpimsdialog.first_name=t),label:"First Name",rules:[t=>t.trim().length>1||"Minimum 2 characters"],ref:"first_nameref"},null,8,["modelValue","rules"]),a(u,{modelValue:e.enterpimsdialog.last_name,"onUpdate:modelValue":i[2]||(i[2]=t=>e.enterpimsdialog.last_name=t),label:"Last Name",rules:[t=>t.trim().length>1||"Minimum 2 characters"],ref:"last_nameref"},null,8,["modelValue","rules"]),o("div",B,[a(u,{modelValue:e.enterpimsdialog.phone,"onUpdate:modelValue":i[3]||(i[3]=t=>e.enterpimsdialog.phone=t),label:"Phone",rules:[t=>t.trim().length>1||"Minimum 6 characters"],ref:"phoneref",class:"col-grow"},null,8,["modelValue","rules"]),a(m,{round:"",dense:"",flat:"",icon:"info",onClick:i[4]||(i[4]=t=>e.notify_why("phone"))})]),o("div",q,[a(u,{modelValue:e.enterpimsdialog.email,"onUpdate:modelValue":i[5]||(i[5]=t=>e.enterpimsdialog.email=t),label:"Email",rules:[t=>t.trim().length>1||"Minimum 8 characters"],ref:"emailref",class:"col-grow"},null,8,["modelValue","rules"]),a(m,{round:"",dense:"",flat:"",icon:"info",onClick:i[6]||(i[6]=t=>e.notify_why("email"))})]),a(u,{modelValue:e.enterpimsdialog.company_name,"onUpdate:modelValue":i[7]||(i[7]=t=>e.enterpimsdialog.company_name=t),label:"Company Name",ref:"companyref"},null,8,["modelValue"]),a(M,{modelValue:e.enterpimsdialog.agreetoc,"onUpdate:modelValue":i[8]||(i[8]=t=>e.enterpimsdialog.agreetoc=t)},null,8,["modelValue"]),r("Agree to "),o("a",{href:"#",onClick:i[9]||(i[9]=(...t)=>e.show_toc&&e.show_toc(...t))},"Early Access terms and conditions")]),_:1}),a(T,{align:"right"},{default:h(()=>[E(a(m,{flat:"",label:"Cancel"},null,512),[[L]]),a(m,{flat:"",label:"Submit for Verification",color:"secondary",onClick:e.enterpimsdialogclick,disabled:!e.enterpimsdialog.agreetoc},null,8,["onClick","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Y=k(W,[["render",z]]);const G=v({name:"ProfilePage",setup(){return{backend_connection_store:P()}},components:{ProfilePimsDetailDialog:Y},data(){return{}},computed:{isLoggedin(){return this.backend_connection_store.isLoggedin},user_profile(){return this.backend_connection_store.user_profile},pimsverfiylink(){const e=window.location.origin+"/v/"+this.user_profile.pims.verify_code+"/"+this.user_profile.pims.number;return"Robert - Please verify my PIMS "+this.user_profile.pims.first_name+"/"+this.user_profile.pims.last_name+" ("+this.user_profile.pims.number+') <a href="'+e+'" target="_new">'+e+"</a>"}},methods:{clickcopypimsverfiylink(){const e=this,i={ok:function(s){c.create({color:"bg-grey-2",message:"Copied text to clipboard "+e.pimsverfiylink,timeout:2e3})},error:function(s){c.create({color:"negative",message:"Copy to clipboard failed",timeout:2e3})}};F.copyTextToClipboard2(this.pimsverfiylink,i)},logout(){this.backend_connection_store.logout(),this.$router.push("/tools")},clickenterpimsinformation(){this.$refs.ProfilePimsDetailDialog.launch_dialog()},pimsinfo(){const e=this;let i="Enter PIMS details";this.user_profile.pims.state==="WAITINGVERIFICATION"&&(i="Change PIMS details"),this.$q.dialog({title:"PIMS Membership Details",message:"Extra site features are available to users who have a verified PIMS membership.",html:!0,ok:{push:!0,label:i,color:"secondary"},cancel:{push:!0,label:"Close",color:"primary"}}).onOk(()=>{e.clickenterpimsinformation()})},deleteaccount(){const e=this;this.$q.dialog({title:"Delete Account",message:"Deleting your account will wipe all your user data from our system. This inclues all saved properties. Are you sure? (Type DELETE below to confirm)",html:!1,ok:{push:!0,label:"Delete",color:"red"},cancel:{push:!0,label:"Cancel",color:"primary"},prompt:{model:"",type:"text"}}).onOk(i=>{if(i.trim()!=="DELETE"){c.create({color:"red",message:"Failed - You must type DELETE in the text box",timeout:2e3});return}const s={ok:function(n){e.logout(),c.create({color:"bg-grey-2",message:"User account deleted",timeout:2e3})},error:function(n){c.create({color:"bg-grey-2",message:"Account deletion failed "+n,timeout:2e3})}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/delete",method:"GET",data:i,callback:s})})}},mounted(){this.isLoggedin||this.$router.push("/tools")}}),j={rows:""},H=o("h3",{style:{margin:"0px"}},"User Profile",-1),K={key:0,class:"notice"},Z=o("h4",null,"Details",-1),J={class:"section"},X={class:"section"},x={key:0},ee=o("div",null,"PIMS Membership details not entered - Extra site features are available to Academy/PIMS members.",-1),ie={align:"center"},te={key:1},oe=o("div",null,"PIMS details entered but not verified. To verify please send a message in the Samuel Leeds Academy chat with the following text:",-1),ae=["innerHTML"],se={key:2},ne=o("div",null,[o("h5",null,"PIMS member")],-1),re={key:3},le=o("div",null,"Extra site features are available to Academy/PIMS members. PIMS Membership details verification failed",-1),me={align:"center"},de={class:"bottom-buttons"};function ce(e,i,s,n,C,w){const t=S("ProfilePimsDetailDialog");return l(),V($,{class:"flex flex-center"},{default:h(()=>[o("div",j,[H,e.user_profile.pims.state!=="VERIFIED"?(l(),d("div",K,[a(p,{name:"info",size:"md",color:"green"}),r(" Enter and verify your PIMS membership details to activate Property Pipeline Builder early access.")])):g("",!0),Z,o("div",J,[o("div",null,"User: "+f(e.user_profile.name),1),o("div",null,"Email: "+f(e.user_profile.email),1),o("div",null,[r("Roles: "),o("ul",null,[(l(!0),d(N,null,A(e.user_profile.roles,b=>(l(),d("div",{key:b},[o("li",null,f(b),1)]))),128))])])]),o("div",X,[o("h4",null,[r("PIMS Membership "),a(m,{round:"",dense:"",flat:"",icon:"info",onClick:e.pimsinfo},null,8,["onClick"])]),e.user_profile.pims.state==="NOTENTERED"?(l(),d("div",x,[ee,o("div",ie,[a(m,{label:"Enter PIMS information",color:"primary",onClick:e.clickenterpimsinformation},null,8,["onClick"])]),o("div",null,[r("PIMS Membership verified: "),a(p,{name:"cancel",color:"red",size:"32px"})])])):g("",!0),e.user_profile.pims.state==="WAITINGVERIFICATION"?(l(),d("div",te,[oe,o("div",{class:"pimstext",onClick:i[0]||(i[0]=(...b)=>e.clickcopypimsverfiylink&&e.clickcopypimsverfiylink(...b))},[o("div",{innerHTML:e.pimsverfiylink},null,8,ae),r("\xA0 "),a(p,{class:"float-right",name:"content_copy",size:"16px"})]),o("div",null,[r("PIMS Membership verified: "),a(p,{name:"cancel",color:"red",size:"32px"})])])):g("",!0),e.user_profile.pims.state==="VERIFIED"?(l(),d("div",se,[ne,o("div",null,f(e.user_profile.pims.first_name)+" "+f(e.user_profile.pims.last_name)+" - PIMS number "+f(e.user_profile.pims.number),1),o("div",null,[r("PIMS Membership verified: "),a(p,{name:"check_box",color:"green",size:"32px"})])])):g("",!0),e.user_profile.pims.state==="VERIFICATIONFAILED"?(l(),d("div",re,[le,o("div",me,[a(m,{label:"Retry entering PIMS information",color:"primary",onClick:e.clickenterpimsinformation},null,8,["onClick"])]),o("div",null,[r("PIMS Membership verified: "),a(p,{name:"cancel",color:"red",size:"32px"})])])):g("",!0)]),o("div",de,[a(m,{class:"bottom-button",onClick:e.logout,color:"secondary",label:"Logout"},null,8,["onClick"]),a(m,{class:"bottom-button",onClick:e.deleteaccount,color:"red",label:"Delete my account"},null,8,["onClick"])])]),a(t,{ref:"ProfilePimsDetailDialog"},null,512)]),_:1})}var be=k(G,[["render",ce]]);export{be as default};
