import{Q as L}from"./QPage.1d268709.js";import{d as g,_ as y,o as u,c as p,w as l,a as n,e as t,ad as M,ae as B,ag as b,af as D,f as c,ar as W,g as C,t as r,aq as v,r as f,N as k,a7 as J,h as H,F as Y}from"./index.007b0c12.js";import{Q as K,I as A,F as X,G as Z,P as x,R as ee,S as te,O as ae,a as se}from"./FeatureTable.cb1e3125.js";import{u as R}from"./utils.7b533ce3.js";import{Q as ne,a as m,b as j,c as re}from"./QTable.89d9beba.js";import{Q as S}from"./QTr.a01851d0.js";import{Q as le}from"./QExpansionItem.6a7b8a4f.js";import{u as ie}from"./utils.5f33790e.js";import{u as O}from"./backend_connection.50679ed3.js";import"./position-engine.851437de.js";import"./QItemLabel.df83f7bf.js";import"./axios.6e1fcf85.js";const oe=g({name:"BrrCalcVision",emits:["projectchanged"],data(){return{devplan:"",emit_project_change_notification:!0}},computed:{serializer_card_data(){return{devplan:this.devplan}}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged")}},methods:{helpdevplan(){this.$q.dialog({title:"What is the development plan?",message:"Enter the development plan. E.g. Split into two flats"}).onOk(()=>{})},serializer_load_data(e){this.emit_project_change_notification=!1,this.devplan=e.devplan;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}}}),ce=t("div",{class:"text-h6"},"Vision",-1),_e={class:"row"};function ue(e,a,s,o,d,h){return u(),p(D,{inline:"",class:"q-ma-sm card-style"},{default:l(()=>[n(b,null,{default:l(()=>[ce,t("div",_e,[n(M,{modelValue:e.devplan,"onUpdate:modelValue":a[0]||(a[0]=i=>e.devplan=i),label:"What is the development plan?",class:"col-grow"},null,8,["modelValue"]),n(B,{round:"",color:"primary",icon:"info",onClick:e.helpdevplan},null,8,["onClick"])])]),_:1})]),_:1})}var de=y(oe,[["render",ue]]);const fe=g({name:"BrrCalcFinance",emits:["projectchanged"],props:["gdv_total"],data(){return{refinance:{userefinance:!0,ltv:{min:75,max:75}},emit_project_change_notification:!0}},methods:{format_currency(e){return R.format_currency(e)},serializer_load_data(e){this.emit_project_change_notification=!1,this.refinance.userefinance=e.refinance_userefinance,this.refinance.ltv=e.refinance_userefinance_ltv;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged")}},computed:{serializer_card_data(){return{refinance_userefinance:this.refinance.userefinance,refinance_userefinance_ltv:this.refinance.ltv}},get_refinance(){return this.refinance},refinanceamount(){return{worst:this.gdv_total.min*(this.refinance.ltv.min/100),best:this.gdv_total.max*(this.refinance.ltv.max/100)}},refinance_out_items(){let e=[];return this.refinance.userefinance&&e.push({name:"Mortgage Refinance",worst:this.refinanceamount.worst,best:this.refinanceamount.best}),e}}}),he=t("div",{class:"text-h6"},"Refinance",-1),me={key:0};function pe(e,a,s,o,d,h){return u(),p(D,{inline:"",class:"q-ma-sm card-style"},{default:l(()=>[n(b,null,{default:l(()=>[he,c(" This section is for adding refinance details. After the refurbishment is complete the refinance stage can be used to pull money out of the deal. "),n(W,{modelValue:e.refinance.userefinance,"onUpdate:modelValue":a[0]||(a[0]=i=>e.refinance.userefinance=i),label:"Refinance after refurbishment"},null,8,["modelValue"]),e.refinance.userefinance?(u(),C("div",me,[c(" Refinance LTV "+r(e.refinance.ltv.min)+"% - "+r(e.refinance.ltv.max)+"% ",1),n(K,{modelValue:e.refinance.ltv,"onUpdate:modelValue":a[1]||(a[1]=i=>e.refinance.ltv=i),min:0,max:100,step:5,"thumb-size":"40px","drag-range":"",label:"","left-label-value":e.refinance.ltv.min+"%","right-label-value":e.refinance.ltv.max+"%"},null,8,["modelValue","left-label-value","right-label-value"]),t("div",null,"Refinance amount: "+r(e.format_currency(e.refinanceamount.worst))+" - "+r(e.format_currency(e.refinanceamount.best)),1)])):v("",!0)]),_:1})]),_:1})}var be=y(fe,[["render",pe]]);function F(e){return e.filter(function(a){return a.type==="ledger"})}function I(e,a){e.push({type:"blank",key:e.length}),e.push({type:"title",key:e.length,name:a})}function $(e,a,s,o){let d=F(e);var h=void 0,i=void 0;d.length>0&&(h=d[d.length-1].worst,i=d[d.length-1].best);function _(P,w){var T=0;typeof P!="undefined"&&(T=P.bal);var z="",V="";return w>0?z=w:V=w,{in:z,out:V,bal:T+w}}e.push({type:"ledger",key:e.length,name:a,worst:_(h,s),best:_(i,o)})}const ve=g({name:"BrrCalcDealSummary",props:["is_valid_input","purchaserange","finance_in_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","finance_out_items","refinance_out_items","finance_during_items"],components:{InvalidMessage:A},data(){return{table:{columns:[{name:"item",label:"Item",field:"item"},{name:"win",label:"In",field:"win"},{name:"wout",label:"Out",field:"wout"},{name:"wbal",label:"Balance",field:"wbal"},{name:"bin",label:"In",field:"bin"},{name:"bout",label:"Out",field:"bout"},{name:"bbal",label:"Balance",field:"bbal"}]}}},methods:{format_currency(e){return typeof e=="string"&&e===""?"":R.format_currency(e)}},computed:{final_bal(){let e=F(this.items);return e.length===0?{worst:0,best:0}:{worst:e[e.length-1].worst.bal,best:e[e.length-1].best.bal}},money_in(){var e=this.finance_in_items.reduce((s,o)=>s+o.worst,0),a=this.finance_in_items.reduce((s,o)=>s+o.best,0);return{worst:e,best:a}},items(){var e=[];typeof this.finance_in_items!="undefined"&&this.finance_in_items.map(function(s){$(e,s.name,s.worst,s.best)}),typeof this.purchase_items!="undefined"&&this.purchase_items.map(function(s){$(e,s.name,s.worst,s.best)}),typeof this.stampduty_items!="undefined"&&this.stampduty_items.map(function(s){$(e,s.name,s.worst,s.best)}),typeof this.othercosts_items!="undefined"&&this.othercosts_items.map(function(s){$(e,s.name,s.worst,s.best)}),I(e,"During Project"),typeof this.finance_during_items!="undefined"&&this.finance_during_items.map(function(s){$(e,s.name,s.worst,s.best)}),typeof this.refurb_cost_items!="undefined"&&this.refurb_cost_items.map(function(s){$(e,s.name,s.worst,s.best)});let a=!1;return typeof this.refinance_out_items!="undefined"&&(this.refinance_out_items.length>0&&(a=!0,I(e,"Exit finance")),this.refinance_out_items.map(function(s){$(e,s.name,s.worst,s.best)})),typeof this.finance_out_items!="undefined"&&(this.finance_out_items.length>0&&(a||I(e,"Exit finance")),this.finance_out_items.map(function(s){$(e,s.name,s.worst,s.best)})),e}}}),ge=t("div",{class:"text-h6"},"Cashflow Summary",-1),ye=t("div",{class:"text-subtitle2"},"This section gives a break down of money in and out of the deal. It is broken down twice, for best and worst case figures.",-1),we=t("div",null," \xA0 ",-1);function $e(e,a,s,o,d,h){const i=f("InvalidMessage");return u(),p(D,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:l(()=>[n(b,null,{default:l(()=>[ge,ye]),_:1}),n(b,null,{default:l(()=>[n(i,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),t("div",null,[n(ne,{columns:e.table.columns,rows:e.items,"hide-bottom":"","rows-per-page-options":[100]},{header:l(_=>[n(S,null,{default:l(()=>[n(m),n(m,{colspan:"3",class:"worstcasetablecell"},{default:l(()=>[c("Worst Case")]),_:1}),n(m,{colspan:"3"},{default:l(()=>[c("Best Case")]),_:1})]),_:1}),n(S,{props:_},{default:l(()=>[n(m,null,{default:l(()=>[c(" Item ")]),_:1}),n(m,{class:"worstcasetablecell"},{default:l(()=>[c(" In ")]),_:1}),n(m,{class:"worstcasetablecell"},{default:l(()=>[c(" Out ")]),_:1}),n(m,{class:"worstcasetablecell"},{default:l(()=>[c(" Balance ")]),_:1}),n(m,null,{default:l(()=>[c(" In ")]),_:1}),n(m,null,{default:l(()=>[c(" Out ")]),_:1}),n(m,null,{default:l(()=>[c(" Balance ")]),_:1})]),_:2},1032,["props"])]),body:l(_=>[_.row.type==="ledger"?(u(),p(S,{key:0},{default:l(()=>[n(j,{class:"tablerowcell"},{default:l(()=>[c(r(_.row.name),1)]),_:2},1024),n(j,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.worst.in)),1)]),_:2},1024),n(j,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.worst.out)),1)]),_:2},1024),n(j,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.worst.bal)),1)]),_:2},1024),n(j,{class:"valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.best.in)),1)]),_:2},1024),n(j,{class:"valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.best.out)),1)]),_:2},1024),n(j,{class:"valuetablecell tablerowcell"},{default:l(()=>[c(r(e.format_currency(_.row.best.bal)),1)]),_:2},1024)]),_:2},1024)):v("",!0),_.row.type==="blank"?(u(),p(S,{key:1},{default:l(()=>[n(m,{colspan:"7"},{default:l(()=>[c("\xA0")]),_:1})]),_:1})):v("",!0),_.row.type==="title"?(u(),p(S,{key:2},{default:l(()=>[n(m,{colspan:"7"},{default:l(()=>[c(r(_.row.name),1)]),_:2},1024)]),_:2},1024)):v("",!0)]),_:1},8,["columns","rows"])]),we]),_:1})]),_:1})}var ke=y(ve,[["render",$e]]);const je=g({name:"BrrCalcDealRatingAlternativeSummary",props:["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"],methods:{format_currency(e){return R.format_currency(e)}},computed:{mortgage_rate_display(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max+"%",worst:this.finance_refinance.ltv.min+"%"}:{best:"N/A",worst:"N/A"}},mortgage(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max/100*this.purchaserange.min,worst:this.finance_refinance.ltv.min/100*this.purchaserange.max}:{best:0,worst:0}},deposit(){return{best:this.purchaserange.min-this.mortgage.best,worst:this.purchaserange.max-this.mortgage.worst}},total_money_in(){return{best:this.mortgage.best+this.deposit.best+this.stampduty_total.min+this.othercosts_total.min+this.refurb_cost_total.min,worst:this.mortgage.worst+this.deposit.worst+this.stampduty_total.max+this.othercosts_total.max+this.refurb_cost_total.max}},new_mortgage_amount(){return{best:this.gdv_total.max*(this.finance_refinance.ltv.max/100),worst:this.gdv_total.min*(this.finance_refinance.ltv.min/100)}},monay_pulled_out(){return{best:this.gdv_total.max-this.new_mortgage_amount.best,worst:this.gdv_total.min-this.new_mortgage_amount.worst}},profit(){return{best:this.gdv_total.max-this.total_money_in.best,worst:this.gdv_total.min-this.total_money_in.worst}},money_left_in(){return{best:this.monay_pulled_out.best-this.profit.best,worst:this.monay_pulled_out.worst-this.profit.worst}}}}),Ce={class:"alternativetable"},Pe=t("thead",null,[t("tr",null,[t("th",{class:"text-left alternativetablecell"}),t("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),t("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Te=t("td",{class:"text-left alternativetablecell"},"Price offered",-1),Re={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Se={class:"text-right alternativetablecell yellowtablecell totaltablecell"},De=t("td",{class:"text-left alternativetablecell"},"Mortgage %",-1),ze={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ve={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Be=t("td",{class:"text-left alternativetablecell"},"Mortgage",-1),Ie={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Me={class:"text-right alternativetablecell totaltablecell"},Oe=t("td",{class:"text-left alternativetablecell"},"Deposit",-1),Ae={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Fe={class:"text-right alternativetablecell totaltablecell"},Qe=t("td",{class:"text-left alternativetablecell"},"Stamp Duty",-1),Ne={class:"text-right alternativetablecell yellowtablecell totaltablecell"},qe={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ee=t("td",{class:"text-left alternativetablecell"},"Other costs (Legals, etc)",-1),Ue={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ge={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Le=t("td",{class:"text-left alternativetablecell"},"Total Refurb Costs",-1),We={class:"text-right alternativetablecell bluetablecell totaltablecell"},Je={class:"text-right alternativetablecell bluetablecell totaltablecell"},He=t("td",{class:"text-left alternativetablecell"},"Total Money In",-1),Ye={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Ke={class:"text-right alternativetablecell totaltablecell"},Xe=t("tr",null,[t("td",null,"\xA0"),t("td",{class:"worstcasetablecell"}),t("td")],-1),Ze=t("td",{class:"text-left alternativetablecell"},"End Value",-1),xe={class:"text-right alternativetablecell yellowtablecell totaltablecell"},et={class:"text-right alternativetablecell yellowtablecell totaltablecell"},tt=t("td",{class:"text-left alternativetablecell"},"New Mortgage Amount",-1),at={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},st={class:"text-right alternativetablecell totaltablecell"},nt=t("td",{class:"text-left alternativetablecell"},"Money Pulled Out",-1),rt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},lt={class:"text-right alternativetablecell totaltablecell"},it=t("tr",null,[t("td",null,"\xA0"),t("td",{class:"worstcasetablecell"}),t("td")],-1),ot=t("td",{class:"text-left alternativetablecell"},"Profit",-1),ct={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},_t={class:"text-right alternativetablecell totaltablecell"},ut=t("td",{class:"text-left alternativetablecell"},"Money Left In",-1),dt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ft={class:"text-right alternativetablecell totaltablecell"};function ht(e,a,s,o,d,h){return u(),p(le,{"expand-separator":"",label:"Alternative summary format"},{default:l(()=>[t("div",null,[c(" This is another way of viewing the project numbers that is commonly used. I have included this for comparison. "),t("table",Ce,[Pe,t("tbody",null,[t("tr",null,[Te,t("td",Re,r(e.format_currency(e.purchaserange.max)),1),t("td",Se,r(e.format_currency(e.purchaserange.min)),1)]),t("tr",null,[De,t("td",ze,r(e.mortgage_rate_display.worst),1),t("td",Ve,r(e.mortgage_rate_display.best),1)]),t("tr",null,[Be,t("td",Ie,r(e.format_currency(e.mortgage.worst)),1),t("td",Me,r(e.format_currency(e.mortgage.best)),1)]),t("tr",null,[Oe,t("td",Ae,r(e.format_currency(e.deposit.worst)),1),t("td",Fe,r(e.format_currency(e.deposit.best)),1)]),t("tr",null,[Qe,t("td",Ne,r(e.format_currency(e.stampduty_total.max)),1),t("td",qe,r(e.format_currency(e.stampduty_total.min)),1)]),t("tr",null,[Ee,t("td",Ue,r(e.format_currency(e.othercosts_total.max)),1),t("td",Ge,r(e.format_currency(e.othercosts_total.min)),1)]),t("tr",null,[Le,t("td",We,r(e.format_currency(e.refurb_cost_total.max)),1),t("td",Je,r(e.format_currency(e.refurb_cost_total.min)),1)]),t("tr",null,[He,t("th",Ye,r(e.format_currency(e.total_money_in.worst)),1),t("th",Ke,r(e.format_currency(e.total_money_in.best)),1)]),Xe,t("tr",null,[Ze,t("td",xe,r(e.format_currency(e.gdv_total.min)),1),t("td",et,r(e.format_currency(e.gdv_total.max)),1)]),t("tr",null,[tt,t("td",at,r(e.format_currency(e.new_mortgage_amount.worst)),1),t("td",st,r(e.format_currency(e.new_mortgage_amount.best)),1)]),t("tr",null,[nt,t("td",rt,r(e.format_currency(e.monay_pulled_out.worst)),1),t("td",lt,r(e.format_currency(e.monay_pulled_out.best)),1)]),it,t("tr",null,[ot,t("td",ct,r(e.format_currency(e.profit.worst)),1),t("td",_t,r(e.format_currency(e.profit.best)),1)]),t("tr",null,[ut,t("td",dt,r(e.format_currency(e.money_left_in.worst)),1),t("td",ft,r(e.format_currency(e.money_left_in.best)),1)])])]),c(" Note: The profit amounts may not match because this method does not take into account finance costs. ")])]),_:1})}var mt=y(je,[["render",ht]]);const pt=g({name:"BrrCalcDealRatingCompareDoneup",props:["purchaserange","refurb_cost_total","gdv_total"],methods:{format_currency(e){return R.format_currency(e)},format_percent(e){return R.format_percent(e)}},computed:{total_spent(){return{worst:this.purchaserange.max+this.refurb_cost_total.max,best:this.purchaserange.min+this.refurb_cost_total.min}},gain(){return{worst:this.gdv_total.min-this.total_spent.worst,best:this.gdv_total.max-this.total_spent.best}},profit_percentage(){return{worst:this.gain.worst/this.total_spent.worst,best:this.gain.best/this.total_spent.best}}}}),bt=t("div",{class:"text-h5"},"Compare this project to buying a done up property",-1),vt=t("div",null,"This section compares this project with buying a property that is already done up. To account for the time and risk involved with a refurbishment we expect the end value of the property to be more than if we had just bought one.",-1),gt={class:"alternativetable"},yt=t("thead",null,[t("tr",null,[t("th",{class:"text-left alternativetablecell"}),t("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),t("th",{class:"text-center alternativetablecell"},"Best case")])],-1),wt=t("td",{class:"text-left alternativetablecell"},"Purchase + Refurb",-1),$t={class:"text-right alternativetablecell worstcasetablecell"},kt={class:"text-right alternativetablecell"},jt=t("td",{class:"text-left alternativetablecell"},"End Value",-1),Ct={class:"text-right alternativetablecell worstcasetablecell"},Pt={class:"text-right alternativetablecell"},Tt=t("td",{class:"text-left alternativetablecell totaltablecell"},"Gain",-1),Rt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},St={class:"text-right alternativetablecell totaltablecell"},Dt=t("td",{class:"text-left alternativetablecell totaltablecell"},"Percentage",-1),zt={class:"text-right alternativetablecell worstcasetablecell finaltotaltablecell"},Vt={class:"text-right alternativetablecell finaltotaltablecell"};function Bt(e,a,s,o,d,h){return u(),C("div",null,[bt,vt,t("table",gt,[yt,t("tbody",null,[t("tr",null,[wt,t("td",$t,r(e.format_currency(e.total_spent.worst)),1),t("td",kt,r(e.format_currency(e.total_spent.best)),1)]),t("tr",null,[jt,t("td",Ct,r(e.format_currency(e.gdv_total.min)),1),t("td",Pt,r(e.format_currency(e.gdv_total.max)),1)]),t("tr",null,[Tt,t("td",Rt,r(e.format_currency(e.gain.worst)),1),t("td",St,r(e.format_currency(e.gain.best)),1)]),t("tr",null,[Dt,t("td",zt,r(e.format_percent(e.profit_percentage.worst)),1),t("td",Vt,r(e.format_percent(e.profit_percentage.best)),1)])])])])}var It=y(pt,[["render",Bt]]);const Mt=g({name:"BrrCalcDealRating",props:["is_valid_input","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","purchaserange","stampduty_total","othercosts_total","refurb_cost_total"],components:{dealRatingAlternativeSummary:mt,FeatureTable:X,InvalidMessage:A,dealRatingCompareDoneup:It},data(){return{}},methods:{format_currency(e){return R.format_currency(e)}},computed:{features(){let e=[];var a=Math.min(this.cash_out_of_deal_minus_cash_in.best,this.cash_out_of_deal_minus_cash_in.worst);a>0?e.push({type:"positive",text:"All money out deal! - All initial investment returned plus at least "+this.format_currency(a)}):e.push({type:"negative",text:"Not all money out deal! - Might leave "+this.format_currency(-1*a)+" in."});var s=Math.min(this.profit.best,this.profit.worst);s<0?e.push({type:"negative",text:"Deal makes a loss! - End value might be "+this.format_currency(-1*s)+" less than investment."}):s<this.gdv_total.min*.25?e.push({type:"negative",text:"Low amount of profit! - Low profit "+this.format_currency(s)+" less than 25% of gdv."}):e.push({type:"positive",text:"Profit making deal! - Profit of "+this.format_currency(s)+"!"});var o=Math.min(this.annualroi.worst,this.annualroi.best);return o<3?e.push({type:"negative",text:"Very low ROI! "+o.toFixed(1)+"%"}):o>10&&e.push({type:"positive",text:"Good ROI! "+o.toFixed(1)+"%"}),e},cash_out_of_deal_minus_cash_in(){return{best:this.deal_summary_final_bal.best-this.finance_totalmoneyneeded.best,worst:this.deal_summary_final_bal.worst-this.finance_totalmoneyneeded.worst}},percent_left_in(){return this.finance_refinance.userefinance?{best:100-this.finance_refinance.ltv.max,worst:100-this.finance_refinance.ltv.min}:{best:100,worst:100}},amount_equity_left_in(){return{best:this.gdv_total.max*(this.percent_left_in.best/100),worst:this.gdv_total.min*(this.percent_left_in.worst/100)}},total_end_value(){return{best:this.amount_equity_left_in.best+this.deal_summary_final_bal.best,worst:this.amount_equity_left_in.worst+this.deal_summary_final_bal.worst}},profit(){return{best:this.total_end_value.best-this.finance_totalmoneyneeded.best,worst:this.total_end_value.worst-this.finance_totalmoneyneeded.worst}},roi(){return{best:100*this.profit.best/this.finance_totalmoneyneeded.best,worst:100*this.profit.worst/this.finance_totalmoneyneeded.worst}},annualroi(){return{worst:this.roi.worst*(12/this.refurbmonths.worst),best:this.roi.best*(12/this.refurbmonths.best)}}}}),Ot=t("div",{class:"text-h6"},"Project Rating",-1),At=t("div",{class:"text-subtitle2"},"How good is this project?",-1),Ft=t("div",{class:"text-h5"},"Profit/Loss",-1),Qt=t("div",null,"Compare what we have put into the deal vs what we get out of it. These calculations won't account for time invested or the risk taken on in the project",-1),Nt={class:"text-h5"},qt=t("div",{class:"text-h6"},"Deal Features",-1);function Et(e,a,s,o,d,h){const i=f("InvalidMessage"),_=f("dealRatingCompareDoneup"),P=f("dealRatingAlternativeSummary"),w=f("FeatureTable");return u(),p(D,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:l(()=>[n(b,null,{default:l(()=>[Ot,At]),_:1}),n(b,null,{default:l(()=>[n(i,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),Ft,Qt,t("div",Nt,"Total cash in: "+r(e.format_currency(e.finance_totalmoneyneeded.worst))+" - "+r(e.format_currency(e.finance_totalmoneyneeded.best))+" Worst - Best",1),n(_,{purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","refurb_cost_total","gdv_total"])]),_:1}),n(b,null,{default:l(()=>[n(P,{purchaserange:e.purchaserange,finance_refinance:e.finance_refinance,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"])]),_:1}),n(b,null,{default:l(()=>[qt,n(w,{features:e.features,"onUpdate:features":a[0]||(a[0]=T=>e.features=T)},null,8,["features"])]),_:1})]),_:1})}var Ut=y(Mt,[["render",Et]]);function Gt(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}const Lt=g({name:"DealBasicInfo",emits:["saveproject"],setup(){return{backend_connection_store:O()}},data(){return{patch:{id:"notset",name:"Not Set"},address:"",postcode:"",weblinks:[],new_patch_value:"",changed:!1,autosave_seconds_left:60,ever_saved:!1,save_in_progress:!1,save_monitor_function_running:!1}},watch:{serializer_card_data(e){this.set_changed_true()}},computed:{serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,weblinks:this.weblinks}},no_save_message(){return this.patch.id==="notset"?"Select patch":this.address.length<3?"Enter address":this.save_in_progress?"Saving...":""},can_save(){return this.save_in_progress?!1:!!this.changed},save_btn_text(){return this.no_save_message!==""?"Not able to save ("+this.no_save_message+")":this.changed?this.autosave_seconds_left===-1?"Save Now":"Save now (auto save in "+this.autosave_seconds_left+")":"Not able to save (No changes)"},security_role_cansave(){return this.backend_connection_store.security_role_cansave},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{serializer_load_data(e){this.address=e.address,this.postcode=e.postcode,this.weblinks=e.weblinks,this.patch=this.patch_list.filter(function(s){return s.id===e.patch_id})[0],this.ever_saved=!0;const a=this;setTimeout(function(){a.changed=!1,a.autosave_seconds_left=-1},50)},set_changed_true(){this.changed=!0,this.no_save_message===""&&(this.autosave_seconds_left=10,this.start_save_monitor_function())},start_save_monitor_function(){this.save_monitor_function_running||this.save_monitor_function()},save_monitor_function(){if(this.save_monitor_function_running=!0,this.save_in_progress)return;if(this.autosave_seconds_left===-1){this.save_monitor_function_running=!1;return}const e=this;if(e.autosave_seconds_left=e.autosave_seconds_left-1,e.autosave_seconds_left<1){this.save_monitor_function_running=!1,this.save_now();return}setTimeout(e.save_monitor_function,1e3)},click_save_btn(){this.autosave_seconds_left=-1,this.save_now()},save_now(){!this.can_save||(this.save_in_progress=!0,this.$emit("saveproject"))},save_project_complete_notification({success:e,response:a}){console.log("save complet notif"),this.save_in_progress=!1,e?(this.changed=!1,this.ever_saved=!0):this.autosave_seconds_left=-1},select_patch(e){if(e.id==="create"){const a=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(s=>{a.new_patch_value=s;const o={ok:a.createpatchcallback,error:function(h){console.log("s",h),k.create({color:"negative",message:"Create patch failed "+h.response.data.message,timeout:2e3})}},d={patch_name:s};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:d,callback:o})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(a){return a.name===e.new_patch_value})[0],this.new_patch_value=""},delweblink(e){this.weblinks=this.weblinks.filter(function(a){return e!==a.id}),this.set_changed_true()},addweblink(){const e=this;this.$q.dialog({title:"Add weblink",message:"Add weblink to information about this property (rightmove, zoopla, etc.)",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(a=>{if(a=a.trim(),!a.startsWith("http")){k.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"});return}e.weblinks.push({id:Gt(),label:a}),e.set_changed_true()})},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const a={ok:function(s){k.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(s){k.create({color:"negative",message:"Copy failed",timeout:2e3})}};ie.copyTextToClipboard2(e,a)}}}),Wt=t("div",{class:"text-h6"},"Basic Information",-1),Jt=t("div",{class:"text-subtitle2"},"Basic information about this project",-1),Ht={key:0},Yt={key:1},Kt=t("div",{class:"text-h6"},"Weblinks",-1);function Xt(e,a,s,o,d,h){return e.security_role_cansave?(u(),p(D,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:l(()=>[n(b,null,{default:l(()=>[Wt,Jt]),_:1}),n(b,null,{default:l(()=>[e.ever_saved?v("",!0):(u(),C("div",Ht,[n(re,{modelValue:e.patch,"onUpdate:modelValue":[a[0]||(a[0]=i=>e.patch=i),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(u(),C("div",Yt," Patch: "+r(e.patch.name),1)):v("",!0),t("div",null,[n(M,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":a[1]||(a[1]=i=>e.address=i),label:"Address"},null,8,["modelValue"])]),t("div",null,[n(M,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":a[3]||(a[3]=i=>e.postcode=i),label:"Postcode"},{append:l(()=>[e.isEmpty(e.postcode)?v("",!0):(u(),p(J,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:a[2]||(a[2]=i=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])])]),_:1}),n(b,null,{default:l(()=>[t("div",null,[Kt,(u(!0),C(Y,null,H(e.weblinks,i=>(u(),C("div",{key:i},[c(r(i.label)+" ",1),n(B,{round:"",color:"primary",icon:"delete",onClick:_=>e.delweblink(i.id)},null,8,["onClick"])]))),128)),n(B,{round:"",color:"primary",icon:"add",onClick:e.addweblink},null,8,["onClick"])])]),_:1}),n(b,null,{default:l(()=>[t("div",null,[n(B,{color:"primary",icon:"save",label:e.save_btn_text,onClick:e.click_save_btn},null,8,["label","onClick"])])]),_:1})]),_:1})):v("",!0)}var Zt=y(Lt,[["render",Xt]]);const xt=g({name:"ProjectSerializer",emits:["saveprojectcomplete"],setup(){return{backend_connection_store:O()}},data(){return{loaded_project_id:void 0,proj_summary_data:{metadata:void 0,timestamp_first_entered:void 0}}},methods:{serializer_load_data(e){this.loaded_project_id=e.id,this.proj_summary_data.timestamp_first_entered=e.timestamp_first_entered,this.proj_summary_data.metadata=e.metadata},save_project({dict_of_card_info:e}){const a={};for(const h in Object.keys(e)){const i=Object.keys(e)[h];a[i]=JSON.parse(JSON.stringify(e[i]))}const s={user_id:this.backend_connection_store.user_profile.id,patch_id:e.dealbasicinfo.patch_id,timestamp_first_entered:this.proj_summary_data.timestamp_first_entered,initial_phase:{total_money_in:0,start_value:0,end_value:0,flip_roi:0},reoccurring_phase:[],location:{},workflow:{},activity_log:[],sub_section_details:a,tags:[],risks:[]};typeof this.loaded_project_id!="undefined"?(s.id=this.loaded_project_id,s.metadata=this.proj_summary_data.metadata):s.timestamp_first_entered=new Date().toISOString();const o=this,d={ok:o.save_api_call_success,error:o.save_api_call_fail};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects",method:"POST",data:s,callback:d})},save_api_call_success(e){this.$emit("saveprojectcomplete",{success:!0,response:e}),this.serializer_load_data(e.data),k.create({color:"positive",message:"Project Saved",timeout:2e3})},save_api_call_fail(e){this.$emit("saveprojectcomplete",{success:!1,response:e}),k.create({color:"negative",message:"Save failed - "+e.response.data.message,timeout:2e3})}},mounted(){}});function ea(e,a,s,o,d,h){return u(),C("div")}var ta=y(xt,[["render",ea]]);const aa=g({name:"CalcBrrToFlip",components:{GdvCard:Z,PurchasePrice:x,RefurbCost:ee,StampDuty:te,OtherCosts:ae,DealSummary:ke,Finance:se,Vision:de,DealRating:Ut,Refinance:be,DealBasicInfo:Zt,ProjectSerializer:ta},setup(){return{backend_connection_store:O()}},data(){return{isMounted:!1,purchaserange:{min:18e4,max:19e4}}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave},is_valid_input(){return this.isMounted?!(!this.$refs.PurchasePrice.isValid||!this.$refs.GdvCard.isValid):!0},deal_summary_final_bal(){return this.isMounted?this.$refs.DealSummary.final_bal:{best:0,worst:0}},finance_refinance(){return this.isMounted?this.$refs.Refinance.get_refinance:{userefinance:!1,ltv:{min:75,max:75}}},finance_totalmoneyneeded(){return this.isMounted?this.$refs.Finance.totalmoneyneeded:{best:0,worst:0}},finance_in_items(){return this.isMounted?this.$refs.Finance.finance_in_items:[]},finance_during_items(){return this.isMounted?this.$refs.Finance.finance_during_items:[]},finance_out_items(){return this.isMounted?this.$refs.Finance.finance_out_items:[]},refinance_out_items(){return this.isMounted?this.$refs.Refinance.refinance_out_items:[]},purchase_items(){return this.isMounted?this.$refs.PurchasePrice.purchase_items:[]},stampduty_items(){return this.isMounted?this.$refs.StampDuty.stampduty_items:[]},othercosts_items(){return this.isMounted?this.$refs.OtherCosts.othercosts_items:[]},refurb_cost_items(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_items:[]},refurb_cost_total(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_total:[]},refurbmonths(){return this.isMounted?this.$refs.RefurbCost.refurbmonths:[]},stampduty_total(){return this.isMounted?this.$refs.StampDuty.stampduty:[]},othercosts_total(){return this.isMounted?this.$refs.OtherCosts.total:[]},gdv_total(){return this.isMounted?this.$refs.GdvCard.total:[]}},methods:{projectchanged(){this.$refs.DealBasicInfo.set_changed_true()},save_project(){const e={dealbasicinfo:this.$refs.DealBasicInfo.serializer_card_data,vision:this.$refs.Vision.serializer_card_data,gdvcard:this.$refs.GdvCard.serializer_card_data,purchaseprice:this.$refs.PurchasePrice.serializer_card_data,refurbcost:this.$refs.RefurbCost.serializer_card_data,stampduty:this.$refs.StampDuty.serializer_card_data,othercosts:this.$refs.OtherCosts.serializer_card_data,finance:this.$refs.Finance.serializer_card_data,refinance:this.$refs.Refinance.serializer_card_data};this.$refs.ProjectSerializer.save_project({dict_of_card_info:e})},load_project_into_cards(e){this.$refs.ProjectSerializer.serializer_load_data(e),this.$refs.DealBasicInfo.serializer_load_data(e.sub_section_details.dealbasicinfo),typeof e.sub_section_details.vision!="undefined"&&this.$refs.Vision.serializer_load_data(e.sub_section_details.vision),typeof e.sub_section_details.gdvcard!="undefined"&&this.$refs.GdvCard.serializer_load_data(e.sub_section_details.gdvcard),typeof e.sub_section_details.purchaseprice!="undefined"&&this.$refs.PurchasePrice.serializer_load_data(e.sub_section_details.purchaseprice),typeof e.sub_section_details.refurbcost!="undefined"&&this.$refs.RefurbCost.serializer_load_data(e.sub_section_details.refurbcost),typeof e.sub_section_details.stampduty!="undefined"&&this.$refs.StampDuty.serializer_load_data(e.sub_section_details.stampduty),typeof e.sub_section_details.othercosts!="undefined"&&this.$refs.OtherCosts.serializer_load_data(e.sub_section_details.othercosts),typeof e.sub_section_details.finance!="undefined"&&this.$refs.Finance.serializer_load_data(e.sub_section_details.finance),typeof e.sub_section_details.refinance!="undefined"&&this.$refs.Refinance.serializer_load_data(e.sub_section_details.refinance)},save_project_complete({success:e,response:a}){this.$refs.DealBasicInfo.save_project_complete_notification({success:e,response:a})},load_project_api_fail(e){console.log("Failed to load project via API - ",e),k.create({color:"bg-grey-2",message:"Error loading project "+e,timeout:2e3,color:"negative"}),this.load_complete()},load_project_api_success(e){this.load_project_into_cards(e.data),k.create({color:"bg-grey-2",message:"Project Loaded",timeout:2e3,color:"positive"}),this.load_complete()},load_complete(){const e=this;setTimeout(function(){e.isMounted=!0},5)},call_load_api(){const e=this,a={ok:e.load_project_api_success,error:e.load_project_api_fail};e.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+e.$route.query.projectid,method:"GET",data:void 0,callback:a})}},mounted(){const e=this;if(typeof e.$route.query.projectid=="undefined"){e.load_complete();return}if(e.security_role_cansave){e.call_load_api();return}setTimeout(function(){e.call_load_api()},1e3)}}),sa={class:"main-page fit col wrap justify-center items-center content-center"},na=t("h1",null,"Buy Refurbish Rent Refinance Calculator",-1),ra=t("div",null,"This calculator can be used for calculating deal information for a Buy, Refurbish, Rent, Refinance project (BRRR). You can use this page to perform these calculations.",-1),la={class:"row"};function ia(e,a,s,o,d,h){const i=f("DealBasicInfo"),_=f("Vision"),P=f("GdvCard"),w=f("PurchasePrice"),T=f("RefurbCost"),z=f("StampDuty"),V=f("OtherCosts"),Q=f("Finance"),N=f("Refinance"),q=f("DealSummary"),E=f("DealRating"),U=f("ProjectSerializer");return u(),p(L,{class:"flex flex-center"},{default:l(()=>[t("div",sa,[na,ra,t("div",la,[n(i,{ref:"DealBasicInfo",onSaveproject:e.save_project},null,8,["onSaveproject"]),n(_,{ref:"Vision",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),n(P,{ref:"GdvCard",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),n(w,{ref:"PurchasePrice",purchaserange:e.purchaserange,"onUpdate:purchaserange":a[0]||(a[0]=G=>e.purchaserange=G),onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),n(T,{ref:"RefurbCost",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),n(z,{ref:"StampDuty",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),n(V,{ref:"OtherCosts",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),n(Q,{ref:"Finance",purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurbmonths:e.refurbmonths,gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["purchaserange","refurb_cost_total","stampduty_total","othercosts_total","refurbmonths","gdv_total","onProjectchanged"]),n(N,{ref:"Refinance",gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["gdv_total","onProjectchanged"]),n(q,{ref:"DealSummary",purchaserange:e.purchaserange,finance_in_items:e.finance_in_items,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,refinance_out_items:e.refinance_out_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items","finance_out_items","finance_during_items","refinance_out_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),n(E,{ref:"DealRating",purchaserange:e.purchaserange,finance_totalmoneyneeded:e.finance_totalmoneyneeded,deal_summary_final_bal:e.deal_summary_final_bal,finance_refinance:e.finance_refinance,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","stampduty_total","othercosts_total","refurb_cost_total","is_valid_input"]),e.security_role_cansave?(u(),p(U,{key:0,ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete},null,8,["onSaveprojectcomplete"])):v("",!0)])])]),_:1})}var ya=y(aa,[["render",ia]]);export{ya as default};
