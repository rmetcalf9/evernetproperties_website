import{i as Bt,h as Pe,as as ot,j as G,k as T,n as lt,B as Rt,an as _e,at as Pt,q as k,$ as Ye,a3 as It,au as jt,a8 as me,A as Mt,u as it,av as Vt,al as zt,g as ge,S as Ie,T as Je,m as ye,v as Dt,a9 as Et,aa as Lt,x as ut,d as L,_ as O,o as m,K as M,a as l,af as E,w as d,a7 as J,ag as V,e as n,ae as H,aw as Ve,ax as ze,r as C,c as I,f as $,ay as $e,t as _,ar as j,N as Y,L as De,M as Ee,am as ke,az as je,aA as Ot,ao as Xe}from"./index.267298ed.js";import{Q as Ft}from"./QResizeObserver.2b06ed2c.js";import{r as Nt,Q as Ut,a as Q,b as le,c as Wt,d as Gt}from"./QTable.03d86c7a.js";import{Q as Qt}from"./QPage.578abc44.js";import{C as Le}from"./ClosePopup.c973bc78.js";import{Q as Ht,I as ct,F as Kt,G as Yt,P as Jt,R as Xt,S as Zt,O as xt,a as ea}from"./FeatureTable.a604d463.js";import{u as he}from"./utils.7bd545ec.js";import{Q as ta}from"./QExpansionItem.0e0583cb.js";import{u as Ce,a as aa}from"./backend_connection.745676ee.js";import{W as Se}from"./Workflow_main.1f15d70b.js";import"./QItemLabel.471de407.js";import"./position-engine.fecc6a7b.js";import"./axios.6e1fcf85.js";let ra=0;const sa=["click","keydown"],na={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${ra++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function oa(e,a,s,r){const t=Bt(ot,Pe);if(t===Pe)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Pe;const{proxy:i}=it(),o=G(null),u=G(null),f=G(null),p=T(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),b=T(()=>t.currentModel.value===e.name),A=T(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(b.value===!0?" q-tab--active"+(t.tabProps.value.activeClass?" "+t.tabProps.value.activeClass:"")+(t.tabProps.value.activeColor?` text-${t.tabProps.value.activeColor}`:"")+(t.tabProps.value.activeBgColor?` bg-${t.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&t.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||t.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(r!==void 0?r.linkClass.value:"")),B=T(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(t.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),y=T(()=>e.disable===!0||t.hasFocus.value===!0||b.value===!1&&t.hasActiveTab.value===!0?-1:e.tabindex||0);function U(v,F){if(F!==!0&&o.value!==null&&o.value.focus(),e.disable===!0){r!==void 0&&r.hasRouterLink.value===!0&&Ye(v);return}if(r===void 0){t.updateModel({name:e.name}),s("click",v);return}if(r.hasRouterLink.value===!0){const W=(z={})=>{let K;const Z=z.to===void 0||Vt(z.to,e.to)===!0?t.avoidRouteWatcher=zt():null;return r.navigateToRouterLink(v,{...z,returnRouterError:!0}).catch(oe=>{K=oe}).then(oe=>{if(Z===t.avoidRouteWatcher&&(t.avoidRouteWatcher=!1,K===void 0&&(oe===void 0||oe.message.startsWith("Avoided redundant navigation")===!0)&&t.updateModel({name:e.name})),z.returnRouterError===!0)return K!==void 0?Promise.reject(K):oe})};s("click",v,W),v.defaultPrevented!==!0&&W();return}s("click",v)}function X(v){It(v,[13,32])?U(v,!0):jt(v)!==!0&&v.keyCode>=35&&v.keyCode<=40&&v.altKey!==!0&&v.metaKey!==!0&&t.onKbdNavigate(v.keyCode,i.$el)===!0&&Ye(v),s("keydown",v)}function ne(){const v=t.tabProps.value.narrowIndicator,F=[],W=k("div",{ref:f,class:["q-tab__indicator",t.tabProps.value.indicatorClass]});e.icon!==void 0&&F.push(k(me,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&F.push(k("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&F.push(e.alertIcon!==void 0?k(me,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):k("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),v===!0&&F.push(W);const z=[k("div",{class:"q-focus-helper",tabindex:-1,ref:o}),k("div",{class:B.value},Mt(a.default,F))];return v===!1&&z.push(W),z}const te={name:T(()=>e.name),rootRef:u,tabIndicatorRef:f,routeData:r};lt(()=>{t.unregisterTab(te)}),Rt(()=>{t.registerTab(te)});function ue(v,F){const W={ref:u,class:A.value,tabindex:y.value,role:"tab","aria-selected":b.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:U,onKeydown:X,...F};return _e(k(v,W,ne()),[[Pt,p.value]])}return{renderTab:ue,$tabs:t}}var Ze=ge({name:"QTab",props:na,emits:sa,setup(e,{slots:a,emit:s}){const{renderTab:r}=oa(e,a,s);return()=>r("div")}});function la(e,a,s){const r=s===!0?["left","right"]:["top","bottom"];return`absolute-${a===!0?r[0]:r[1]}${e?` text-${e}`:""}`}const ia=["left","center","right","justify"];var ua=ge({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>ia.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:a,emit:s}){const{proxy:r}=it(),{$q:t}=r,{registerTick:i}=Ie(),{registerTick:o}=Ie(),{registerTick:u}=Ie(),{registerTimeout:f,removeTimeout:p}=Je(),{registerTimeout:b,removeTimeout:A}=Je(),B=G(null),y=G(null),U=G(e.modelValue),X=G(!1),ne=G(!0),te=G(!1),ue=G(!1),v=[],F=G(0),W=G(!1);let z=null,K=null,Z;const oe=T(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:la(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),ft=T(()=>{const c=F.value,h=U.value;for(let g=0;g<c;g++)if(v[g].name.value===h)return!0;return!1}),mt=T(()=>`q-tabs__content--align-${X.value===!0?"left":ue.value===!0?"justify":e.align}`),gt=T(()=>`q-tabs row no-wrap items-center q-tabs--${X.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),pt=T(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+mt.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),pe=T(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),ve=T(()=>e.vertical!==!0&&t.lang.rtl===!0),Te=T(()=>Nt===!1&&ve.value===!0);ye(ve,de),ye(()=>e.modelValue,c=>{Ae({name:c,setCurrent:!0,skipEmit:!0})}),ye(()=>e.outsideArrows,be);function Ae({name:c,setCurrent:h,skipEmit:g}){U.value!==c&&(g!==!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",c),(h===!0||e["onUpdate:modelValue"]===void 0)&&(vt(U.value,c),U.value=c))}function be(){i(()=>{Oe({width:B.value.offsetWidth,height:B.value.offsetHeight})})}function Oe(c){if(pe.value===void 0||y.value===null)return;const h=c[pe.value.container],g=Math.min(y.value[pe.value.scroll],Array.prototype.reduce.call(y.value.children,(P,S)=>P+(S[pe.value.content]||0),0)),R=h>0&&g>h;X.value=R,R===!0&&o(de),ue.value=h<parseInt(e.breakpoint,10)}function vt(c,h){const g=c!=null&&c!==""?v.find(P=>P.name.value===c):null,R=h!=null&&h!==""?v.find(P=>P.name.value===h):null;if(g&&R){const P=g.tabIndicatorRef.value,S=R.tabIndicatorRef.value;z!==null&&(clearTimeout(z),z=null),P.style.transition="none",P.style.transform="none",S.style.transition="none",S.style.transform="none";const w=P.getBoundingClientRect(),N=S.getBoundingClientRect();S.style.transform=e.vertical===!0?`translate3d(0,${w.top-N.top}px,0) scale3d(1,${N.height?w.height/N.height:1},1)`:`translate3d(${w.left-N.left}px,0,0) scale3d(${N.width?w.width/N.width:1},1,1)`,u(()=>{z=setTimeout(()=>{z=null,S.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",S.style.transform="none"},70)})}R&&X.value===!0&&ce(R.rootRef.value)}function ce(c){const{left:h,width:g,top:R,height:P}=y.value.getBoundingClientRect(),S=c.getBoundingClientRect();let w=e.vertical===!0?S.top-R:S.left-h;if(w<0){y.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(w),de();return}w+=e.vertical===!0?S.height-P:S.width-g,w>0&&(y.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(w),de())}function de(){const c=y.value;if(c===null)return;const h=c.getBoundingClientRect(),g=e.vertical===!0?c.scrollTop:Math.abs(c.scrollLeft);ve.value===!0?(ne.value=Math.ceil(g+h.width)<c.scrollWidth-1,te.value=g>0):(ne.value=g>0,te.value=e.vertical===!0?Math.ceil(g+h.height)<c.scrollHeight:Math.ceil(g+h.width)<c.scrollWidth)}function Fe(c){K!==null&&clearInterval(K),K=setInterval(()=>{yt(c)===!0&&ae()},5)}function Ne(){Fe(Te.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ue(){Fe(Te.value===!0?0:Number.MAX_SAFE_INTEGER)}function ae(){K!==null&&(clearInterval(K),K=null)}function bt(c,h){const g=Array.prototype.filter.call(y.value.children,N=>N===h||N.matches&&N.matches(".q-tab.q-focusable")===!0),R=g.length;if(R===0)return;if(c===36)return ce(g[0]),g[0].focus(),!0;if(c===35)return ce(g[R-1]),g[R-1].focus(),!0;const P=c===(e.vertical===!0?38:37),S=c===(e.vertical===!0?40:39),w=P===!0?-1:S===!0?1:void 0;if(w!==void 0){const N=ve.value===!0?-1:1,x=g.indexOf(h)+w*N;return x>=0&&x<R&&(ce(g[x]),g[x].focus({preventScroll:!0})),!0}}const wt=T(()=>Te.value===!0?{get:c=>Math.abs(c.scrollLeft),set:(c,h)=>{c.scrollLeft=-h}}:e.vertical===!0?{get:c=>c.scrollTop,set:(c,h)=>{c.scrollTop=h}}:{get:c=>c.scrollLeft,set:(c,h)=>{c.scrollLeft=h}});function yt(c){const h=y.value,{get:g,set:R}=wt.value;let P=!1,S=g(h);const w=c<S?-1:1;return S+=w*5,S<0?(P=!0,S=0):(w===-1&&S<=c||w===1&&S>=c)&&(P=!0,S=c),R(h,S),de(),P}function We(c,h){for(const g in c)if(c[g]!==h[g])return!1;return!0}function kt(){let c=null,h={matchedLen:0,queryDiff:9999,hrefLen:0};const g=v.filter(w=>w.routeData!==void 0&&w.routeData.hasRouterLink.value===!0),{hash:R,query:P}=r.$route,S=Object.keys(P).length;for(const w of g){const N=w.routeData.exact.value===!0;if(w.routeData[N===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:x,query:Be,matched:Tt,href:At}=w.routeData.resolvedLink.value,Re=Object.keys(Be).length;if(N===!0){if(x!==R||Re!==S||We(P,Be)===!1)continue;c=w.name.value;break}if(x!==""&&x!==R||Re!==0&&We(Be,P)===!1)continue;const re={matchedLen:Tt.length,queryDiff:S-Re,hrefLen:At.length-x.length};if(re.matchedLen>h.matchedLen){c=w.name.value,h=re;continue}else if(re.matchedLen!==h.matchedLen)continue;if(re.queryDiff<h.queryDiff)c=w.name.value,h=re;else if(re.queryDiff!==h.queryDiff)continue;re.hrefLen>h.hrefLen&&(c=w.name.value,h=re)}c===null&&v.some(w=>w.routeData===void 0&&w.name.value===U.value)===!0||Ae({name:c,setCurrent:!0})}function St(c){if(p(),W.value!==!0&&B.value!==null&&c.target&&typeof c.target.closest=="function"){const h=c.target.closest(".q-tab");h&&B.value.contains(h)===!0&&(W.value=!0,X.value===!0&&ce(h))}}function $t(){f(()=>{W.value=!1},30)}function we(){Qe.avoidRouteWatcher===!1?b(kt):A()}function Ge(){if(Z===void 0){const c=ye(()=>r.$route.fullPath,we);Z=()=>{c(),Z=void 0}}}function Ct(c){v.push(c),F.value++,be(),c.routeData===void 0||r.$route===void 0?b(()=>{if(X.value===!0){const h=U.value,g=h!=null&&h!==""?v.find(R=>R.name.value===h):null;g&&ce(g.rootRef.value)}}):(Ge(),c.routeData.hasRouterLink.value===!0&&we())}function qt(c){v.splice(v.indexOf(c),1),F.value--,be(),Z!==void 0&&c.routeData!==void 0&&(v.every(h=>h.routeData===void 0)===!0&&Z(),we())}const Qe={currentModel:U,tabProps:oe,hasFocus:W,hasActiveTab:ft,registerTab:Ct,unregisterTab:qt,verifyRouteModel:we,updateModel:Ae,onKbdNavigate:bt,avoidRouteWatcher:!1};Dt(ot,Qe);function He(){z!==null&&clearTimeout(z),ae(),Z!==void 0&&Z()}let Ke;return lt(He),Et(()=>{Ke=Z!==void 0,He()}),Lt(()=>{Ke===!0&&Ge(),be()}),()=>k("div",{ref:B,class:gt.value,role:"tablist",onFocusin:St,onFocusout:$t},[k(Ft,{onResize:Oe}),k("div",{ref:y,class:pt.value,onScroll:de},ut(a.default)),k(me,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(ne.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||t.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:Ne,onTouchstartPassive:Ne,onMouseupPassive:ae,onMouseleavePassive:ae,onTouchendPassive:ae}),k(me,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(te.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||t.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:Ue,onTouchstartPassive:Ue,onMouseupPassive:ae,onMouseleavePassive:ae,onTouchendPassive:ae})])}});const ca=k("div",{class:"q-space"});var dt=ge({name:"QSpace",setup(){return()=>ca}});const da=L({name:"BrrCalcToolbarCallSellingAgent",emits:["activity_log"],data(){return{dialog_visible:G(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"call_agent",text:"Called selling agent spoke to ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),_a={class:"brrcalctoolbar"},ha=n("div",{class:"text-h6"},"Log call with selling agent",-1);function fa(e,a,s,r,t,i){return m(),M("div",_a,[l(E,{color:"primary",icon:"call",label:"Selling agent",onClick:e.open_dialog},null,8,["onClick"]),l(ze,{modelValue:e.dialog_visible,"onUpdate:modelValue":a[3]||(a[3]=o=>e.dialog_visible=o)},{default:d(()=>[l(J,null,{default:d(()=>[l(V,{class:"row items-center q-pb-none"},{default:d(()=>[ha,l(dt),_e(l(E,{icon:"close",flat:"",round:"",dense:""},null,512),[[Le]])]),_:1}),l(V,null,{default:d(()=>[n("div",null,[l(H,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":a[0]||(a[0]=o=>e.spoke_to=o),label:"Spoke to",rules:[o=>o.length>2||"Too short"]},null,8,["modelValue","rules"])]),n("div",null,[l(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":a[1]||(a[1]=o=>e.notes=o),label:"Notes",rules:[o=>o.length>2||"Too short"]},null,8,["modelValue","rules"])]),l(Ve,{align:"right",class:"text-primary"},{default:d(()=>[l(E,{icon:"call",label:"Cancel",onClick:a[2]||(a[2]=o=>this.dialog_visible=!1)}),l(E,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ma=O(da,[["render",fa]]);const ga=L({name:"BrrCalcToolbarResearchCall",emits:["activity_log"],data(){return{dialog_visible:G(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"research_call",text:"Research call with ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),pa={class:"brrcalctoolbar"},va=n("div",{class:"text-h6"},"Log research call",-1);function ba(e,a,s,r,t,i){return m(),M("div",pa,[l(E,{color:"primary",icon:"call",label:"Research",onClick:e.open_dialog},null,8,["onClick"]),l(ze,{modelValue:e.dialog_visible,"onUpdate:modelValue":a[3]||(a[3]=o=>e.dialog_visible=o)},{default:d(()=>[l(J,null,{default:d(()=>[l(V,{class:"row items-center q-pb-none"},{default:d(()=>[va,l(dt),_e(l(E,{icon:"close",flat:"",round:"",dense:""},null,512),[[Le]])]),_:1}),l(V,null,{default:d(()=>[n("div",null,[l(H,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":a[0]||(a[0]=o=>e.spoke_to=o),label:"Spoke to",rules:[o=>o.length>2||"Too short"]},null,8,["modelValue","rules"])]),n("div",null,[l(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":a[1]||(a[1]=o=>e.notes=o),label:"Notes",rules:[o=>o.length>2||"Too short"]},null,8,["modelValue","rules"])]),l(Ve,{align:"right",class:"text-primary"},{default:d(()=>[l(E,{icon:"call",label:"Cancel",onClick:a[2]||(a[2]=o=>this.dialog_visible=!1)}),l(E,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var wa=O(ga,[["render",ba]]);const ya=2,ka=L({name:"BrrCalcToolbarSaveButton",props:["reason_project_not_savable"],emits:["saveproject"],data(){return{changed:!1,autosave_seconds_left:60,ever_saved:!1,save_in_progress:!1,save_monitor_function_running:!1,pending_set_changed:!1}},computed:{no_save_message(){return this.reason_project_not_savable!==""?this.reason_project_not_savable:this.save_in_progress?"Saving...":""},can_save(){return this.save_in_progress?!1:!!this.changed},save_btn_text(){return this.save_in_progress?"Saving...":this.no_save_message!==""?"Not able to save ("+this.no_save_message+")":this.changed?this.autosave_seconds_left===-1?"Save Now":"Save now (auto save in "+this.autosave_seconds_left+")":this.ever_saved?"Saved":"Not able to save (No changes)"}},methods:{serializer_load_data(e){this.ever_saved=!0},click_btn(){this.autosave_seconds_left=-1,this.save_now()},set_changed_true(){if(this.pending_set_changed){console.log("SaveButton.vue:set_changed_true - set changed called but there is already one pending");return}if(this.save_in_progress){console.log("SaveButton.vue:set_changed_true - Delay set changed due to save in progress");const e=this;setTimeout(function(){e.pending_set_changed=!1,e.set_changed_true()},1e3);return}this.changed=!0,this.no_save_message===""&&(this.autosave_seconds_left=ya,this.start_save_monitor_function())},start_save_monitor_function(){this.save_monitor_function_running||this.save_monitor_function()},save_monitor_function(){if(this.save_monitor_function_running=!0,this.save_in_progress)return;if(this.autosave_seconds_left===-1){this.save_monitor_function_running=!1;return}const e=this;if(e.autosave_seconds_left=e.autosave_seconds_left-1,e.autosave_seconds_left<1){this.save_monitor_function_running=!1,this.save_now();return}setTimeout(e.save_monitor_function,1e3)},save_now(){!this.can_save||(this.save_in_progress=!0,this.$emit("saveproject"))},save_project_complete_notification({success:e,response:a}){console.log("SaveButton - Save completed notification recieved"),this.save_in_progress=!1,e?(this.changed=!1,this.ever_saved=!0):this.autosave_seconds_left=-1}}}),Sa={class:"brrcalctoolbar"};function $a(e,a,s,r,t,i){return m(),M("div",Sa,[l(E,{color:"primary",icon:"save",label:e.save_btn_text,onClick:e.click_btn},null,8,["label","onClick"])])}var Ca=O(ka,[["render",$a]]);const qa=L({name:"BrrCalcToolbar",props:["reason_project_not_savable"],emits:["activity_log","saveproject"],components:{CallSellingAgent:ma,ResearchCall:wa,SaveButton:Ca},data(){return{}},computed:{ever_saved(){return this.$refs.SaveToolbar.ever_saved}},methods:{set_changed_true(){this.$refs.SaveToolbar.set_changed_true()},save_project_complete_notification(e){this.$refs.SaveToolbar.save_project_complete_notification(e)},serializer_load_data(e){this.$refs.SaveToolbar.serializer_load_data(e)}}}),Ta={class:"row brrcalctoolbar"};function Aa(e,a,s,r,t,i){const o=C("SaveButton"),u=C("CallSellingAgent"),f=C("ResearchCall");return m(),M("div",Ta,[l(o,{ref:"SaveToolbar",onSaveproject:a[0]||(a[0]=p=>e.$emit("saveproject")),reason_project_not_savable:e.reason_project_not_savable},null,8,["reason_project_not_savable"]),l(u,{onActivity_log:a[1]||(a[1]=p=>e.$emit("activity_log",p))}),l(f,{onActivity_log:a[2]||(a[2]=p=>e.$emit("activity_log",p))})])}var Ba=O(qa,[["render",Aa]]);function xe(){return{flip:!1,hmo:!1}}const Ra=L({name:"BrrCalcVision",emits:["projectchanged"],data(){return{devplan:"",strategy:xe(),emit_project_change_notification:!0}},computed:{serializer_card_data(){return{devplan:this.devplan,strategy:this.strategy}}},watch:{serializer_card_data(e){this.setchanged()}},methods:{setchanged(){this.emit_project_change_notification&&this.$emit("projectchanged","Vision")},helpdevplan(){this.$q.dialog({title:"What is the development plan?",message:"Enter the development plan. E.g. Split into two flats"}).onOk(()=>{})},serializer_load_data(e){this.emit_project_change_notification=!1,this.devplan=e.devplan,typeof e.strategy=="undefined"?this.strategy=xe():(this.strategy.flip=e.strategy.flip,this.strategy.hmo=e.strategy.hmo);const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}}}),Pa=n("div",{class:"text-h6"},"Vision",-1),Ia={class:"row"},ja=n("div",{class:"text-h6"},"Strategies",-1);function Ma(e,a,s,r,t,i){return m(),I(J,{inline:"",class:"q-ma-sm card-style"},{default:d(()=>[l(V,null,{default:d(()=>[Pa,n("div",Ia,[l(H,{modelValue:e.devplan,"onUpdate:modelValue":a[0]||(a[0]=o=>e.devplan=o),label:"What is the development plan?",class:"col-grow"},null,8,["modelValue"]),l(E,{round:"",color:"primary",icon:"info",onClick:e.helpdevplan},null,8,["onClick"])]),$(" \xA0 "),ja,n("div",null,[l($e,{modelValue:e.strategy.flip,"onUpdate:modelValue":a[1]||(a[1]=o=>e.strategy.flip=o),label:"Flip",onClick:e.setchanged},null,8,["modelValue","onClick"])]),n("div",null,[l($e,{modelValue:e.strategy.hmo,"onUpdate:modelValue":a[2]||(a[2]=o=>e.strategy.hmo=o),label:"HMO",onClick:e.setchanged},null,8,["modelValue","onClick"])])]),_:1})]),_:1})}var Va=O(Ra,[["render",Ma]]);const za=L({name:"BrrCalcFinance",emits:["projectchanged"],props:["gdv_total"],data(){return{refinance:{userefinance:!0,ltv:{min:75,max:75}},emit_project_change_notification:!0}},methods:{format_currency(e){return he.format_currency(e)},serializer_load_data(e){this.emit_project_change_notification=!1,this.refinance.userefinance=e.refinance_userefinance,this.refinance.ltv=e.refinance_userefinance_ltv;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","Refinance")}},computed:{serializer_card_data(){return{refinance_userefinance:this.refinance.userefinance,refinance_userefinance_ltv:this.refinance.ltv}},get_refinance(){return this.refinance},refinanceamount(){return{worst:this.gdv_total.min*(this.refinance.ltv.min/100),best:this.gdv_total.max*(this.refinance.ltv.max/100)}},refinance_out_items(){let e=[];return this.refinance.userefinance&&e.push({name:"Mortgage Refinance",worst:this.refinanceamount.worst,best:this.refinanceamount.best}),e}}}),Da=n("div",{class:"text-h6"},"Refinance",-1),Ea={key:0};function La(e,a,s,r,t,i){return m(),I(J,{inline:"",class:"q-ma-sm card-style"},{default:d(()=>[l(V,null,{default:d(()=>[Da,$(" This section is for adding refinance details. After the refurbishment is complete the refinance stage can be used to pull money out of the deal. "),l($e,{modelValue:e.refinance.userefinance,"onUpdate:modelValue":a[0]||(a[0]=o=>e.refinance.userefinance=o),label:"Refinance after refurbishment"},null,8,["modelValue"]),e.refinance.userefinance?(m(),M("div",Ea,[$(" Refinance LTV "+_(e.refinance.ltv.min)+"% - "+_(e.refinance.ltv.max)+"% ",1),l(Ht,{modelValue:e.refinance.ltv,"onUpdate:modelValue":a[1]||(a[1]=o=>e.refinance.ltv=o),min:0,max:100,step:5,"thumb-size":"40px","drag-range":"",label:"","left-label-value":e.refinance.ltv.min+"%","right-label-value":e.refinance.ltv.max+"%"},null,8,["modelValue","left-label-value","right-label-value"]),n("div",null,"Refinance amount: "+_(e.format_currency(e.refinanceamount.worst))+" - "+_(e.format_currency(e.refinanceamount.best)),1)])):j("",!0)]),_:1})]),_:1})}var Oa=O(za,[["render",La]]),fe=ge({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:a}){const s=T(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>k("tr",{class:s.value},ut(a.default))}});function _t(e){return e.filter(function(a){return a.type==="ledger"})}function Me(e,a){e.push({type:"blank",key:e.length}),e.push({type:"title",key:e.length,name:a})}function se(e,a,s,r){let t=_t(e);var i=void 0,o=void 0;t.length>0&&(i=t[t.length-1].worst,o=t[t.length-1].best);function u(f,p){var b=0;typeof f!="undefined"&&(b=f.bal);var A="",B="";return p>0?A=p:B=p,{in:A,out:B,bal:b+p}}e.push({type:"ledger",key:e.length,name:a,worst:u(i,s),best:u(o,r)})}const Fa=L({name:"BrrCalcDealSummary",props:["is_valid_input","purchaserange","finance_in_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","finance_out_items","refinance_out_items","finance_during_items"],components:{InvalidMessage:ct},data(){return{table:{columns:[{name:"item",label:"Item",field:"item"},{name:"win",label:"In",field:"win"},{name:"wout",label:"Out",field:"wout"},{name:"wbal",label:"Balance",field:"wbal"},{name:"bin",label:"In",field:"bin"},{name:"bout",label:"Out",field:"bout"},{name:"bbal",label:"Balance",field:"bbal"}]}}},methods:{format_currency(e){return typeof e=="string"&&e===""?"":he.format_currency(e)}},computed:{final_bal(){let e=_t(this.items);return e.length===0?{worst:0,best:0}:{worst:e[e.length-1].worst.bal,best:e[e.length-1].best.bal}},money_in(){var e=this.finance_in_items.reduce((s,r)=>s+r.worst,0),a=this.finance_in_items.reduce((s,r)=>s+r.best,0);return{worst:e,best:a}},items(){var e=[];typeof this.finance_in_items!="undefined"&&this.finance_in_items.map(function(s){se(e,s.name,s.worst,s.best)}),typeof this.purchase_items!="undefined"&&this.purchase_items.map(function(s){se(e,s.name,s.worst,s.best)}),typeof this.stampduty_items!="undefined"&&this.stampduty_items.map(function(s){se(e,s.name,s.worst,s.best)}),typeof this.othercosts_items!="undefined"&&this.othercosts_items.map(function(s){se(e,s.name,s.worst,s.best)}),Me(e,"During Project"),typeof this.finance_during_items!="undefined"&&this.finance_during_items.map(function(s){se(e,s.name,s.worst,s.best)}),typeof this.refurb_cost_items!="undefined"&&this.refurb_cost_items.map(function(s){se(e,s.name,s.worst,s.best)});let a=!1;return typeof this.refinance_out_items!="undefined"&&(this.refinance_out_items.length>0&&(a=!0,Me(e,"Exit finance")),this.refinance_out_items.map(function(s){se(e,s.name,s.worst,s.best)})),typeof this.finance_out_items!="undefined"&&(this.finance_out_items.length>0&&(a||Me(e,"Exit finance")),this.finance_out_items.map(function(s){se(e,s.name,s.worst,s.best)})),e}}}),Na=n("div",{class:"text-h6"},"Cashflow Summary",-1),Ua=n("div",{class:"text-subtitle2"},"This section gives a break down of money in and out of the deal. It is broken down twice, for best and worst case figures.",-1),Wa=n("div",null," \xA0 ",-1);function Ga(e,a,s,r,t,i){const o=C("InvalidMessage");return m(),I(J,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:d(()=>[l(V,null,{default:d(()=>[Na,Ua]),_:1}),l(V,null,{default:d(()=>[l(o,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),n("div",null,[l(Ut,{columns:e.table.columns,rows:e.items,"hide-bottom":"","rows-per-page-options":[100]},{header:d(u=>[l(fe,null,{default:d(()=>[l(Q),l(Q,{colspan:"3",class:"worstcasetablecell"},{default:d(()=>[$("Worst Case")]),_:1}),l(Q,{colspan:"3"},{default:d(()=>[$("Best Case")]),_:1})]),_:1}),l(fe,{props:u},{default:d(()=>[l(Q,null,{default:d(()=>[$(" Item ")]),_:1}),l(Q,{class:"worstcasetablecell"},{default:d(()=>[$(" In ")]),_:1}),l(Q,{class:"worstcasetablecell"},{default:d(()=>[$(" Out ")]),_:1}),l(Q,{class:"worstcasetablecell"},{default:d(()=>[$(" Balance ")]),_:1}),l(Q,null,{default:d(()=>[$(" In ")]),_:1}),l(Q,null,{default:d(()=>[$(" Out ")]),_:1}),l(Q,null,{default:d(()=>[$(" Balance ")]),_:1})]),_:2},1032,["props"])]),body:d(u=>[u.row.type==="ledger"?(m(),I(fe,{key:0},{default:d(()=>[l(le,{class:"tablerowcell"},{default:d(()=>[$(_(u.row.name),1)]),_:2},1024),l(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.worst.in)),1)]),_:2},1024),l(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.worst.out)),1)]),_:2},1024),l(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.worst.bal)),1)]),_:2},1024),l(le,{class:"valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.best.in)),1)]),_:2},1024),l(le,{class:"valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.best.out)),1)]),_:2},1024),l(le,{class:"valuetablecell tablerowcell"},{default:d(()=>[$(_(e.format_currency(u.row.best.bal)),1)]),_:2},1024)]),_:2},1024)):j("",!0),u.row.type==="blank"?(m(),I(fe,{key:1},{default:d(()=>[l(Q,{colspan:"7"},{default:d(()=>[$("\xA0")]),_:1})]),_:1})):j("",!0),u.row.type==="title"?(m(),I(fe,{key:2},{default:d(()=>[l(Q,{colspan:"7"},{default:d(()=>[$(_(u.row.name),1)]),_:2},1024)]),_:2},1024)):j("",!0)]),_:1},8,["columns","rows"])]),Wa]),_:1})]),_:1})}var Qa=O(Fa,[["render",Ga]]);const Ha=L({name:"BrrCalcDealRatingAlternativeSummary",props:["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"],methods:{format_currency(e){return he.format_currency(e)}},computed:{mortgage_rate_display(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max+"%",worst:this.finance_refinance.ltv.min+"%"}:{best:"N/A",worst:"N/A"}},mortgage(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max/100*this.purchaserange.min,worst:this.finance_refinance.ltv.min/100*this.purchaserange.max}:{best:0,worst:0}},deposit(){return{best:this.purchaserange.min-this.mortgage.best,worst:this.purchaserange.max-this.mortgage.worst}},total_money_in(){return{best:this.mortgage.best+this.deposit.best+this.stampduty_total.min+this.othercosts_total.min+this.refurb_cost_total.min,worst:this.mortgage.worst+this.deposit.worst+this.stampduty_total.max+this.othercosts_total.max+this.refurb_cost_total.max}},new_mortgage_amount(){return{best:this.gdv_total.max*(this.finance_refinance.ltv.max/100),worst:this.gdv_total.min*(this.finance_refinance.ltv.min/100)}},monay_pulled_out(){return{best:this.gdv_total.max-this.new_mortgage_amount.best,worst:this.gdv_total.min-this.new_mortgage_amount.worst}},profit(){return{best:this.gdv_total.max-this.total_money_in.best,worst:this.gdv_total.min-this.total_money_in.worst}},money_left_in(){return{best:this.monay_pulled_out.best-this.profit.best,worst:this.monay_pulled_out.worst-this.profit.worst}}}}),Ka={class:"alternativetable"},Ya=n("thead",null,[n("tr",null,[n("th",{class:"text-left alternativetablecell"}),n("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),n("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Ja=n("td",{class:"text-left alternativetablecell"},"Price offered",-1),Xa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Za={class:"text-right alternativetablecell yellowtablecell totaltablecell"},xa=n("td",{class:"text-left alternativetablecell"},"Mortgage %",-1),er={class:"text-right alternativetablecell yellowtablecell totaltablecell"},tr={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ar=n("td",{class:"text-left alternativetablecell"},"Mortgage",-1),rr={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},sr={class:"text-right alternativetablecell totaltablecell"},nr=n("td",{class:"text-left alternativetablecell"},"Deposit",-1),or={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},lr={class:"text-right alternativetablecell totaltablecell"},ir=n("td",{class:"text-left alternativetablecell"},"Stamp Duty",-1),ur={class:"text-right alternativetablecell yellowtablecell totaltablecell"},cr={class:"text-right alternativetablecell yellowtablecell totaltablecell"},dr=n("td",{class:"text-left alternativetablecell"},"Other costs (Legals, etc)",-1),_r={class:"text-right alternativetablecell yellowtablecell totaltablecell"},hr={class:"text-right alternativetablecell yellowtablecell totaltablecell"},fr=n("td",{class:"text-left alternativetablecell"},"Total Refurb Costs",-1),mr={class:"text-right alternativetablecell bluetablecell totaltablecell"},gr={class:"text-right alternativetablecell bluetablecell totaltablecell"},pr=n("td",{class:"text-left alternativetablecell"},"Total Money In",-1),vr={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},br={class:"text-right alternativetablecell totaltablecell"},wr=n("tr",null,[n("td",null,"\xA0"),n("td",{class:"worstcasetablecell"}),n("td")],-1),yr=n("td",{class:"text-left alternativetablecell"},"End Value",-1),kr={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Sr={class:"text-right alternativetablecell yellowtablecell totaltablecell"},$r=n("td",{class:"text-left alternativetablecell"},"New Mortgage Amount",-1),Cr={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},qr={class:"text-right alternativetablecell totaltablecell"},Tr=n("td",{class:"text-left alternativetablecell"},"Money Pulled Out",-1),Ar={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Br={class:"text-right alternativetablecell totaltablecell"},Rr=n("tr",null,[n("td",null,"\xA0"),n("td",{class:"worstcasetablecell"}),n("td")],-1),Pr=n("td",{class:"text-left alternativetablecell"},"Profit",-1),Ir={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},jr={class:"text-right alternativetablecell totaltablecell"},Mr=n("td",{class:"text-left alternativetablecell"},"Money Left In",-1),Vr={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},zr={class:"text-right alternativetablecell totaltablecell"};function Dr(e,a,s,r,t,i){return m(),I(ta,{"expand-separator":"",label:"Alternative summary format"},{default:d(()=>[n("div",null,[$(" This is another way of viewing the project numbers that is commonly used. I have included this for comparison. "),n("table",Ka,[Ya,n("tbody",null,[n("tr",null,[Ja,n("td",Xa,_(e.format_currency(e.purchaserange.max)),1),n("td",Za,_(e.format_currency(e.purchaserange.min)),1)]),n("tr",null,[xa,n("td",er,_(e.mortgage_rate_display.worst),1),n("td",tr,_(e.mortgage_rate_display.best),1)]),n("tr",null,[ar,n("td",rr,_(e.format_currency(e.mortgage.worst)),1),n("td",sr,_(e.format_currency(e.mortgage.best)),1)]),n("tr",null,[nr,n("td",or,_(e.format_currency(e.deposit.worst)),1),n("td",lr,_(e.format_currency(e.deposit.best)),1)]),n("tr",null,[ir,n("td",ur,_(e.format_currency(e.stampduty_total.max)),1),n("td",cr,_(e.format_currency(e.stampduty_total.min)),1)]),n("tr",null,[dr,n("td",_r,_(e.format_currency(e.othercosts_total.max)),1),n("td",hr,_(e.format_currency(e.othercosts_total.min)),1)]),n("tr",null,[fr,n("td",mr,_(e.format_currency(e.refurb_cost_total.max)),1),n("td",gr,_(e.format_currency(e.refurb_cost_total.min)),1)]),n("tr",null,[pr,n("th",vr,_(e.format_currency(e.total_money_in.worst)),1),n("th",br,_(e.format_currency(e.total_money_in.best)),1)]),wr,n("tr",null,[yr,n("td",kr,_(e.format_currency(e.gdv_total.min)),1),n("td",Sr,_(e.format_currency(e.gdv_total.max)),1)]),n("tr",null,[$r,n("td",Cr,_(e.format_currency(e.new_mortgage_amount.worst)),1),n("td",qr,_(e.format_currency(e.new_mortgage_amount.best)),1)]),n("tr",null,[Tr,n("td",Ar,_(e.format_currency(e.monay_pulled_out.worst)),1),n("td",Br,_(e.format_currency(e.monay_pulled_out.best)),1)]),Rr,n("tr",null,[Pr,n("td",Ir,_(e.format_currency(e.profit.worst)),1),n("td",jr,_(e.format_currency(e.profit.best)),1)]),n("tr",null,[Mr,n("td",Vr,_(e.format_currency(e.money_left_in.worst)),1),n("td",zr,_(e.format_currency(e.money_left_in.best)),1)])])]),$(" Note: The profit amounts may not match because this method does not take into account finance costs. ")])]),_:1})}var Er=O(Ha,[["render",Dr]]);const Lr=L({name:"BrrCalcDealRatingCompareDoneup",props:["purchaserange","refurb_cost_total","gdv_total"],methods:{format_currency(e){return he.format_currency(e)},format_percent(e){return he.format_percent(e)}},computed:{total_spent(){return{worst:this.purchaserange.max+this.refurb_cost_total.max,best:this.purchaserange.min+this.refurb_cost_total.min}},gain(){return{worst:this.gdv_total.min-this.total_spent.worst,best:this.gdv_total.max-this.total_spent.best}},profit_percentage(){return{worst:this.gain.worst/this.total_spent.worst,best:this.gain.best/this.total_spent.best}}}}),Or=n("div",{class:"text-h5"},"Compare this project to buying a done up property",-1),Fr=n("div",null,"This section compares this project with buying a property that is already done up. To account for the time and risk involved with a refurbishment we expect the end value of the property to be more than if we had just bought one.",-1),Nr={class:"alternativetable"},Ur=n("thead",null,[n("tr",null,[n("th",{class:"text-left alternativetablecell"}),n("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),n("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Wr=n("td",{class:"text-left alternativetablecell"},"Purchase + Refurb",-1),Gr={class:"text-right alternativetablecell worstcasetablecell"},Qr={class:"text-right alternativetablecell"},Hr=n("td",{class:"text-left alternativetablecell"},"End Value",-1),Kr={class:"text-right alternativetablecell worstcasetablecell"},Yr={class:"text-right alternativetablecell"},Jr=n("td",{class:"text-left alternativetablecell totaltablecell"},"Gain",-1),Xr={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Zr={class:"text-right alternativetablecell totaltablecell"},xr=n("td",{class:"text-left alternativetablecell totaltablecell"},"Percentage",-1),es={class:"text-right alternativetablecell worstcasetablecell finaltotaltablecell"},ts={class:"text-right alternativetablecell finaltotaltablecell"};function as(e,a,s,r,t,i){return m(),M("div",null,[Or,Fr,n("table",Nr,[Ur,n("tbody",null,[n("tr",null,[Wr,n("td",Gr,_(e.format_currency(e.total_spent.worst)),1),n("td",Qr,_(e.format_currency(e.total_spent.best)),1)]),n("tr",null,[Hr,n("td",Kr,_(e.format_currency(e.gdv_total.min)),1),n("td",Yr,_(e.format_currency(e.gdv_total.max)),1)]),n("tr",null,[Jr,n("td",Xr,_(e.format_currency(e.gain.worst)),1),n("td",Zr,_(e.format_currency(e.gain.best)),1)]),n("tr",null,[xr,n("td",es,_(e.format_percent(e.profit_percentage.worst)),1),n("td",ts,_(e.format_percent(e.profit_percentage.best)),1)])])])])}var rs=O(Lr,[["render",as]]);const ss=L({name:"BrrCalcDealRating",props:["is_valid_input","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","purchaserange","stampduty_total","othercosts_total","refurb_cost_total"],components:{dealRatingAlternativeSummary:Er,FeatureTable:Kt,InvalidMessage:ct,dealRatingCompareDoneup:rs},data(){return{}},methods:{format_currency(e){return he.format_currency(e)}},computed:{features(){let e=[];var a=Math.min(this.cash_out_of_deal_minus_cash_in.best,this.cash_out_of_deal_minus_cash_in.worst);a>0?e.push({type:"positive",text:"All money out deal! - All initial investment returned plus at least "+this.format_currency(a)}):e.push({type:"negative",text:"Not all money out deal! - Might leave "+this.format_currency(-1*a)+" in."});var s=Math.min(this.profit.best,this.profit.worst);s<0?e.push({type:"negative",text:"Deal makes a loss! - End value might be "+this.format_currency(-1*s)+" less than investment."}):s<this.gdv_total.min*.25?e.push({type:"negative",text:"Low amount of profit! - Low profit "+this.format_currency(s)+" less than 25% of gdv."}):e.push({type:"positive",text:"Profit making deal! - Profit of "+this.format_currency(s)+"!"});var r=Math.min(this.annualroi.worst,this.annualroi.best);return r<3?e.push({type:"negative",text:"Very low ROI! "+r.toFixed(1)+"%"}):r>10&&e.push({type:"positive",text:"Good ROI! "+r.toFixed(1)+"%"}),e},cash_out_of_deal_minus_cash_in(){return{best:this.deal_summary_final_bal.best-this.finance_totalmoneyneeded.best,worst:this.deal_summary_final_bal.worst-this.finance_totalmoneyneeded.worst}},percent_left_in(){return this.finance_refinance.userefinance?{best:100-this.finance_refinance.ltv.max,worst:100-this.finance_refinance.ltv.min}:{best:100,worst:100}},amount_equity_left_in(){return{best:this.gdv_total.max*(this.percent_left_in.best/100),worst:this.gdv_total.min*(this.percent_left_in.worst/100)}},total_end_value(){return{best:this.amount_equity_left_in.best+this.deal_summary_final_bal.best,worst:this.amount_equity_left_in.worst+this.deal_summary_final_bal.worst}},profit(){return{best:this.total_end_value.best-this.finance_totalmoneyneeded.best,worst:this.total_end_value.worst-this.finance_totalmoneyneeded.worst}},roi(){return{best:100*this.profit.best/this.finance_totalmoneyneeded.best,worst:100*this.profit.worst/this.finance_totalmoneyneeded.worst}},annualroi(){return{worst:this.roi.worst*(12/this.refurbmonths.worst),best:this.roi.best*(12/this.refurbmonths.best)}}}}),ns=n("div",{class:"text-h6"},"Project Rating",-1),os=n("div",{class:"text-subtitle2"},"How good is this project?",-1),ls=n("div",{class:"text-h5"},"Profit/Loss",-1),is=n("div",null,"Compare what we have put into the deal vs what we get out of it. These calculations won't account for time invested or the risk taken on in the project",-1),us={class:"text-h5"},cs=n("div",{class:"text-h6"},"Deal Features",-1);function ds(e,a,s,r,t,i){const o=C("InvalidMessage"),u=C("dealRatingCompareDoneup"),f=C("dealRatingAlternativeSummary"),p=C("FeatureTable");return m(),I(J,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:d(()=>[l(V,null,{default:d(()=>[ns,os]),_:1}),l(V,null,{default:d(()=>[l(o,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),ls,is,n("div",us,"Total cash in: "+_(e.format_currency(e.finance_totalmoneyneeded.worst))+" - "+_(e.format_currency(e.finance_totalmoneyneeded.best))+" Worst - Best",1),l(u,{purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","refurb_cost_total","gdv_total"])]),_:1}),l(V,null,{default:d(()=>[l(f,{purchaserange:e.purchaserange,finance_refinance:e.finance_refinance,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"])]),_:1}),l(V,null,{default:d(()=>[cs,l(p,{features:e.features,"onUpdate:features":a[0]||(a[0]=b=>e.features=b)},null,8,["features"])]),_:1})]),_:1})}var _s=O(ss,[["render",ds]]);function hs(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}function et(e,a){return{id:hs(),label:e,displaytext:a}}const fs=L({name:"WebLinksComponent",props:["weblinks"],emits:["updateweblinks"],data(){return{edit_dialog:{visible:!1,record:{},title:"",message:""}}},computed:{weblinkdisplay(){return this.weblinks.map(function(e){if(typeof e.displaytext!="undefined"&&e.displaytext!=null&&e.displaytext.trim().length>0)return{id:e.id,label:e.label,text:e.displaytext,icon:"star"};const a=new URL(e.label);let s="web",r=a.hostname;return a.hostname==="www.google.com"&&(a.pathname.startsWith("/maps/@")&&(a.pathname.includes("/data=")?(r="Google Streetview",s="streetview"):(r="Google Map",s="map")),a.pathname.startsWith("/maps/place")&&(r="Google Place",s="place")),{id:e.id,label:e.label,text:r,icon:s}})}},methods:{editweblink(e){this.edit_dialog.record=JSON.parse(JSON.stringify(this.weblinks.filter(function(a){return a.id===e})[0])),this.edit_dialog.title="Edit Weblink",this.edit_dialog.message="",this.edit_dialog.visible=!0},editweblinkok(){if(!this.validate_weblink(this.edit_dialog.record))return;const e=this,a=this.weblinks.filter(function(s){return e.edit_dialog.record.id!==s.id});a.push(this.edit_dialog.record),this.edit_dialog.visible=!1,e.$emit("updateweblinks",a)},apiaddweblink({url:e,displaytext:a}){const s=this.weblinks.filter(function(r){return!0});s.push(et(e,a)),this.$emit("updateweblinks",s)},clickweblink(e){window.open(e.label,"_blank").focus()},delweblink(e){const a=this.weblinks.filter(function(s){return e!==s.id});this.edit_dialog.visible=!1,this.$emit("updateweblinks",a)},validate_weblink(e){return typeof e.label=="undefined"?(Y.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1):e.label===null?(Y.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1):e.label.startsWith("http")?!0:(Y.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1)},addweblink(){this.edit_dialog.title="Add Weblink",this.edit_dialog.message="Add weblink to information about this property (rightmove, zoopla, etc.)",this.edit_dialog.record=et("",""),this.edit_dialog.visible=!0}}}),ms={class:"text-h6"},gs={style:{width:"25vw"}};function ps(e,a,s,r,t,i){return m(),M("div",null,[(m(!0),M(De,null,Ee(e.weblinkdisplay,o=>(m(),M("div",{key:o},[l(Wt,{clickable:"",onClick:u=>e.clickweblink(o),removable:"",onRemove:u=>e.editweblink(o.id),color:"primary","text-color":"white",icon:o.icon,"icon-remove":"edit"},{default:d(()=>[$(_(o.text),1)]),_:2},1032,["onClick","onRemove","icon"])]))),128)),l(E,{round:"",color:"primary",icon:"add",onClick:e.addweblink},null,8,["onClick"]),l(ze,{modelValue:e.edit_dialog.visible,"onUpdate:modelValue":a[3]||(a[3]=o=>e.edit_dialog.visible=o)},{default:d(()=>[l(J,null,{default:d(()=>[l(V,null,{default:d(()=>[n("div",ms,_(e.edit_dialog.title),1)]),_:1}),l(V,{class:"q-pt-none"},{default:d(()=>[n("div",gs,[$(_(e.edit_dialog.message)+" ",1),l(H,{modelValue:e.edit_dialog.record.displaytext,"onUpdate:modelValue":a[0]||(a[0]=o=>e.edit_dialog.record.displaytext=o),label:"Display Text",clearable:""},null,8,["modelValue"]),l(H,{modelValue:e.edit_dialog.record.label,"onUpdate:modelValue":a[1]||(a[1]=o=>e.edit_dialog.record.label=o),label:"URL",clearable:""},null,8,["modelValue"])])]),_:1}),l(Ve,{align:"right"},{default:d(()=>[l(E,{flat:"",label:"Delete",color:"negative",onClick:a[2]||(a[2]=o=>e.delweblink(e.edit_dialog.record.id))}),_e(l(E,{flat:"",label:"Cancel",color:"primary"},null,512),[[Le]]),l(E,{flat:"",label:"OK",onClick:e.editweblinkok},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var vs=O(fs,[["render",ps]]);function tt(){return{type:"self",value:""}}const bs=L({name:"DealBasicInfo",emits:["projectchanged"],props:["ever_saved"],components:{Weblinks:vs},setup(){return{backend_connection_store:Ce()}},data(){return{patch:{id:"notset",name:"Not Set"},address:"",postcode:"",weblinks:[],new_patch_value:"",selling_agent:"",notes:"",emit_project_change_notification:!0,deal_source:tt(),deal_source_local_only:{self_check_box:!0,value:""}}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:serializer")}},computed:{deal_source_is_self(){return this.deal_source.type==="self"},serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,weblinks:this.weblinks,selling_agent:this.selling_agent,notes:this.notes,deal_source:this.deal_source}},reason_project_not_savable(){return this.patch.id==="notset"?"Select patch":typeof this.address=="undefeind"||this.address===null||this.address.length<3?"Enter address":""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{apiaddweblink(e){return this.$refs.Weblinks.apiaddweblink(e)},updatedealsource(){let e="self";this.deal_source_local_only.self_check_box===!1&&(e="text");let a=this.deal_source_local_only.value;this.deal_source={type:e,value:a}},updateweblinks(e){this.weblinks=e,this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:updateweblinks")},serializer_load_data(e){this.emit_project_change_notification=!1,this.address=e.address,this.postcode=e.postcode,this.weblinks=e.weblinks,this.selling_agent=e.selling_agent,this.notes=e.notes,this.patch=this.patch_list.filter(function(s){return s.id===e.patch_id})[0],typeof e.deal_source=="undefined"?this.deal_source=tt():this.deal_source=e.deal_source,this.deal_source_local_only.self_check_box=this.deal_source.type==="self",this.deal_source_local_only.value=this.deal_source.value,this.updatedealsource();const a=this;setTimeout(function(){a.emit_project_change_notification=!0,a.changed=!1,a.autosave_seconds_left=-1},50)},select_patch_by_id(e){this.patch=this.patch_list.filter(function(a){return a.id===e})[0]},select_patch(e){if(e.id==="create"){const a=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(s=>{a.new_patch_value=s;const r={ok:a.createpatchcallback,error:function(i){Y.create({color:"negative",message:"Create patch failed "+i.response.data.message,timeout:2e3})}},t={patch_name:s};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:t,callback:r})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(a){return a.name===e.new_patch_value})[0],this.new_patch_value=""},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const a={ok:function(s){Y.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(s){Y.create({color:"negative",message:"Copy failed",timeout:2e3})}};aa.copyTextToClipboard2(e,a)}}}),ws=n("div",{class:"text-h6"},"Basic Information",-1),ys=n("div",{class:"text-subtitle2"},"Basic information about this project",-1),ks={key:0},Ss={key:1},$s=n("div",{class:"text-h6"},"Weblinks",-1),Cs=n("div",null,"Deal Source",-1);function qs(e,a,s,r,t,i){const o=C("Weblinks");return e.security_role_cansave?(m(),I(J,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:d(()=>[l(V,null,{default:d(()=>[ws,ys]),_:1}),l(V,null,{default:d(()=>[e.ever_saved?j("",!0):(m(),M("div",ks,[l(Gt,{modelValue:e.patch,"onUpdate:modelValue":[a[0]||(a[0]=u=>e.patch=u),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(m(),M("div",Ss," Patch: "+_(e.patch.name),1)):j("",!0),n("div",null,[l(H,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":a[1]||(a[1]=u=>e.address=u),label:"Address"},null,8,["modelValue"])]),n("div",null,[l(H,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":a[3]||(a[3]=u=>e.postcode=u),label:"Postcode"},{append:d(()=>[e.isEmpty(e.postcode)?j("",!0):(m(),I(me,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:a[2]||(a[2]=u=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])])]),_:1}),l(ke,{class:"basic-info-seperator"}),l(V,null,{default:d(()=>[n("div",null,[$s,l(o,{ref:"Weblinks",weblinks:e.weblinks,onUpdateweblinks:e.updateweblinks},null,8,["weblinks","onUpdateweblinks"])]),l(ke,{class:"basic-info-seperator"}),n("div",null,[l(H,{filled:"",clearable:"",modelValue:e.selling_agent,"onUpdate:modelValue":a[4]||(a[4]=u=>e.selling_agent=u),label:"Selling Agent"},null,8,["modelValue"])]),l(ke,{class:"basic-info-seperator"}),n("div",null,[l(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":a[5]||(a[5]=u=>e.notes=u),label:"Notes"},null,8,["modelValue"])]),l(ke,{class:"basic-info-seperator"}),Cs,n("div",null,[l($e,{modelValue:e.deal_source_local_only.self_check_box,"onUpdate:modelValue":[a[6]||(a[6]=u=>e.deal_source_local_only.self_check_box=u),e.updatedealsource],label:"Self sourced"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",null,[l(H,{filled:"",autogrow:"",modelValue:e.deal_source_local_only.value,"onUpdate:modelValue":[a[7]||(a[7]=u=>e.deal_source_local_only.value=u),e.updatedealsource],label:"Name of source",disable:e.deal_source_local_only.self_check_box},null,8,["modelValue","disable","onUpdate:modelValue"])])]),_:1})]),_:1})):j("",!0)}var Ts=O(bs,[["render",qs]]);function As(e,a,s){const r=[];r.push({range:"Main!A1",values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),r.push({range:"Main!A2:B2",values:[["Patch:",a.patch.name]]}),r.push({range:"Main!A3:B3",values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),r.push({range:"Main!E3:E3",values:[[a.serialized_data.dealbasicinfo.postcode]]}),r.push({range:"Main!A4:A4",values:[["Links:"]]});let t=3;return a.serialized_data.dealbasicinfo.weblinks.forEach(function(i){t=t+1,r.push({range:"Main!B"+t.toString()+":B"+t.toString(),values:[['=HYPERLINK("'+i.label+'", "'+i.label+'")']]})}),t=t+1,t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Selling Agent:",a.serialized_data.dealbasicinfo.selling_agent]]}),t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Notes:",a.serialized_data.dealbasicinfo.notes]]}),t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Vision:",a.serialized_data.vision.devplan]]}),t=t+1,t=t+1,r.push({range:"Main!A"+t.toString()+":A"+t.toString(),values:[["Caculations provided here are for reference only and should be manually checked."]]}),r}function Bs(e,a,s){const r=[];return r.push({repeatCell:{range:{sheetId:s.Main,startRowIndex:0,endRowIndex:a.serialized_data.dealbasicinfo.weblinks.length+6+1,startColumnIndex:0,endColumnIndex:1},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}),r}var at={get_sheet_main_values:As,get_sheet_main:Bs};function Rs(e){function a(s,r,t,i,o){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:i},cell:{userEnteredFormat:{numberFormat:{type:"NUMBER",pattern:o}}},fields:"userEnteredFormat.numberFormat"}}}return{makeboldandvaligntop:function(s,r,t,i){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:i},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeitalicandvaligntop:function(s,r,t,i){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:i},cell:{userEnteredFormat:{textFormat:{italic:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},formatnumbermisc:function(s,r,t,i,o){return a(s,r,t,i,o)},formatcurrency:function(s,r,t,i){return a(s,r,t,i,"[$\xA3-809]#,##0.00")},formatpercentage:function(s,r,t,i){return a(s,r,t,i,"0.00%")},adjustcolumnwidth:function(s,r){return{updateDimensionProperties:{range:{sheetId:e,dimension:"COLUMNS",startIndex:s,endIndex:s+1},properties:{pixelSize:r},fields:"pixelSize"}}}}}var qe={get_sheet_utils:Rs};const D="Purchase Phase";function Ps(e,a,s){return{name:"Buying Cash",pre_stage:function(r){},start_details:function(r){return[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(r){return[]}}}function Is(e,a,s){return{name:"Buying with a Mortgage",pre_stage:function(r,t){const i=[],o=r.cur_row;r.cur_row=r.cur_row+1,r.value_requests.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["","Worst","Best"]]}),r.requests.push(t.makeboldandvaligntop(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]}),r.requests.push(t.formatcurrency(o,r.cur_row,1,3)),r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Mortage Rate",a.serialized_data.finance.mortgage.rate.max/100,a.serialized_data.finance.mortgage.rate.min/100]]}),r.requests.push(t.formatpercentage(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Mortgage LTV",a.serialized_data.finance.mortgage.ltv.max/100,a.serialized_data.finance.mortgage.ltv.min/100]]}),r.requests.push(t.formatpercentage(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Total Mortgage","=B"+(o+2).toString()+"*B"+(r.cur_row-1).toString(),"=C"+(o+2).toString()+"*C"+(r.cur_row-1).toString()]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Monthly Payments","=(B"+(r.cur_row-1).toString()+"*B"+(o+3).toString()+")/12","=(C"+(r.cur_row-1).toString()+"*C"+(o+3).toString()+")/12"]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.misc_data.monthly_payments_row=r.cur_row,r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Deposit","=B"+(o+2).toString()+"-B"+(r.cur_row-2).toString(),"=C"+(o+2).toString()+"-C"+(r.cur_row-2).toString()]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.misc_data.deposit_row=r.cur_row,r.cur_row=r.cur_row+1,i.push({range:D+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Refurb Duration Months",a.serialized_data.refurbcost.refurbtimerange.max,a.serialized_data.refurbcost.refurbtimerange.min]]}),r.requests.push(t.formatnumbermisc(r.cur_row-1,r.cur_row,1,3,"0")),r.misc_data.refurb_duration_row=r.cur_row,r.requests.push(t.makeboldandvaligntop(o,r.cur_row,0,1)),r.cur_row=r.cur_row+1,r.value_requests.push(i)},start_details:function(r){return[["Deposit","=B"+r.misc_data.deposit_row.toString(),"=C"+r.misc_data.deposit_row.toString()],["Mortgage Arangement",a.serialized_data.finance.mortgage.arrangementfee,a.serialized_data.finance.mortgage.arrangementfee]]},end_details:function(r){return[["Mortgage Payments","=B"+r.misc_data.monthly_payments_row.toString()+"*B"+r.misc_data.refurb_duration_row.toString(),"=C"+r.misc_data.monthly_payments_row.toString()+"*C"+r.misc_data.refurb_duration_row.toString()],["(During refurbishment)","",""]]}}}function js(e,a,s){return{name:"Buying with a Bridge",pre_stage:function(r){},start_details:function(r){return[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(r){return[["Bridge Costs",a.finance_bridgecost.worst,a.finance_bridgecost.best]]}}}function Ms(e,a,s){return a.serialized_data.finance.mortgage.usemortgage?Is(e,a):a.serialized_data.finance.bridge.usebridge?js(e,a):Ps(e,a)}function Vs(e,a,s){const r=qe.get_sheet_utils(s[D]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};t.requests.push(r.adjustcolumnwidth(0,170)),t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",a.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:D+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[a.serialized_data.dealbasicinfo.postcode]]}),t.requests.push(r.makeboldandvaligntop(0,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const i=Ms(e,a);t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[i.name]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),i.pre_stage(t,r),t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["","Worst","Best"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,1,3));const o=t.cur_row;let u=i.start_details(t);return u.push(["Refurbishment",a.refurb_cost_total.max,a.refurb_cost_total.min]),u.push(["Stamp Duty",a.stampduty_total.max,a.stampduty_total.min]),a.othercosts_items_detail.forEach(function(f){u.push([f.name,-1*f.worst,-1*f.best])}),a.caculated_loan_details.forEach(function(f){u.push([f.name+" interest",f.interest,f.interest])}),u=u.concat(i.end_details(t)),u.forEach(function(f){t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[[f[0],f[1],f[2]]]}),f[0]==="(During refurbishment)"?t.requests.push(r.makeitalicandvaligntop(t.cur_row-1,t.cur_row,0,1)):t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1))}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:D+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Total Money needed","=SUM(B"+(o+1).toString()+":B"+(t.cur_row-1).toString()+")","=SUM(C"+(o+1).toString()+":C"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,3)),t.requests.push(r.formatcurrency(o,t.cur_row,1,3)),{value_requests:t.value_requests,requests:t.requests}}var zs={sheet_name:D,get_sheet_values:Vs};const ee="GDV Comparables";function Ds(e,a,s){const r=qe.get_sheet_utils(s[ee]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const i=[120,246,100,74,100,100,47,100,100,100,145,100,198];let o=0;for(;o<i.length;)t.requests.push(r.adjustcolumnwidth(o,i[o])),o++;t.cur_row=t.cur_row+1,t.value_requests.push({range:ee+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:ee+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",a.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:ee+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:ee+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[a.serialized_data.dealbasicinfo.postcode]]}),t.cur_row=t.cur_row+1,["EPC Floorspace:","Type:","Condition:","Sold History"].forEach(function(A){t.value_requests.push({range:ee+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[A]]}),t.cur_row=t.cur_row+1}),t.requests.push(r.makeboldandvaligntop(0,t.cur_row-1,0,1)),t.cur_row=t.cur_row+6,t.value_requests.push({range:ee+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["Source","Address","Type","Price type","Amount","Date","SQM","price per sqm","Condition","Value of ours","Distance","Place","Notes"]]}),t.cur_row=t.cur_row+1,t.requests.push(r.makeboldandvaligntop(t.cur_row-2,t.cur_row-1,0,13));const f=t.cur_row;let p=0;for(;p<15;)t.value_requests.push({range:ee+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["","","","SOLD","","","","=E"+t.cur_row.toString()+"/G"+t.cur_row.toString(),"","=H"+t.cur_row.toString()+"*$B$4","","",""]]}),t.cur_row=t.cur_row+1,p++;const b=t.cur_row;return t.requests.push(r.formatcurrency(f-1,b-1,4,5)),t.requests.push(r.formatcurrency(f-1,b-1,7,8)),t.requests.push(r.formatcurrency(f-1,b-1,9,10)),{value_requests:t.value_requests,requests:t.requests}}var Es={sheet_name:ee,get_sheet_values:Ds};function Ls(e,a,s,r,t){e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString(),values:[[t]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Patch:",s.patch.name]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Address:",s.serialized_data.dealbasicinfo.address]]}),e.requests.push(r.makeboldandvaligntop(0,e.cur_row,0,1)),e.cur_row=e.cur_row+1}var ht={header:Ls};const q="HMO Monthly Profit Estimate";function Os(e,a,s){const r=qe.get_sheet_utils(s[q]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const i=[100,100,100,100,30];let o=0;for(;o<i.length;)t.requests.push(r.adjustcolumnwidth(o,i[o])),o++;ht.header(t,q,a,r,"Comparison of HMO income vs running costs"),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Caculation"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":F"+t.cur_row.toString(),values:[["Option 1","","","","","Option 2"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Room","Num","Monthly Rate","Total","","Room","Num","Monthly Rate","Total"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9));const u=[["Ensuite","-1","550"],["Non-ensuite","-1","500"],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]],f=t.cur_row;u.forEach(function(y){t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[[y[0],y[1],y[2],"=B"+t.cur_row.toString()+"*C"+t.cur_row.toString(),"",y[0],y[1],y[2],"=G"+t.cur_row.toString()+"*H"+t.cur_row.toString()]]})}),t.cur_row=t.cur_row+1;const p=t.cur_row;t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Total","=sum(B"+(f+1).toString()+":B"+(t.cur_row-1).toString()+")","","=sum(D"+(f+1).toString()+":D"+(t.cur_row-1).toString()+")","","Total","=sum(G"+(f+1).toString()+":G"+(t.cur_row-1).toString()+")","","=sum(I"+(f+1).toString()+":I"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9)),t.requests.push(r.formatcurrency(f-1,t.cur_row,2,4)),t.requests.push(r.formatcurrency(f-1,t.cur_row,7,9)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const b=t.cur_row;t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Used Figure","=D"+p.toString(),"(Select the total of the option above to use for the profit caculation)"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Costs"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const A=t.cur_row;t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Management","=B"+b.toString()+"*0.15","(assumed 15%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Maintainance","=B"+b.toString()+"*0.1","(10%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["Council tax","=1370.41/12","TODO VERIFY","(Put Band and link to local authority council tax page here as a note)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Gas","155","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Electric","120","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Water","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Internet","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Building insurance","","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company insurance",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company account",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["TV Licence","14.13","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["HMO Licence","16.25","TODO VERIFY","(Place link to council HMO licencing page here)"]]}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const B=t.cur_row;return t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Spend","=sum(B"+A.toString()+":B"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Profit","=B"+b.toString()+"-B"+B.toString()]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.requests.push(r.formatcurrency(A-1,t.cur_row,1,2)),{value_requests:t.value_requests,requests:t.requests}}var Fs={sheet_name:q,get_sheet_values:Os};const ie="HMO Room Sizes";function Ns(e,a,s){const r=qe.get_sheet_utils(s[ie]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const i=[130,100,58,58,100,200,200];let o=0;for(;o<i.length;)t.requests.push(r.adjustcolumnwidth(o,i[o])),o++;ht.header(t,ie,a,r,"List of room sizes to check against licence standards"),t.cur_row=t.cur_row+1,t.value_requests.push({range:ie+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Total area (sqm)"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const u=t.cur_row;return t.value_requests.push({range:ie+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["Level","Room on plan","x","y","sqm","Reconfig Use","Notes"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),[["Ground","Kitchen","-1","-1"],["Ground","Dinning Room","-1","-1"],["Bedroom","Dinning Room","-1","-1"],["","","2",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""]].forEach(function(p){t.cur_row=t.cur_row+1,t.value_requests.push({range:ie+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[[p[0],p[1],p[2],p[3],"=C"+t.cur_row.toString()+"*D"+t.cur_row.toString(),"",""]]})}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:ie+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["","","","Total","=sum(E"+(u+1).toString()+":E"+(t.cur_row-1).toString()+")","",""]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),{value_requests:t.value_requests,requests:t.requests}}var Us={sheet_name:ie,get_sheet_values:Ns};const Ws=L({name:"SaveToGoogleSheetCompoennt",emits:["apiaddweblink","activity_log"],props:["serialized_data","patch","refurb_cost_total","stampduty_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost"],setup(){return{backend_connection_store:Ce()}},data(){return{}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave}},methods:{click_export(){je.show();const e=google.accounts.oauth2.initTokenClient({client_id:this.$rjmgclientid,scope:this.$rjmgscopes,callback:this.execute_export});gapi.client.getToken()===null?e.requestAccessToken({prompt:"consent"}):e.requestAccessToken({prompt:""})},execute_export(){try{gapi.client.sheets.spreadsheets.create({properties:{title:"evernetproperties.com-"+this.patch.name+"-"+this.serialized_data.dealbasicinfo.address}}).then(e=>{this.spreadsheets_batchupdate(e.result)})}catch(e){this.sheet_api_error_handler(e);return}},spreadsheets_batchupdate(e){let a={Main:e.sheets[0].properties.sheetId},s=[];s.push({updateSheetProperties:{properties:{sheetId:e.sheets[0].properties.sheetId,title:"Main"},fields:"title"}});let r=[zs,Es];typeof this.serialized_data.vision.strategy!="undefined"&&this.serialized_data.vision.strategy.hmo&&(r.push(Fs),r.push(Us));let t=0;for(;t<r.length;)s.push({addSheet:{properties:{title:r[t].sheet_name}}}),t++;s=s.concat(at.get_sheet_main(e,this,a));const i={requests:s};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:i}).then(o=>{const u=o.result;console.log("spreadsheet Batch Update result",o.result.replies),o.result.replies.forEach(function(f){if(typeof f.addSheet!="undefined"){let p=0;for(;p<r.length;)f.addSheet.properties.title===r[p].sheet_name&&(a[r[p].sheet_name]=f.addSheet.properties.sheetId),p++}}),this.spreadsheets_batchupdate_after_all_sheets_added(e,a,r)})}catch(o){this.sheet_api_error_handler(o);return}},spreadsheets_batchupdate_after_all_sheets_added(e,a,s){let r=[],t=[];t=t.concat(at.get_sheet_main_values(e,this,a));let i=0;for(;i<s.length;){let u=s[i].get_sheet_values(e,this,a);r=r.concat(u.requests),t=t.concat(u.value_requests),i++}if(r.length===0){console.log("No requests required"),this.spreadsheets_values_batchupdate(e,a,t);return}const o={requests:r};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:o}).then(u=>{const f=u.result;console.log("spreadsheet Batch Update after all sheets added result",u.result.replies),this.spreadsheets_values_batchupdate(e,a,t)})}catch(u){this.sheet_api_error_handler(u);return}},spreadsheets_values_batchupdate(e,a,s){const r={data:s,valueInputOption:"USER_ENTERED"};try{gapi.client.sheets.spreadsheets.values.batchUpdate({spreadsheetId:e.spreadsheetId,resource:r}).then(t=>{const i=t.result;console.log(`${i.totalUpdatedCells} cells updated.`),this.sheet_final_complete(e)})}catch(t){this.sheet_api_error_handler(t);return}},open_sheet(e){window.open(e.spreadsheetUrl,"_blank").focus()},sheet_api_error_handler(e){je.hide(),console.log("Error-"+e.message),Y.create({color:"negative",message:"Export to google sheets failed "+e.message,timeout:2e3})},sheet_final_complete(e){this.$emit("apiaddweblink",{url:e.spreadsheetUrl,displaytext:"My Calc"});const a={type:"admin",text:"Generated google sheet",head_notes:"Calculation"};this.$emit("activity_log",a),this.open_sheet(e),je.hide()}}}),Gs=n("div",{class:"text-h6"},"Export to Spreadsheet",-1),Qs=n("div",{class:"text-subtitle2"},"Export figures into a google docs spreadsheet.",-1),Hs=n("div",{class:"textdiv"}," This feature will generate a spreadsheet containing all the current values for this project and output it to a document in your google drive. ",-1);function Ks(e,a,s,r,t,i){return e.security_role_cansave?(m(),I(J,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:d(()=>[l(V,null,{default:d(()=>[Gs,Qs]),_:1}),l(V,null,{default:d(()=>[n("div",null,[l(E,{color:"primary",icon:"save",label:"Export to google sheets",onClick:e.click_export},null,8,["onClick"])]),Hs]),_:1})]),_:1})):j("",!0)}var Ys=O(Ws,[["render",Ks]]),rt=ge({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:a}){const s=T(()=>e.sent===!0?"sent":"received"),r=T(()=>`q-message-text-content q-message-text-content--${s.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),t=T(()=>`q-message-text q-message-text--${s.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),i=T(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),o=T(()=>e.size!==void 0?`col-${e.size}`:""),u=T(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function f(b){return a.stamp!==void 0?[b,k("div",{class:"q-message-stamp"},a.stamp())]:e.stamp?[b,k("div",{class:"q-message-stamp",[u.value.stamp]:e.stamp})]:[b]}function p(b,A){const B=A===!0?b.length>1?y=>y:y=>k("div",[y]):y=>k("div",{[u.value.msg]:y});return b.map((y,U)=>k("div",{key:U,class:t.value},[k("div",{class:r.value},f(B(y)))]))}return()=>{const b=[];a.avatar!==void 0?b.push(a.avatar()):e.avatar!==void 0&&b.push(k("img",{class:`q-message-avatar q-message-avatar--${s.value}`,src:e.avatar,"aria-hidden":"true"}));const A=[];a.name!==void 0?A.push(k("div",{class:`q-message-name q-message-name--${s.value}`},a.name())):e.name!==void 0&&A.push(k("div",{class:`q-message-name q-message-name--${s.value}`,[u.value.name]:e.name})),a.default!==void 0?A.push(p(Ot(a.default()),!0)):e.text!==void 0&&A.push(p(e.text)),b.push(k("div",{class:o.value},A));const B=[];return a.label!==void 0?B.push(k("div",{class:"q-message-label"},a.label())):e.label!==void 0&&B.push(k("div",{class:"q-message-label",[u.value.label]:e.label})),B.push(k("div",{class:i.value},b)),k("div",{class:`q-message q-message-${s.value}`},B)}}});function st(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}const Js=L({name:"BrrCalcActivityJob",emits:["projectchanged"],data(){return{activity_log:[],emit_project_change_notification:!0}},computed:{serializer_card_data(){return this.activity_log},activity_log_display(){let e=[];const a={book_viewing:{sent:!0,name:"Viewing booked"},hold_viewing:{sent:!1,name:"Viewing"},call_agent:{sent:!0,name:"Call to agent"},research_call:{sent:!0,name:"Research Call"},wf_move:{sent:!1,name:"Workflow"},admin:{sent:!1,name:"Admin action"},offer_made:{sent:!0,name:"Offer made"},offer_rejected:{sent:!1,name:"Offer rejected"},offer_accepted:{sent:!1,name:"Offer accepted"}};let s="";return this.activity_log.forEach(function(r){const t=new Date(r.timestamp),i=t.toDateString(),o=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});s!==i&&(s=i,e=e.concat([{id:st(),label:s}]));let u=a[r.type].name;typeof r.head_notes!="undefined"&&(u=u+" ("+r.head_notes+")"),e=e.concat({id:r.t,label:void 0,name:u,text:r.text,sent:a[r.type].sent,stamp:o,avatar:"activity_log_icon_"+r.type+".png"})}),e}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","ActivityLog:serializer")}},methods:{log_activity(e){var a=this.activity_log.filter(function(s){return!0});a.push({id:st(),type:e.type,timestamp:new Date().toISOString(),text:e.text,head_notes:e.head_notes}),this.activity_log=a,this.$emit("projectchanged","ActivityLog:log_activity")},serializer_load_data(e){this.emit_project_change_notification=!1,this.activity_log=e;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}}}),Xs=n("div",{class:"text-h6"},"Activity Log",-1),Zs={style:{width:"100%","max-width":"400px"}},xs={key:0},en={key:1},tn=["src"];function an(e,a,s,r,t,i){return m(),I(J,{inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:d(()=>[l(V,null,{default:d(()=>[Xs,n("div",Zs,[(m(!0),M(De,null,Ee(e.activity_log_display,o=>(m(),M("div",{key:o.id},[typeof o.label=="string"?(m(),M("div",xs,[l(rt,{label:o.label},null,8,["label"])])):j("",!0),typeof o.label=="undefined"?(m(),M("div",en,[l(rt,{name:o.name,text:[o.text],sent:o.sent,stamp:o.stamp,avatar:o.avatar},{avatar:d(()=>[n("img",{class:"q-message-avatar q-message-avatar--sent",alt:"Avatar",src:"/"+o.avatar},null,8,tn)]),_:2},1032,["name","text","sent","stamp","avatar"])])):j("",!0)]))),128))])]),_:1})]),_:1})}var rn=O(Js,[["render",an]]);function nt(){return{workflow_used_id:Se.default_workflow_id,current_stage:Se.workflows[Se.default_workflow_id].initial_stage}}const sn=L({name:"BrrCalcWorkflow",emits:["projectchanged","activity_log"],data(){return{workflow_data:nt(),emit_project_change_notification:!0}},computed:{serializer_card_data(){return this.workflow_data},workflow_model(){return Se.workflows[this.workflow_data.workflow_used_id]}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","Workflow")}},methods:{progress(e){const a={type:"wf_move",text:"From "+this.workflow_model.stages[this.workflow_data.current_stage].name+" to "+this.workflow_model.stages[e].name,head_notes:"Progressed through workflow"};this.workflow_data.current_stage=e,this.$emit("activity_log",a)},serializer_load_data(e){this.emit_project_change_notification=!1,typeof e.workflow_used_id=="undefined"?this.workflow_data=nt():this.workflow_data=e;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}}}),nn={class:"text-h6"},on={class:"col"},ln={key:0},un={key:0},cn={key:1,class:"resetbuttondiv"};function dn(e,a,s,r,t,i){return m(),I(J,{inline:"",class:"q-ma-sm card-style"},{default:d(()=>[l(V,null,{default:d(()=>[n("div",nn,"Workflow - "+_(e.workflow_model.name),1),n("div",on,[n("div",null,[n("h3",null,"Stage: "+_(e.workflow_model.stages[e.workflow_data.current_stage].name),1)]),typeof e.workflow_model.stages[e.workflow_data.current_stage].progression!="undefined"?(m(),M("table",ln,[n("tbody",null,[n("tr",null,[n("td",null,[(m(!0),M(De,null,Ee(e.workflow_model.stages[e.workflow_data.current_stage].progression.success,o=>(m(),M("div",{key:o.next_stage},[l(E,{color:"positive",icon:"donut_large",label:"Progress to next stage ("+e.workflow_model.stages[o.next_stage].name+")",onClick:u=>e.progress(o.next_stage)},null,8,["label","onClick"])]))),128))]),typeof e.workflow_model.stages[e.workflow_data.current_stage].progression.failed!="undefined"?(m(),M("td",un,[l(E,{color:"negative",icon:"directions_off",label:e.workflow_model.stages[e.workflow_model.stages[e.workflow_data.current_stage].progression.failed].name,onClick:a[0]||(a[0]=o=>e.progress(e.workflow_model.stages[e.workflow_data.current_stage].progression.failed))},null,8,["label"])])):j("",!0)])])])):j("",!0),e.workflow_data.current_stage!==e.workflow_model.initial_stage?(m(),M("div",cn,[l(E,{icon:"donut_large",label:"Reset workflow",onClick:a[1]||(a[1]=o=>e.progress(e.workflow_model.initial_stage))})])):j("",!0)])]),_:1})]),_:1})}var _n=O(sn,[["render",dn]]);const hn=L({name:"ProjectSerializer",emits:["saveprojectcomplete"],setup(){return{backend_connection_store:Ce()}},data(){return{loaded_project_id:void 0,proj_summary_data:{metadata:void 0,timestamp_first_entered:void 0}}},methods:{serializer_load_data(e){this.loaded_project_id=e.id,this.proj_summary_data.timestamp_first_entered=e.timestamp_first_entered,this.proj_summary_data.metadata=e.metadata},save_project({dict_of_card_info:e,activity_log:a,workflow:s}){const r={};for(const u in Object.keys(e)){const f=Object.keys(e)[u];r[f]=JSON.parse(JSON.stringify(e[f]))}const t={user_id:this.backend_connection_store.user_profile.id,patch_id:e.dealbasicinfo.patch_id,timestamp_first_entered:this.proj_summary_data.timestamp_first_entered,initial_phase:{total_money_in:0,start_value:0,end_value:0,flip_roi:0},reoccurring_phase:[],location:{},workflow:s,activity_log:a,sub_section_details:r,tags:[],risks:[]};typeof this.loaded_project_id!="undefined"?(t.id=this.loaded_project_id,t.metadata=this.proj_summary_data.metadata):t.timestamp_first_entered=new Date().toISOString();const i=this,o={ok:i.save_api_call_success,error:i.save_api_call_fail};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects",method:"POST",data:t,callback:o})},save_api_call_success(e){this.$emit("saveprojectcomplete",{success:!0,response:e}),this.serializer_load_data(e.data),Y.create({color:"positive",message:"Project Saved",timeout:2e3})},save_api_call_fail(e){this.$emit("saveprojectcomplete",{success:!1,response:e}),Y.create({color:"negative",message:"Save failed - "+e.response.data.message,timeout:2e3})}},mounted(){}});function fn(e,a,s,r,t,i){return m(),M("div")}var mn=O(hn,[["render",fn]]);const gn=L({name:"CalcBrrToFlip",components:{GdvCard:Yt,PurchasePrice:Jt,RefurbCost:Xt,StampDuty:Zt,OtherCosts:xt,DealSummary:Qa,Finance:ea,Vision:Va,DealRating:_s,Refinance:Oa,DealBasicInfo:Ts,ProjectSerializer:mn,SaveToGoogleSheet:Ys,ActivityLog:rn,BrrToolbar:Ba,Workflow:_n},setup(){return{backend_connection_store:Ce()}},data(){return{tab:"main",isMounted:!1,purchaserange:{min:18e4,max:19e4}}},computed:{ever_saved(){return this.isMounted?this.security_role_cansave?this.$refs.BrrToolbar.ever_saved:(console.log("WARNING ever_saved checked when cansave is false"),!1):!1},reason_project_not_savable(){return this.isMounted?this.$refs.DealBasicInfo.reason_project_not_savable:""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},is_valid_input(){return this.isMounted?!(!this.$refs.PurchasePrice.isValid||!this.$refs.GdvCard.isValid):!0},deal_summary_final_bal(){return this.isMounted?this.$refs.DealSummary.final_bal:{best:0,worst:0}},finance_refinance(){return this.isMounted?this.$refs.Refinance.get_refinance:{userefinance:!1,ltv:{min:75,max:75}}},caculated_loan_details(){return this.isMounted?this.$refs.Finance.caculated_loan_details:[]},finance_bridgecost(){return this.isMounted?this.$refs.Finance.bridgecost:{best:0,worst:0}},finance_totalmoneyneeded(){return this.isMounted?this.$refs.Finance.totalmoneyneeded:{best:0,worst:0}},finance_in_items(){return this.isMounted?this.$refs.Finance.finance_in_items:[]},finance_during_items(){return this.isMounted?this.$refs.Finance.finance_during_items:[]},finance_out_items(){return this.isMounted?this.$refs.Finance.finance_out_items:[]},refinance_out_items(){return this.isMounted?this.$refs.Refinance.refinance_out_items:[]},purchase_items(){return this.isMounted?this.$refs.PurchasePrice.purchase_items:[]},stampduty_items(){return this.isMounted?this.$refs.StampDuty.stampduty_items:[]},othercosts_items(){return this.isMounted?this.$refs.OtherCosts.othercosts_items:[]},othercosts_items_detail(){return this.isMounted?this.$refs.OtherCosts.othercosts_items_detail:[]},refurb_cost_items(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_items:[]},refurb_cost_total(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_total:[]},refurbmonths(){return this.isMounted?this.$refs.RefurbCost.refurbmonths:[]},stampduty_total(){return this.isMounted?this.$refs.StampDuty.stampduty:[]},othercosts_total(){return this.isMounted?this.$refs.OtherCosts.total:[]},gdv_total(){return this.isMounted?this.$refs.GdvCard.total:[]},serialized_data(){return this.security_role_cansave?this.isMounted?{dealbasicinfo:this.$refs.DealBasicInfo.serializer_card_data,vision:this.$refs.Vision.serializer_card_data,gdvcard:this.$refs.GdvCard.serializer_card_data,purchaseprice:this.$refs.PurchasePrice.serializer_card_data,refurbcost:this.$refs.RefurbCost.serializer_card_data,stampduty:this.$refs.StampDuty.serializer_card_data,othercosts:this.$refs.OtherCosts.serializer_card_data,finance:this.$refs.Finance.serializer_card_data,refinance:this.$refs.Refinance.serializer_card_data}:{}:(console.log("WARNING serialized_data checked when cansave is false"),{})},patch(){return this.isMounted?this.security_role_cansave?this.$refs.DealBasicInfo.patch:(console.log("WARNING patch method called when cansave is false"),{id:"notset",name:"Not Set"}):{id:"notset",name:"Not Set"}}},methods:{apiaddweblink(e){return this.$refs.DealBasicInfo.apiaddweblink(e)},activity_log(e){if(!this.isMounted){console.log("ERROR - trying to log activity unmounted",e);return}this.$refs.ActivityLog.log_activity(e)},projectchanged(e){if(console.log("BrrCalc page recieved project changed from ",e),!this.security_role_cansave)return!1;if(!this.isMounted){console.log("WARNING = projectchanged called when mounted is false");return}if(typeof this.$refs.BrrToolbar=="undefined")return console.log("WARNING = projectchanged called when BrrToolbar is undefined"),!1;this.$refs.BrrToolbar.set_changed_true()},save_project(){this.$refs.ProjectSerializer.save_project({dict_of_card_info:this.serialized_data,activity_log:this.$refs.ActivityLog.serializer_card_data,workflow:this.$refs.Workflow.serializer_card_data})},load_project_into_cards(e){this.$refs.ProjectSerializer.serializer_load_data(e),this.$refs.DealBasicInfo.serializer_load_data(e.sub_section_details.dealbasicinfo),typeof e.sub_section_details.vision!="undefined"&&this.$refs.Vision.serializer_load_data(e.sub_section_details.vision),typeof e.sub_section_details.gdvcard!="undefined"&&this.$refs.GdvCard.serializer_load_data(e.sub_section_details.gdvcard),typeof e.sub_section_details.purchaseprice!="undefined"&&this.$refs.PurchasePrice.serializer_load_data(e.sub_section_details.purchaseprice),typeof e.sub_section_details.refurbcost!="undefined"&&this.$refs.RefurbCost.serializer_load_data(e.sub_section_details.refurbcost),typeof e.sub_section_details.stampduty!="undefined"&&this.$refs.StampDuty.serializer_load_data(e.sub_section_details.stampduty),typeof e.sub_section_details.othercosts!="undefined"&&this.$refs.OtherCosts.serializer_load_data(e.sub_section_details.othercosts),typeof e.sub_section_details.finance!="undefined"&&this.$refs.Finance.serializer_load_data(e.sub_section_details.finance),typeof e.sub_section_details.refinance!="undefined"&&this.$refs.Refinance.serializer_load_data(e.sub_section_details.refinance),this.$refs.ActivityLog.serializer_load_data(e.activity_log),this.$refs.Workflow.serializer_load_data(e.workflow),this.$refs.BrrToolbar.serializer_load_data({})},save_project_complete({success:e,response:a}){this.$refs.BrrToolbar.save_project_complete_notification({success:e,response:a})},load_project_api_fail(e){Y.create({color:"bg-grey-2",message:"Error loading project "+e,timeout:2e3,color:"negative"}),this.load_complete()},load_project_api_success(e){this.load_project_into_cards(e.data),Y.create({color:"bg-grey-2",message:"Project Loaded",timeout:2e3,color:"positive"}),this.load_complete()},load_complete(){const e=this;setTimeout(function(){e.isMounted=!0},105)},call_load_api(){const e=this,a={ok:e.load_project_api_success,error:e.load_project_api_fail};e.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+e.$route.query.projectid,method:"GET",data:void 0,callback:a})}},mounted(){const e=this;if(typeof e.$route.query.projectid=="undefined"){if(e.load_complete(),typeof e.$route.query.patchid!="undefined"){if(!e.security_role_cansave)return;this.$refs.DealBasicInfo.select_patch_by_id(e.$route.query.patchid)}return}if(e.security_role_cansave){e.call_load_api();return}setTimeout(function(){e.call_load_api()},1e3)}}),pn={class:"main-page fit col wrap justify-center items-center content-center"},vn=n("h1",null,"Buy Refurbish Rent Refinance Calculator",-1),bn={class:"row"},wn={class:"row"};function yn(e,a,s,r,t,i){const o=C("BrrToolbar"),u=C("DealBasicInfo"),f=C("Vision"),p=C("GdvCard"),b=C("PurchasePrice"),A=C("RefurbCost"),B=C("StampDuty"),y=C("OtherCosts"),U=C("Finance"),X=C("Refinance"),ne=C("DealSummary"),te=C("DealRating"),ue=C("ProjectSerializer"),v=C("Workflow"),F=C("ActivityLog"),W=C("SaveToGoogleSheet");return m(),I(Qt,{class:"flex"},{default:d(()=>[n("div",pn,[vn,e.security_role_cansave?(m(),I(o,{key:0,ref:"BrrToolbar",reason_project_not_savable:e.reason_project_not_savable,onActivity_log:e.activity_log,onSaveproject:e.save_project},null,8,["reason_project_not_savable","onActivity_log","onSaveproject"])):j("",!0),e.security_role_cansave?(m(),I(ua,{key:1,modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=z=>e.tab=z),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:d(()=>[l(Ze,{name:"main",label:"Main"}),l(Ze,{name:"project",label:"Project"})]),_:1},8,["modelValue"])):j("",!0),_e(n("div",bn,[e.security_role_cansave?(m(),I(u,{key:0,ref:"DealBasicInfo",ever_saved:e.ever_saved,onProjectchanged:e.projectchanged},null,8,["ever_saved","onProjectchanged"])):j("",!0),l(f,{ref:"Vision",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),l(p,{ref:"GdvCard",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),l(b,{ref:"PurchasePrice",purchaserange:e.purchaserange,"onUpdate:purchaserange":a[1]||(a[1]=z=>e.purchaserange=z),onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),l(A,{ref:"RefurbCost",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),l(B,{ref:"StampDuty",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),l(y,{ref:"OtherCosts",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),l(U,{ref:"Finance",purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurbmonths:e.refurbmonths,gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["purchaserange","refurb_cost_total","stampduty_total","othercosts_total","refurbmonths","gdv_total","onProjectchanged"]),l(X,{ref:"Refinance",gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["gdv_total","onProjectchanged"]),l(ne,{ref:"DealSummary",purchaserange:e.purchaserange,finance_in_items:e.finance_in_items,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,refinance_out_items:e.refinance_out_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items","finance_out_items","finance_during_items","refinance_out_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),l(te,{ref:"DealRating",purchaserange:e.purchaserange,finance_totalmoneyneeded:e.finance_totalmoneyneeded,deal_summary_final_bal:e.deal_summary_final_bal,finance_refinance:e.finance_refinance,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","stampduty_total","othercosts_total","refurb_cost_total","is_valid_input"]),e.security_role_cansave?(m(),I(ue,{key:1,ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete},null,8,["onSaveprojectcomplete"])):j("",!0)],512),[[Xe,e.tab==="main"]]),_e(n("div",wn,[e.security_role_cansave?(m(),I(v,{key:0,ref:"Workflow",onProjectchanged:e.projectchanged,onActivity_log:e.activity_log},null,8,["onProjectchanged","onActivity_log"])):j("",!0),e.security_role_cansave?(m(),I(F,{key:1,ref:"ActivityLog",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"])):j("",!0),e.security_role_cansave?(m(),I(W,{key:2,ref:"SaveToGoogleSheet",serialized_data:e.serialized_data,patch:e.patch,stampduty_total:e.stampduty_total,refurb_cost_total:e.refurb_cost_total,othercosts_items_detail:e.othercosts_items_detail,caculated_loan_details:e.caculated_loan_details,finance_bridgecost:e.finance_bridgecost,onApiaddweblink:e.apiaddweblink,onActivity_log:e.activity_log},null,8,["serialized_data","patch","stampduty_total","refurb_cost_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost","onApiaddweblink","onActivity_log"])):j("",!0)],512),[[Xe,e.tab==="project"]])])]),_:1})}var Vn=O(gn,[["render",yn]]);export{Vn as default};
