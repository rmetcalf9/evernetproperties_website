import{d as F,_ as E,o as f,K as p,f as J,t as j,e as m,M as x,O as Q,L as O,r as z,c as K,N as ae,a as C,af as ge,Q as L,k as D,be as Ge,bf as $t,g as Dt,ay as jt,az as It,av as Ot,aF as At,j as he,m as Le,aA as Yt,x as Tt,q as M,u as Vt,aC as qt,a3 as Ht,bg as Nt,a0 as Lt,ai as ve,w as T,ae as Pe,a9 as Be,ah as Pt,aa as Bt,aj as xt,ag as Qt}from"./index.55673ba7.js";import{Q as Ft}from"./QPage.a9d4fe19.js";import{u as Et}from"./backend_connection.8a83e09a.js";import{u as Oe}from"./utils.3f2e20ba.js";import{Q as Zt}from"./QSpace.84a861ff.js";import{T as Ut}from"./TouchPan.24b49aab.js";import{p as k}from"./format.24bb3700.js";import{Q as xe}from"./QPopupProxy.fd62d40b.js";import{C as $e}from"./ClosePopup.978fb5c5.js";import"./axios.6e1fcf85.js";import"./position-engine.e9e8c155.js";const zt=F({name:"CallAssistCallItemShowCallAim",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},data(){return{}}}),Jt=m("h1",null,"Aim of this Call",-1);function Kt(e,t,a,l,o,s){return f(),p("div",null,[Jt,J(" "+j(e.calltemplate.aim),1)])}var Xt=E(zt,[["render",Kt]]);const Rt=F({name:"CallAssistCallItemShowStages",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},data(){return{}}}),Wt=m("h1",null,"Call Plan",-1);function Gt(e,t,a,l,o,s){return f(),p("div",null,[Wt,(f(!0),p(x,null,Q(e.calltemplate.ordered_stages,u=>(f(),p("div",{key:u.id,class:"row"},j(u.name),1))),128))])}var ea=E(Rt,[["render",Gt]]);const ta=F({name:"CallAssistCallItemShowCallAim",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},data(){return{}},methods:{weblink_display_text(e){return typeof e.display_text=="undefined"||e.display_text.length<1?e.label:e.display_text}}}),aa={class:"CallAssistCallItemShowCallAim-maindiv"},na=m("h1",null,"Lead Information",-1),la=m("th",null,"Address:",-1),sa=m("th",null,"Landlord:",-1),ra=m("br",null,null,-1),ia=m("br",null,null,-1),oa=m("th",null,"Advert Notes",-1),ua={key:0},da=m("br",null,null,-1),ca=["href"],ma=m("th",null,"Source",-1);function _a(e,t,a,l,o,s){return f(),p("div",aa,[na,m("div",null,[m("table",null,[m("tr",null,[la,m("td",null,j(e.current_lead.raw.sub_section_details.leadinformation.address)+", "+j(e.current_lead.raw.sub_section_details.leadinformation.postcode),1)]),m("tr",null,[sa,m("td",null,[J(" Name: "+j(e.current_lead.raw.sub_section_details.leadinformation.landlord_name)+" ",1),ra,J(" Phone: "+j(e.current_lead.raw.sub_section_details.leadinformation.contact_phone)+" ",1),ia,J(" Email: "+j(e.current_lead.raw.sub_section_details.leadinformation.contact_email),1)])]),m("tr",null,[oa,m("td",null,[typeof e.current_lead.raw.sub_section_details.leadinformation.advert_information!="undefined"&&e.current_lead.raw.sub_section_details.leadinformation.advert_information!==""?(f(),p("div",ua,[(f(!0),p(x,null,Q(e.current_lead.raw.sub_section_details.leadinformation.advert_information.split(`
`),u=>(f(),p("div",{key:u,class:"projecttablehead"},j(u),1))),128))])):O("",!0),da,(f(!0),p(x,null,Q(e.current_lead.raw.sub_section_details.leadinformation.advertweblinks,u=>(f(),p("div",{key:u.id},[m("a",{href:u.label,target:"_new"},j(e.weblink_display_text(u)),9,ca)]))),128))])]),m("tr",null,[ma,m("td",null,j(e.current_lead.raw.sub_section_details.leadinformation.lead_source),1)])])])])}var ha=E(ta,[["render",_a]]);const fa=F({name:"CallAssistCallItemShowCallAim",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},data(){return{}}}),pa={class:"CallAssistCallItemShowCallAim-main"},va=m("h1",null,"Script Prompt",-1);function ga(e,t,a,l,o,s){return f(),p("div",pa,[va,m("ul",null,[(f(!0),p(x,null,Q(e.item.lines,u=>(f(),p("li",{key:u},j(u),1))),128))])])}var ya=E(fa,[["render",ga]]);function ba(e,t){return t>e.length-2?!1:e[t]==="{"&&e[t+1]==="{"}function wa(e,t){for(var a=t;a<e.length-1;){if(e[a]==="}"&&e[a+1]==="}")return e.substr(t,a+2-t);a++}}function et(e,t){if(e.length===1)return t[e];const a=e[0];return e.shift(),et(e,t[a])}function Ca(e,t){var a=e.substr(2);if(a=a.substr(0,a.length-2).trim(),a==="")return"";const l=a.split(".");return et(l,t)}function ka(e,t){for(var a="",l=0;l<e.length;){if(ba(e,l)){const o=wa(e,l);typeof o=="undefined"?a+=e[l]:(a+=Ca(o,t),l+=o.length-1)}else a+=e[l];l++}return a}var Qe={evalmustachstragainstcontext:ka};const Sa=F({name:"CallAssistCallItemCustomVariableDisplay",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},data(){return{}},computed:{title(){return Qe.evalmustachstragainstcontext(this.item.title,{current_lead:this.current_lead,current_stage:this.current_stage,calltemplate:this.calltemplate,item:this.item,batchdata:this.batchdata})},body(){return Qe.evalmustachstragainstcontext(this.item.body,{current_lead:this.current_lead,calltemplate:this.calltemplate,current_stage:this.current_stage,item:this.item,batchdata:this.batchdata})}}});function Ma(e,t,a,l,o,s){return f(),p("div",null,[m("h1",null,j(e.title),1),m("div",null,[(f(!0),p(x,null,Q(e.body.split(`
`),u=>(f(),p("div",{key:u},j(u),1))),128))])])}var $a=E(Sa,[["render",Ma]]);const Da=F({name:"CallAssistCallItems",props:{current_lead:{type:Object},current_stage:{type:Object},calltemplate:{type:Object},item:{type:Object},batchdata:{type:Object}},components:{ItemShowCallAim:Xt,ItemShowStages:ea,ItemShowLead:ha,ItemScriptPrompt:ya,ItemCustomVariableDisplay:$a},data(){return{}}});function ja(e,t,a,l,o,s){const u=z("ItemShowCallAim"),r=z("ItemShowStages"),d=z("ItemShowLead"),y=z("ItemScriptPrompt"),c=z("ItemCustomVariableDisplay");return f(),p("div",null,[e.item.type==="ShowCallAim"?(f(),K(u,{key:0,current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:e.item,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])):O("",!0),e.item.type==="ShowStages"?(f(),K(r,{key:1,current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:e.item,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])):O("",!0),e.item.type==="ShowLead"?(f(),K(d,{key:2,current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:e.item,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])):O("",!0),e.item.type==="ScriptPrompt"?(f(),K(y,{key:3,current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:e.item,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])):O("",!0),e.item.type==="CustomVariableDisplay"?(f(),K(c,{key:4,current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:e.item,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])):O("",!0)])}var Ia=E(Da,[["render",ja]]);function Fe(){return{notes:""}}const Oa=F({name:"CallAssistCall",props:{current_lead:{type:Object},calltemplate:{type:Object},title_text:{type:String,default:""},batchdata:{type:Object}},emits:["outcome"],components:{CallAssistCallItems:Ia},data(){return{current_stage_id:void 0,call_data:Fe()}},computed:{current_stage(){if(typeof this.current_stage_id!="undefined")return this.calltemplate.stages[this.current_stage_id]}},methods:{set_stage(e){this.current_stage_id=e},get_action_button_color(e){return typeof e.button_color!="undefined"?e.button_color:e.type==="Outcome"?"secondary":"primary"},get_action_button_text_color(e){if(typeof e.button_text_color!="undefined")return e.button_text_color},click_action_button(e){e.type==="Outcome"?this.click_outcome_action_button(e):this.click_next_stage_action_button(e)},click_outcome_action_button(e){this.$emit("outcome",{outcome_id:e.id,call_data:this.call_data})},click_next_stage_action_button(e){if(typeof this.calltemplate.stages[e.next_stage_id]=="undefined"){ae.create({color:"negative",message:"Next stage not found",timeout:2e3});return}this.current_stage_id=e.next_stage_id},reset_call_data(){this.call_data=Fe()},reset_script(){this.set_stage(this.calltemplate.initial_stage_id)}}}),Aa={key:0},Ya={class:"CallAssistCallItems"},Ta=m("h2",null,"Call Free notes",-1),Va=m("h2",null,"Actions",-1),qa={class:"row"},Ha={class:"CallAssistCallItems"};function Na(e,t,a,l,o,s){const u=z("CallAssistCallItems");return typeof e.current_stage_id!="undefined"?(f(),p("div",Aa,[m("h1",null,"Call Lead "+j(e.current_lead.name)+" "+j(e.title_text),1),m("h2",null,"Stage "+j(e.current_stage.name),1),m("div",Ya,[(f(!0),p(x,null,Q(e.current_stage.items,r=>(f(),p("div",{key:r.id},[C(u,{current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:r,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])]))),128))]),Ta,m("div",null,[C(ge,{filled:"",clearable:"",modelValue:e.call_data.notes,"onUpdate:modelValue":t[0]||(t[0]=r=>e.call_data.notes=r),label:"Notes from this call",autogrow:""},null,8,["modelValue"])]),Va,m("div",qa,[(f(!0),p(x,null,Q(e.current_stage.actions,r=>(f(),p("div",{key:r.id,class:"CallAssistCall-actionbutton"},[C(L,{label:r.button_label,color:e.get_action_button_color(r),"text-color":e.get_action_button_text_color(r),onClick:d=>e.click_action_button(r)},null,8,["label","color","text-color","onClick"])]))),128))]),e.current_stage_id!==e.calltemplate.initial_stage_id?(f(),K(L,{key:0,label:"Reset script to start",onClick:e.reset_script},null,8,["onClick"])):O("",!0),m("div",Ha,[(f(!0),p(x,null,Q(e.current_stage.post_action_items,r=>(f(),p("div",{key:r.id},[C(u,{current_lead:e.current_lead,current_stage:e.current_stage,calltemplate:e.calltemplate,item:r,batchdata:e.batchdata},null,8,["current_lead","current_stage","calltemplate","item","batchdata"])]))),128))])])):O("",!0)}var La=E(Oa,[["render",Na]]);const Ee={skip_call_action:{type:"Outcome",id:"skip_call",button_label:"Skip and return to later",button_color:"white",button_text_color:"black"}},Pa=F({name:"CallAssist",emits:["outcome"],components:{CallAssistCall:La},data(){return{prepared:!1,calltemplate:void 0,remaining_leads:void 0,total_leads:void 0,batchdata:void 0}},computed:{current_lead(){if(typeof this.remaining_leads!="undefined"&&!(this.remaining_leads.length<1))return this.remaining_leads[0]},calltitletext(){return typeof this.total_leads=="undefined"?"":"("+this.remaining_leads.length.toString()+" leads remaining)"}},methods:{prepare(e,t,a){const l=this;this.calltemplate=JSON.parse(JSON.stringify(e)),this.batchdata=a;let o={id:Oe.uuidv4(),name:"Prepare for call",items:[{type:"ShowCallAim"},{type:"ShowStages"},{type:"ShowLead"}],actions:[Ee.skip_call_action,{type:"Next_Stage",next_stage_id:this.calltemplate.initial_stage_id,id:"Make_call",button_label:"Ready to Dial..."}]},s={};s[o.id]=o,this.calltemplate.ordered_stages=[],this.calltemplate.ordered_stages.push(o),this.calltemplate.stages.map(function(u){let r=[];r.push(Ee.skip_call_action),u.actions.map(function(d){r.push(d)}),l.calltemplate.common_actions.map(function(d){r.push(JSON.parse(JSON.stringify(d)))}),u.actions=r,s[u.id]=u,l.calltemplate.ordered_stages.push(u)}),this.calltemplate.stages=s,this.calltemplate.initial_stage_id=o.id,this.remaining_leads=t,this.total_leads=t.length,this.$refs.CallAssistCall.set_stage(this.calltemplate.initial_stage_id),this.prepared=!0},outcome(e){console.log("TODO deal with outcome",e);const t={outcome_id:e.outcome_id,call_data:e.call_data,current_lead:this.current_lead};if(this.$emit("outcome",JSON.parse(JSON.stringify(t))),this.remaining_leads.shift(),this.remaining_leads.length>0){this.$refs.CallAssistCall.reset_call_data(),this.$refs.CallAssistCall.set_stage(this.calltemplate.initial_stage_id);return}ae.create({color:"positive",message:"Batch Complete",timeout:2e3}),this.$router.push("/tools")}}}),Ba={class:"callassist"},xa={key:0};function Qa(e,t,a,l,o,s){const u=z("CallAssistCall");return f(),p("div",Ba,[e.prepared?O("",!0):(f(),p("div",xa,"Call assist not prepared")),C(u,{ref:"CallAssistCall",current_lead:e.current_lead,calltemplate:e.calltemplate,title_text:e.calltitletext,batchdata:e.batchdata,onOutcome:e.outcome},null,8,["current_lead","calltemplate","title_text","batchdata","onOutcome"])])}var Fa=E(Pa,[["render",Qa]]),Ea={aim:"Schedule an in person viewing of the property",initial_stage_id:"1",stages:[{id:"1",name:"Qualify the lead",items:[{type:"ScriptPrompt",lines:["Am I speaking to...","I came across your advert for a room on ....","Is the property still availiable?","Do you mind if I ask some questions about the property?"]}],actions:[{type:"Next_Stage",next_stage_id:"2",id:"Investigate",button_label:"Next Stage (Investigate Property)"}],post_action_items:[{type:"ShowLead"}]},{id:"2",name:"Investigate the property",items:[{type:"ScriptPrompt",lines:["General condition","Are you looking for long term or short term tenant?","Is it furnished or unfurnished?","Does it have wifi?","Could it have office or working space for remote working"]}],actions:[{type:"Next_Stage",next_stage_id:"3",id:"landlord_pain",button_label:"Next Stage (Identify landlord pain points)"}],post_action_items:[{type:"ShowLead"}]},{id:"3",name:"Identify Landlord Pain Points",items:[{type:"ScriptPrompt",lines:["How long has it been vacant?","What kind of Tenants do you get in this property? (Professional, student, nurses, etc.)"]}],actions:[{type:"Next_Stage",next_stage_id:"4",id:"landlord_pain",button_label:"Next Stage (Introduce Myself)"}],post_action_items:[{type:"ShowLead"}]},{id:"4",name:"Introduce Myself",items:[{type:"ScriptPrompt",lines:["Can I tell you about myself?"]},{type:"CustomVariableDisplay",title:"My Introduction",body:"{{ batchdata.story_prompt }}"}],actions:[{type:"Next_Stage",next_stage_id:"5",id:"close",button_label:"Next Stage (Close whilst mentioning company let)"}],post_action_items:[{type:"ShowLead"}]},{id:"5",name:"Close whilst Mentioning company let",items:[],actions:[],post_action_items:[{type:"ShowLead"}]}],common_actions:[{type:"Outcome",id:"reject_lead",button_label:"Reject Lead"}]};const X=[-61,9,38,199,426,686,756,818,1111,1181,1210,1635,2060,2097,2192,2262,2324,2394,2456,3178];function Za(e,t,a){return Object.prototype.toString.call(e)==="[object Date]"&&(a=e.getDate(),t=e.getMonth()+1,e=e.getFullYear()),Xa(tt(e,t,a))}function Ua(e){return Ja(e)===0}function za(e,t){return t<=6?31:t<=11||Ua(e)?30:29}function Ja(e){const t=X.length;let a=X[0],l,o,s,u,r;if(e<a||e>=X[t-1])throw new Error("Invalid Jalaali year "+e);for(r=1;r<t&&(l=X[r],o=l-a,!(e<l));r+=1)a=l;return u=e-a,o-u<6&&(u=u-o+S(o+4,33)*33),s=V(V(u+1,33)-1,4),s===-1&&(s=4),s}function Ka(e,t){const a=X.length,l=e+621;let o=-14,s=X[0],u,r,d,y,c;if(e<s||e>=X[a-1])throw new Error("Invalid Jalaali year "+e);for(c=1;c<a&&(u=X[c],r=u-s,!(e<u));c+=1)o=o+S(r,33)*8+S(V(r,33),4),s=u;y=e-s,o=o+S(y,33)*8+S(V(y,33)+3,4),V(r,33)===4&&r-y===4&&(o+=1);const b=S(l,4)-S((S(l,100)+1)*3,4)-150,q=20+o-b;return t||(r-y<6&&(y=y-r+S(r+4,33)*33),d=V(V(y+1,33)-1,4),d===-1&&(d=4)),{leap:d,gy:l,march:q}}function Xa(e){const t=Ra(e).gy;let a=t-621,l,o,s;const u=Ka(a,!1),r=tt(t,3,u.march);if(s=e-r,s>=0){if(s<=185)return o=1+S(s,31),l=V(s,31)+1,{jy:a,jm:o,jd:l};s-=186}else a-=1,s+=179,u.leap===1&&(s+=1);return o=7+S(s,30),l=V(s,30)+1,{jy:a,jm:o,jd:l}}function tt(e,t,a){let l=S((e+S(t-8,6)+100100)*1461,4)+S(153*V(t+9,12)+2,5)+a-34840408;return l=l-S(S(e+100100+S(t-8,6),100)*3,4)+752,l}function Ra(e){let t=4*e+139361631;t=t+S(S(4*e+183187720,146097)*3,4)*4-3908;const a=S(V(t,1461),4)*5+308,l=S(V(a,153),5)+1,o=V(S(a,153),12)+1;return{gy:S(t,1461)-100100+S(8-o,6),gm:o,gd:l}}function S(e,t){return~~(e/t)}function V(e,t){return e-~~(e/t)*t}const Wa=["gregorian","persian"],Ga={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>Wa.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},en=["update:modelValue"];function tn(e){return e.year+"/"+k(e.month)+"/"+k(e.day)}function an(e,t){const a=D(()=>e.disable!==!0&&e.readonly!==!0),l=D(()=>a.value===!0?0:-1),o=D(()=>{const r=[];return e.color!==void 0&&r.push(`bg-${e.color}`),e.textColor!==void 0&&r.push(`text-${e.textColor}`),r.join(" ")});function s(){return e.locale!==void 0?{...t.lang.date,...e.locale}:t.lang.date}function u(r){const d=new Date,y=r===!0?null:0;if(e.calendar==="persian"){const c=Za(d);return{year:c.jy,month:c.jm,day:c.jd}}return{year:d.getFullYear(),month:d.getMonth()+1,day:d.getDate(),hour:y,minute:y,second:y,millisecond:y}}return{editable:a,tabindex:l,headerClass:o,getLocale:s,getCurrentDate:u}}const at=864e5,nn=36e5,Ie=6e4,nt="YYYY-MM-DDTHH:mm:ss.SSSZ",ln=/\[((?:[^\]\\]|\\]|\\)*)\]|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]/g,sn=/(\[[^\]]*\])|d{1,4}|M{1,4}|m{1,2}|w{1,2}|Qo|Do|D{1,4}|YY(?:YY)?|H{1,2}|h{1,2}|s{1,2}|S{1,3}|Z{1,2}|a{1,2}|[AQExX]|([.*+:?^,\s${}()|\\]+)/g,De={};function rn(e,t){const a="("+t.days.join("|")+")",l=e+a;if(De[l]!==void 0)return De[l];const o="("+t.daysShort.join("|")+")",s="("+t.months.join("|")+")",u="("+t.monthsShort.join("|")+")",r={};let d=0;const y=e.replace(sn,b=>{switch(d++,b){case"YY":return r.YY=d,"(-?\\d{1,2})";case"YYYY":return r.YYYY=d,"(-?\\d{1,4})";case"M":return r.M=d,"(\\d{1,2})";case"MM":return r.M=d,"(\\d{2})";case"MMM":return r.MMM=d,u;case"MMMM":return r.MMMM=d,s;case"D":return r.D=d,"(\\d{1,2})";case"Do":return r.D=d++,"(\\d{1,2}(st|nd|rd|th))";case"DD":return r.D=d,"(\\d{2})";case"H":return r.H=d,"(\\d{1,2})";case"HH":return r.H=d,"(\\d{2})";case"h":return r.h=d,"(\\d{1,2})";case"hh":return r.h=d,"(\\d{2})";case"m":return r.m=d,"(\\d{1,2})";case"mm":return r.m=d,"(\\d{2})";case"s":return r.s=d,"(\\d{1,2})";case"ss":return r.s=d,"(\\d{2})";case"S":return r.S=d,"(\\d{1})";case"SS":return r.S=d,"(\\d{2})";case"SSS":return r.S=d,"(\\d{3})";case"A":return r.A=d,"(AM|PM)";case"a":return r.a=d,"(am|pm)";case"aa":return r.aa=d,"(a\\.m\\.|p\\.m\\.)";case"ddd":return o;case"dddd":return a;case"Q":case"d":case"E":return"(\\d{1})";case"Qo":return"(1st|2nd|3rd|4th)";case"DDD":case"DDDD":return"(\\d{1,3})";case"w":return"(\\d{1,2})";case"ww":return"(\\d{2})";case"Z":return r.Z=d,"(Z|[+-]\\d{2}:\\d{2})";case"ZZ":return r.ZZ=d,"(Z|[+-]\\d{2}\\d{2})";case"X":return r.X=d,"(-?\\d+)";case"x":return r.x=d,"(-?\\d{4,})";default:return d--,b[0]==="["&&(b=b.substring(1,b.length-1)),b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}),c={map:r,regex:new RegExp("^"+y)};return De[l]=c,c}function lt(e,t){return e!==void 0?e:t!==void 0?t.date:$t.date}function Ze(e,t=""){const a=e>0?"-":"+",l=Math.abs(e),o=Math.floor(l/60),s=l%60;return a+k(o)+t+k(s)}function fe(e,t,a,l,o){const s={year:null,month:null,day:null,hour:null,minute:null,second:null,millisecond:null,timezoneOffset:null,dateHash:null,timeHash:null};if(o!==void 0&&Object.assign(s,o),e==null||e===""||typeof e!="string")return s;t===void 0&&(t=nt);const u=lt(a,Ge.props),r=u.months,d=u.monthsShort,{regex:y,map:c}=rn(t,u),b=e.match(y);if(b===null)return s;let q="";if(c.X!==void 0||c.x!==void 0){const A=parseInt(b[c.X!==void 0?c.X:c.x],10);if(isNaN(A)===!0||A<0)return s;const P=new Date(A*(c.X!==void 0?1e3:1));s.year=P.getFullYear(),s.month=P.getMonth()+1,s.day=P.getDate(),s.hour=P.getHours(),s.minute=P.getMinutes(),s.second=P.getSeconds(),s.millisecond=P.getMilliseconds()}else{if(c.YYYY!==void 0)s.year=parseInt(b[c.YYYY],10);else if(c.YY!==void 0){const A=parseInt(b[c.YY],10);s.year=A<0?A:2e3+A}if(c.M!==void 0){if(s.month=parseInt(b[c.M],10),s.month<1||s.month>12)return s}else c.MMM!==void 0?s.month=d.indexOf(b[c.MMM])+1:c.MMMM!==void 0&&(s.month=r.indexOf(b[c.MMMM])+1);if(c.D!==void 0){if(s.day=parseInt(b[c.D],10),s.year===null||s.month===null||s.day<1)return s;const A=l!=="persian"?new Date(s.year,s.month,0).getDate():za(s.year,s.month);if(s.day>A)return s}c.H!==void 0?s.hour=parseInt(b[c.H],10)%24:c.h!==void 0&&(s.hour=parseInt(b[c.h],10)%12,(c.A&&b[c.A]==="PM"||c.a&&b[c.a]==="pm"||c.aa&&b[c.aa]==="p.m.")&&(s.hour+=12),s.hour=s.hour%24),c.m!==void 0&&(s.minute=parseInt(b[c.m],10)%60),c.s!==void 0&&(s.second=parseInt(b[c.s],10)%60),c.S!==void 0&&(s.millisecond=parseInt(b[c.S],10)*10**(3-b[c.S].length)),(c.Z!==void 0||c.ZZ!==void 0)&&(q=c.Z!==void 0?b[c.Z].replace(":",""):b[c.ZZ],s.timezoneOffset=(q[0]==="+"?-1:1)*(60*q.slice(1,3)+1*q.slice(3,5)))}return s.dateHash=k(s.year,6)+"/"+k(s.month)+"/"+k(s.day),s.timeHash=k(s.hour)+":"+k(s.minute)+":"+k(s.second)+q,s}function Ue(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate());t.setDate(t.getDate()-(t.getDay()+6)%7+3);const a=new Date(t.getFullYear(),0,4);a.setDate(a.getDate()-(a.getDay()+6)%7+3);const l=t.getTimezoneOffset()-a.getTimezoneOffset();t.setHours(t.getHours()-l);const o=(t-a)/(at*7);return 1+Math.floor(o)}function U(e,t,a){const l=new Date(e),o=`set${a===!0?"UTC":""}`;switch(t){case"year":case"years":l[`${o}Month`](0);case"month":case"months":l[`${o}Date`](1);case"day":case"days":case"date":l[`${o}Hours`](0);case"hour":case"hours":l[`${o}Minutes`](0);case"minute":case"minutes":l[`${o}Seconds`](0);case"second":case"seconds":l[`${o}Milliseconds`](0)}return l}function pe(e,t,a){return(e.getTime()-e.getTimezoneOffset()*Ie-(t.getTime()-t.getTimezoneOffset()*Ie))/a}function on(e,t,a="days"){const l=new Date(e),o=new Date(t);switch(a){case"years":case"year":return l.getFullYear()-o.getFullYear();case"months":case"month":return(l.getFullYear()-o.getFullYear())*12+l.getMonth()-o.getMonth();case"days":case"day":case"date":return pe(U(l,"day"),U(o,"day"),at);case"hours":case"hour":return pe(U(l,"hour"),U(o,"hour"),nn);case"minutes":case"minute":return pe(U(l,"minute"),U(o,"minute"),Ie);case"seconds":case"second":return pe(U(l,"second"),U(o,"second"),1e3)}}function ze(e){return on(e,U(e,"year"),"days")+1}function Je(e){if(e>=11&&e<=13)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`}return`${e}th`}const Ke={YY(e,t,a){const l=this.YYYY(e,t,a)%100;return l>=0?k(l):"-"+k(Math.abs(l))},YYYY(e,t,a){return a!=null?a:e.getFullYear()},M(e){return e.getMonth()+1},MM(e){return k(e.getMonth()+1)},MMM(e,t){return t.monthsShort[e.getMonth()]},MMMM(e,t){return t.months[e.getMonth()]},Q(e){return Math.ceil((e.getMonth()+1)/3)},Qo(e){return Je(this.Q(e))},D(e){return e.getDate()},Do(e){return Je(e.getDate())},DD(e){return k(e.getDate())},DDD(e){return ze(e)},DDDD(e){return k(ze(e),3)},d(e){return e.getDay()},dd(e,t){return this.dddd(e,t).slice(0,2)},ddd(e,t){return t.daysShort[e.getDay()]},dddd(e,t){return t.days[e.getDay()]},E(e){return e.getDay()||7},w(e){return Ue(e)},ww(e){return k(Ue(e))},H(e){return e.getHours()},HH(e){return k(e.getHours())},h(e){const t=e.getHours();return t===0?12:t>12?t%12:t},hh(e){return k(this.h(e))},m(e){return e.getMinutes()},mm(e){return k(e.getMinutes())},s(e){return e.getSeconds()},ss(e){return k(e.getSeconds())},S(e){return Math.floor(e.getMilliseconds()/100)},SS(e){return k(Math.floor(e.getMilliseconds()/10))},SSS(e){return k(e.getMilliseconds(),3)},A(e){return this.H(e)<12?"AM":"PM"},a(e){return this.H(e)<12?"am":"pm"},aa(e){return this.H(e)<12?"a.m.":"p.m."},Z(e,t,a,l){const o=l==null?e.getTimezoneOffset():l;return Ze(o,":")},ZZ(e,t,a,l){const o=l==null?e.getTimezoneOffset():l;return Ze(o)},X(e){return Math.floor(e.getTime()/1e3)},x(e){return e.getTime()}};function un(e,t,a,l,o){if(e!==0&&!e||e===1/0||e===-1/0)return;const s=new Date(e);if(isNaN(s))return;t===void 0&&(t=nt);const u=lt(a,Ge.props);return t.replace(ln,(r,d)=>r in Ke?Ke[r](s,u,l,o):d===void 0?r:d.split("\\]").join("]"))}function dn(e,t){if(e.hour!==null){if(e.minute===null)return"minute";if(t===!0&&e.second===null)return"second"}return"hour"}function cn(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}var Xe=Dt({name:"QTime",props:{...jt,...It,...Ga,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:en,setup(e,{slots:t,emit:a}){const l=Vt(),{$q:o}=l.proxy,s=Ot(e,o),{tabindex:u,headerClass:r,getLocale:d,getCurrentDate:y}=an(e,o),c=At(e),b=qt(c);let q,A;const P=he(null),ne=D(()=>ct()),le=D(()=>d()),Ae=D(()=>mt()),se=fe(e.modelValue,ne.value,le.value,e.calendar,Ae.value),w=he(dn(se)),_=he(se),I=he(se.hour===null||se.hour<12),rt=D(()=>`q-time q-time--${e.landscape===!0?"landscape":"portrait"}`+(s.value===!0?" q-time--dark q-dark":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-time--readonly":"")+(e.bordered===!0?" q-time--bordered":"")+(e.square===!0?" q-time--square no-border-radius":"")+(e.flat===!0?" q-time--flat no-shadow":"")),ye=D(()=>{const n=_.value;return{hour:n.hour===null?"--":H.value===!0?k(n.hour):String(I.value===!0?n.hour===0?12:n.hour:n.hour>12?n.hour-12:n.hour),minute:n.minute===null?"--":k(n.minute),second:n.second===null?"--":k(n.second)}}),H=D(()=>e.format24h!==null?e.format24h:o.lang.date.format24h),it=D(()=>{const n=w.value==="hour",i=n===!0?12:60,h=_.value[w.value];let $=`rotate(${Math.round(h*(360/i))-180}deg) translateX(-50%)`;return n===!0&&H.value===!0&&_.value.hour>=12&&($+=" scale(.7)"),{transform:$}}),Ye=D(()=>_.value.hour!==null),ot=D(()=>Ye.value===!0&&_.value.minute!==null),W=D(()=>e.hourOptions!==void 0?n=>e.hourOptions.includes(n):e.options!==void 0?n=>e.options(n,null,null):null),re=D(()=>e.minuteOptions!==void 0?n=>e.minuteOptions.includes(n):e.options!==void 0?n=>e.options(_.value.hour,n,null):null),ie=D(()=>e.secondOptions!==void 0?n=>e.secondOptions.includes(n):e.options!==void 0?n=>e.options(_.value.hour,_.value.minute,n):null),B=D(()=>{if(W.value===null)return null;const n=ue(0,11,W.value),i=ue(12,11,W.value);return{am:n,pm:i,values:n.values.concat(i.values)}}),G=D(()=>re.value!==null?ue(0,59,re.value):null),ee=D(()=>ie.value!==null?ue(0,59,ie.value):null),oe=D(()=>{switch(w.value){case"hour":return B.value;case"minute":return G.value;case"second":return ee.value}}),ut=D(()=>{let n,i,h=0,g=1;const $=oe.value!==null?oe.value.values:void 0;w.value==="hour"?H.value===!0?(n=0,i=23):(n=0,i=11,I.value===!1&&(h=12)):(n=0,i=55,g=5);const N=[];for(let v=n,Y=n;v<=i;v+=g,Y++){const R=v+h,St=$!==void 0&&$.includes(R)===!1,Mt=w.value==="hour"&&v===0?H.value===!0?"00":"12":v;N.push({val:R,index:Y,disable:St,label:Mt})}return N}),dt=D(()=>[[Ut,_t,void 0,{stop:!0,prevent:!0,mouse:!0}]]);Le(()=>e.modelValue,n=>{const i=fe(n,ne.value,le.value,e.calendar,Ae.value);(i.dateHash!==_.value.dateHash||i.timeHash!==_.value.timeHash)&&(_.value=i,i.hour===null?w.value="hour":I.value=i.hour<12)}),Le([ne,le],()=>{Ht(()=>{Me()})});function Te(){const n={...y(),...cn()};Me(n),Object.assign(_.value,n),w.value="hour"}function ue(n,i,h){const g=Array.apply(null,{length:i+1}).map(($,N)=>{const v=N+n;return{index:v,val:h(v)===!0}}).filter($=>$.val===!0).map($=>$.index);return{min:g[0],max:g[g.length-1],values:g,threshold:i+1}}function Ve(n,i,h){const g=Math.abs(n-i);return Math.min(g,h-g)}function be(n,{min:i,max:h,values:g,threshold:$}){if(n===i)return i;if(n<i||n>h)return Ve(n,i,$)<=Ve(n,h,$)?i:h;const N=g.findIndex(R=>n<=R),v=g[N-1],Y=g[N];return n-v<=Y-n?v:Y}function ct(){return e.calendar!=="persian"&&e.mask!==null?e.mask:`HH:mm${e.withSeconds===!0?":ss":""}`}function mt(){if(typeof e.defaultDate!="string"){const n=y(!0);return n.dateHash=tn(n),n}return fe(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}function we(){return Nt(l)===!0||oe.value!==null&&(oe.value.values.length===0||w.value==="hour"&&H.value!==!0&&B.value[I.value===!0?"am":"pm"].values.length===0)}function Ce(){const n=P.value,{top:i,left:h,width:g}=n.getBoundingClientRect(),$=g/2;return{top:i+$,left:h+$,dist:$*.7}}function _t(n){if(we()!==!0){if(n.isFirst===!0){q=Ce(),A=de(n.evt,q);return}A=de(n.evt,q,A),n.isFinal===!0&&(q=!1,A=null,qe())}}function qe(){w.value==="hour"?w.value="minute":e.withSeconds&&w.value==="minute"&&(w.value="second")}function de(n,i,h){const g=Yt(n),$=Math.abs(g.top-i.top),N=Math.sqrt(Math.pow(Math.abs(g.top-i.top),2)+Math.pow(Math.abs(g.left-i.left),2));let v,Y=Math.asin($/N)*(180/Math.PI);if(g.top<i.top?Y=i.left<g.left?90-Y:270+Y:Y=i.left<g.left?Y+90:270-Y,w.value==="hour"){if(v=Y/30,B.value!==null){const R=H.value!==!0?I.value===!0:B.value.am.values.length!==0&&B.value.pm.values.length!==0?N>=i.dist:B.value.am.values.length!==0;v=be(v+(R===!0?0:12),B.value[R===!0?"am":"pm"])}else v=Math.round(v),H.value===!0?N<i.dist?v<12&&(v+=12):v===12&&(v=0):I.value===!0&&v===12?v=0:I.value===!1&&v!==12&&(v+=12);H.value===!0&&(I.value=v<12)}else v=Math.round(Y/6)%60,w.value==="minute"&&G.value!==null?v=be(v,G.value):w.value==="second"&&ee.value!==null&&(v=be(v,ee.value));return h!==v&&wt[w.value](v),v}const ke={hour(){w.value="hour"},minute(){w.value="minute"},second(){w.value="second"}};function ht(n){n.keyCode===13&&He()}function ft(n){n.keyCode===13&&Ne()}function pt(n){we()!==!0&&(o.platform.is.desktop!==!0&&de(n,Ce()),qe())}function vt(n){we()!==!0&&de(n,Ce())}function gt(n){if(n.keyCode===13)w.value="hour";else if([37,39].includes(n.keyCode)){const i=n.keyCode===37?-1:1;if(B.value!==null){const h=H.value===!0?B.value.values:B.value[I.value===!0?"am":"pm"].values;if(h.length===0)return;if(_.value.hour===null)ce(h[0]);else{const g=(h.length+h.indexOf(_.value.hour)+i)%h.length;ce(h[g])}}else{const h=H.value===!0?24:12,g=H.value!==!0&&I.value===!1?12:0,$=_.value.hour===null?-i:_.value.hour;ce(g+(24+$+i)%h)}}}function yt(n){if(n.keyCode===13)w.value="minute";else if([37,39].includes(n.keyCode)){const i=n.keyCode===37?-1:1;if(G.value!==null){const h=G.value.values;if(h.length===0)return;if(_.value.minute===null)me(h[0]);else{const g=(h.length+h.indexOf(_.value.minute)+i)%h.length;me(h[g])}}else{const h=_.value.minute===null?-i:_.value.minute;me((60+h+i)%60)}}}function bt(n){if(n.keyCode===13)w.value="second";else if([37,39].includes(n.keyCode)){const i=n.keyCode===37?-1:1;if(ee.value!==null){const h=ee.value.values;if(h.length===0)return;if(_.value.seconds===null)_e(h[0]);else{const g=(h.length+h.indexOf(_.value.second)+i)%h.length;_e(h[g])}}else{const h=_.value.second===null?-i:_.value.second;_e((60+h+i)%60)}}}function ce(n){_.value.hour!==n&&(_.value.hour=n,te())}function me(n){_.value.minute!==n&&(_.value.minute=n,te())}function _e(n){_.value.second!==n&&(_.value.second=n,te())}const wt={hour:ce,minute:me,second:_e};function He(){I.value===!1&&(I.value=!0,_.value.hour!==null&&(_.value.hour-=12,te()))}function Ne(){I.value===!0&&(I.value=!1,_.value.hour!==null&&(_.value.hour+=12,te()))}function Se(n){const i=e.modelValue;w.value!==n&&i!==void 0&&i!==null&&i!==""&&typeof i!="string"&&(w.value=n)}function te(){if(W.value!==null&&W.value(_.value.hour)!==!0){_.value=fe(),Se("hour");return}if(re.value!==null&&re.value(_.value.minute)!==!0){_.value.minute=null,_.value.second=null,Se("minute");return}if(e.withSeconds===!0&&ie.value!==null&&ie.value(_.value.second)!==!0){_.value.second=null,Se("second");return}_.value.hour===null||_.value.minute===null||e.withSeconds===!0&&_.value.second===null||Me()}function Me(n){const i=Object.assign({..._.value},n),h=e.calendar==="persian"?k(i.hour)+":"+k(i.minute)+(e.withSeconds===!0?":"+k(i.second):""):un(new Date(i.year,i.month===null?null:i.month-1,i.day,i.hour,i.minute,i.second,i.millisecond),ne.value,le.value,i.year,i.timezoneOffset);i.changed=h!==e.modelValue,a("update:modelValue",h,i)}function Ct(){const n=[M("div",{class:"q-time__link "+(w.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:u.value,onClick:ke.hour,onKeyup:gt},ye.value.hour),M("div",":"),M("div",Ye.value===!0?{class:"q-time__link "+(w.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:u.value,onKeyup:yt,onClick:ke.minute}:{class:"q-time__link"},ye.value.minute)];e.withSeconds===!0&&n.push(M("div",":"),M("div",ot.value===!0?{class:"q-time__link "+(w.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:u.value,onKeyup:bt,onClick:ke.second}:{class:"q-time__link"},ye.value.second));const i=[M("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},n)];return H.value===!1&&i.push(M("div",{class:"q-time__header-ampm column items-between no-wrap"},[M("div",{class:"q-time__link "+(I.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:u.value,onClick:He,onKeyup:ht},"AM"),M("div",{class:"q-time__link "+(I.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:u.value,onClick:Ne,onKeyup:ft},"PM")])),M("div",{class:"q-time__header flex flex-center no-wrap "+r.value},i)}function kt(){const n=_.value[w.value];return M("div",{class:"q-time__content col relative-position"},[M(Lt,{name:"q-transition--scale"},()=>M("div",{key:"clock"+w.value,class:"q-time__container-parent absolute-full"},[M("div",{ref:P,class:"q-time__container-child fit overflow-hidden"},[ve(M("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:pt,onMousedown:vt},[M("div",{class:"q-time__clock-circle fit"},[M("div",{class:"q-time__clock-pointer"+(_.value[w.value]===null?" hidden":e.color!==void 0?` text-${e.color}`:""),style:it.value}),ut.value.map(i=>M("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${i.index}`+(i.val===n?" q-time__clock-position--active "+r.value:i.disable===!0?" q-time__clock-position--disable":"")},[M("span",i.label)]))])]),dt.value)])])),e.nowBtn===!0?M(L,{class:"q-time__now-button absolute",icon:o.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:u.value,onClick:Te}):null])}return l.proxy.setNow=Te,()=>{const n=[kt()],i=Tt(t.default);return i!==void 0&&n.push(M("div",{class:"q-time__actions"},i)),e.name!==void 0&&e.disable!==!0&&b(n,"push"),M("div",{class:rt.value,tabindex:-1},[Ct(),M("div",{class:"q-time__main col overflow-auto"},n)])}}});function mn(e){if(e.length!==5)return!1;const t=e.split(":");if(t.length!==2||t[0].length!==2||t[1].length!==2||isNaN(t[0])||isNaN(t[1]))return!1;const a=parseInt(t[0]);if(a<0||a>23)return!1;const l=parseInt(t[0]);return!(l<0||l>59)}function Re(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e}class st{constructor(t,a){this.hour=t,this.minute=a}isBefore(t){return this.hour<t.hour?!0:this.hour>t.hour?!1:this.minute<t.minute?!0:!(this.minute>t.minute)}addHours(t){this.hour+=t,this.hour>=24&&(this.hour=23,this.minute=59)}toString(){return Re(this.hour,2)+":"+Re(this.minute,2)}}function _n(e){return new st(e.hour,e.minute)}function hn(e){const t=e.split(":");return new st(parseInt(t[0]),parseInt(t[1]))}var Z={isValidTimeStr:mn,get_time_obj:hn,copy_time_obj:_n};const fn=F({name:"BatchCallLeadsAddBlockDialog",data(){return{dialog_visible:!1,viewing_days:[],selected_day:void 0,selected_start_time:"09:00",selected_end_time:"10:00"}},computed:{day_list(){return this.viewing_days.filter(function(e){return e.selected}).map(function(e){return{label:e.text,value:e.id}})}},methods:{show_dialog(e,t){this.viewing_days=e,this.selected_start_time="09:00",this.selected_end_time="10:00",this.selected_day=t,this.dialog_visible=!0},update_start_time(){if(!Z.isValidTimeStr(this.selected_start_time)||!Z.isValidTimeStr(this.selected_end_time))return;const e=Z.get_time_obj(this.selected_start_time);if(Z.get_time_obj(this.selected_end_time).isBefore(e)){let a=Z.copy_time_obj(e);a.addHours(1),this.selected_end_time=a.toString()}},notifyvalidationerror(e){ae.create({color:"bg-grey-2",message:e,timeout:2e3,color:"negative"})},addbtnclick(){if(!Z.isValidTimeStr(this.selected_start_time)){this.notifyvalidationerror("Invalid Start Time");return}if(!Z.isValidTimeStr(this.selected_end_time)){this.notifyvalidationerror("Invalid End Time");return}const e=Z.get_time_obj(this.selected_start_time);if(Z.get_time_obj(this.selected_end_time).isBefore(e)){this.notifyvalidationerror("End time must be after start time");return}const a=this;this.viewing_days.filter(function(o){return o.id===a.selected_day})[0].reserved_slots.push({id:Oe.uuidv4(),start:this.selected_start_time,end:this.selected_end_time}),this.dialog_visible=!1}}}),pn=m("div",{class:"text-h6"},"Block out time",-1),vn=m("div",null," Add time that are not availaible for viewings. ",-1),gn={class:"row items-center justify-end"},yn={class:"row items-center justify-end"};function bn(e,t,a,l,o,s){return f(),K(xt,{modelValue:e.dialog_visible,"onUpdate:modelValue":t[5]||(t[5]=u=>e.dialog_visible=u)},{default:T(()=>[C(Bt,null,{default:T(()=>[C(Pe,{class:"row items-center q-pb-none"},{default:T(()=>[pn,C(Zt),ve(C(L,{icon:"close",flat:"",round:"",dense:""},null,512),[[$e]])]),_:1}),C(Pe,null,{default:T(()=>[vn,m("div",null,[J(" Start Time: "),C(ge,{filled:"",modelValue:e.selected_start_time,"onUpdate:modelValue":[t[1]||(t[1]=u=>e.selected_start_time=u),e.update_start_time],mask:"time",rules:["time"]},{append:T(()=>[C(Be,{name:"access_time",class:"cursor-pointer"},{default:T(()=>[C(xe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:T(()=>[C(Xe,{modelValue:e.selected_start_time,"onUpdate:modelValue":[t[0]||(t[0]=u=>e.selected_start_time=u),e.update_start_time]},{default:T(()=>[m("div",gn,[ve(C(L,{label:"Close",color:"primary",flat:""},null,512),[[$e]])])]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","onUpdate:modelValue"])]),m("div",null,[J(" End Time: "),C(ge,{filled:"",modelValue:e.selected_end_time,"onUpdate:modelValue":t[3]||(t[3]=u=>e.selected_end_time=u),mask:"time",rules:["time"]},{append:T(()=>[C(Be,{name:"access_time",class:"cursor-pointer"},{default:T(()=>[C(xe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:T(()=>[C(Xe,{modelValue:e.selected_end_time,"onUpdate:modelValue":t[2]||(t[2]=u=>e.selected_end_time=u)},{default:T(()=>[m("div",yn,[ve(C(L,{label:"Close",color:"primary",flat:""},null,512),[[$e]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),C(Pt,{align:"right",class:"text-primary"},{default:T(()=>[C(L,{label:"Cancel",onClick:t[4]||(t[4]=u=>this.dialog_visible=!1)}),C(L,{color:"primary",label:"Add",onClick:e.addbtnclick},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])}var wn=E(fn,[["render",bn]]);const je="2",We="1",Cn=F({name:"BatchCallLeads",components:{BatchCallLeadsAddBlockDialog:wn,CallAssist:Fa},setup(){return{backend_connection_store:Et()}},data(){return{callassistactive:!1,story_prompt:"",viewing_days:[],leads_fully_loaded:!1,patches_to_scan:[],project_ids_to_load:[],leads:[]}},computed:{user_profile(){return this.backend_connection_store.user_profile},heading(){const e=this;if(this.$route.query.patchid==="all")return"Call All Leads";if(typeof this.user_profile.patches=="undefined")return"Call Leads";const t=this.user_profile.patches.filter(function(a){return a.id===e.$route.query.patchid});return t.length!==1?"Call Leads":"Call Leads for "+t[0].name}},methods:{addreservedslot(e){this.$refs.BatchCallLeadsAddBlockDialog.show_dialog(this.viewing_days,e.id)},delreservedslot(e,t){e.reserved_slots=e.reserved_slots.filter(function(a){return a.id!==t})},click_readytogo(){this.callassistactive=!0;const e=this;setTimeout(function(){var t=e.story_prompt;t===""&&(t="No story prompt provided"),e.$refs.CallAssist.prepare(Ea,e.leads.map(function(a){return{id:a.id,name:a.project_name,raw:a}}),{story_prompt:t})},10)},recursive_get_list_of_projects_to_load(){const e=this;if(this.patches_to_scan.length===0){e.recursive_load_projects();return}const t=this.patches_to_scan.pop(),a={ok:function(l){typeof l.data.workflow_lookup[je]!="undefined"&&typeof l.data.workflow_lookup[je][We]!="undefined"&&l.data.workflow_lookup[je][We].map(function(o){e.project_ids_to_load.push(o)}),e.recursive_get_list_of_projects_to_load()},error:function(l){ae.create({color:"negative",message:"Unable to load leads (patches) - please try again later",timeout:2e3})}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/patches/"+t,method:"GET",data:void 0,callback:a})},recursive_load_projects(){const e=this;if(this.project_ids_to_load.length===0){e.leads_fully_loaded=!0;return}const t=this.project_ids_to_load.pop(),a={ok:function(l){e.leads.push(l.data),e.recursive_load_projects()},error:function(l){ae.create({color:"negative",message:"Unable to load leads (project) - please try again later",timeout:2e3})}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+t,method:"GET",data:void 0,callback:a})}},mounted(){const e=this;this.viewing_days=[];const t=new Date;t.setHours(0,0,0,0);for(let l=1;l<8;l++){var a=new Date(t);a.setDate(a.getDate()+l),this.viewing_days.push({id:l,text:Oe.format_date_as_string_without_year(a),js_day_obj:a,selected:!0,reserved_slots:[]})}setTimeout(function(){e.$route.query.patchid==="all"?e.patches_data=e.user_profile.patches.map(function(l){e.patches_to_scan.push(l.id)}):e.patches_to_scan.push(e.$route.query.patchid),e.recursive_get_list_of_projects_to_load()},300)}}),kn={key:0,class:"fit column wrap justify-start items-start content-center"},Sn=m("div",{class:"text-h4"},"Aim:",-1),Mn=m("div",null,"The aim of the phone call is to secure a views on potential properties.",-1),$n=m("div",null,"We also want to introduce the idea of a company let and make sure the landlord does not get a surprise when we make the viewing.",-1),Dn=m("div",{class:"text-h4"},"Story Prompt:",-1),jn=m("div",null,"Enter a prompt that you will use to explain who you are and why you are looking for rent to rent properties to landlords.",-1),In={class:"batchcallleads-storydiv"},On=m("div",{class:"text-h4"},"Free days and time slots",-1),An=m("div",null,"What days are you free for viewings? (This is used for suggestion prompts)",-1),Yn=m("div",null,"Random suggestions will be made between 9am and 6pm on the days selected. You can block off times as required.",-1),Tn={class:"row"},Vn={key:0,class:"batchcallleads-blockouttimebutton"},qn={key:0},Hn={key:0,class:"text-h6"},Nn={key:1},Ln={class:"text-h4"},Pn={key:1,class:"fit column wrap justify-start items-start content-center batchcallleads-storydiv"};function Bn(e,t,a,l,o,s){const u=z("BatchCallLeadsAddBlockDialog"),r=z("CallAssist");return f(),K(Ft,{class:"flex flex-center"},{default:T(()=>[e.callassistactive?O("",!0):(f(),p("div",kn,[m("h2",null,j(e.heading),1),Sn,Mn,$n,Dn,jn,m("div",In,[C(ge,{filled:"",clearable:"",modelValue:e.story_prompt,"onUpdate:modelValue":t[0]||(t[0]=d=>e.story_prompt=d),label:"Story Prompt",autogrow:""},null,8,["modelValue"])]),On,An,Yn,(f(!0),p(x,null,Q(e.viewing_days,d=>(f(),p("div",{key:d.id,class:"batchcallleads-daycheckbox"},[m("div",Tn,[C(Qt,{dense:"",modelValue:d.selected,"onUpdate:modelValue":y=>d.selected=y,label:d.text},null,8,["modelValue","onUpdate:modelValue","label"]),d.selected?(f(),p("div",Vn,[C(L,{color:"primary",size:"xs",label:"Exclude Time",onClick:y=>e.addreservedslot(d)},null,8,["onClick"])])):O("",!0)]),d.selected?(f(),p("div",qn,[(f(!0),p(x,null,Q(d.reserved_slots,y=>(f(),p("div",{key:y.id},[J(" Not "+j(y.start)+"-"+j(y.end)+" ",1),C(L,{round:"",color:"primary",size:"xs",icon:"delete",onClick:c=>e.delreservedslot(d,y.id)},null,8,["onClick"])]))),128))])):O("",!0)]))),128)),J(" \xA0 "),e.leads_fully_loaded?O("",!0):(f(),p("div",Hn," Please wait - loading lead information... ")),e.leads_fully_loaded?(f(),p("div",Nn,[m("div",Ln,"You have "+j(e.leads.length)+" leads to call",1),J(" \xA0 "),C(L,{label:"Ready to start making calls...",onClick:e.click_readytogo,color:"secondary"},null,8,["onClick"])])):O("",!0),C(u,{ref:"BatchCallLeadsAddBlockDialog"},null,512)])),e.callassistactive?(f(),p("div",Pn,[C(r,{ref:"CallAssist"},null,512)])):O("",!0)]),_:1})}var Wn=E(Cn,[["render",Bn]]);export{Wn as default};
