import{g as ae,R as ne,ay as se,S as ue,T as le,j as M,k as r,av as ie,U as re,V as ce,W as fe,X as de,Y as ve,m as A,b2 as ge,aA as he,b3 as me,b4 as D,D as ye,b5 as be,q as R,x as Te,a0 as Pe,n as ke,u as Se,b6 as xe,b7 as Ce,b8 as qe,a1 as Oe}from"./index.434648d0.js";import{u as Be,v as H,a as Ee,b as Fe,c as we,p as K,r as W,s as Me,e as Ae}from"./position-engine.d9f52570.js";var He=ae({name:"QMenu",inheritAttrs:!1,props:{...Be,...ne,...se,...ue,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:H},self:{type:String,validator:H},offset:{type:Array,validator:Ee},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...le,"click","escapeKey"],setup(e,{slots:o,emit:a,attrs:s}){let n=null,v,c,g;const P=Se(),{proxy:h}=P,{$q:u}=h,l=M(null),i=M(!1),j=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=ie(e,u),{registerTick:z,removeTick:I}=re(),{registerTimeout:k}=ce(),{transitionProps:U,transitionStyle:_}=fe(e),{localScrollTarget:S,changeScrollEvent:L,unconfigureScrollTarget:V}=Fe(e,F),{anchorEl:f,canShow:X}=we({showing:i}),{hide:x}=de({showing:i,canShow:X,handleShow:N,handleHide:Z,hideOnRouteChange:j,processOnMount:!0}),{showPortal:C,hidePortal:q,renderPortal:Y}=ve(P,l,ee,"menu"),m={anchorEl:f,innerRef:l,onClickOutside(t){if(e.persistent!==!0&&i.value===!0)return x(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Oe(t),!0}},O=r(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),$=r(()=>e.cover===!0?O.value:K(e.self||"top start",u.lang.rtl)),G=r(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),J=r(()=>e.autoClose===!0?{onClick:p}:{}),B=r(()=>i.value===!0&&e.persistent!==!0);A(B,t=>{t===!0?(xe(b),Ae(m)):(D(b),W(m))});function y(){Ce(()=>{let t=l.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function N(t){if(n=e.noRefocus===!1?document.activeElement:null,ge(w),C(),F(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const T=he(t);if(T.left!==void 0){const{top:te,left:oe}=f.value.getBoundingClientRect();v={left:T.left-oe,top:T.top-te}}}c===void 0&&(c=A(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),z(()=>{d(),e.noFocus!==!0&&y()}),k(()=>{u.platform.is.ios===!0&&(g=e.autoClose,l.value.click()),d(),C(!0),a("show",t)},e.transitionDuration)}function Z(t){I(),q(),E(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t&&t.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),k(()=>{q(!0),a("hide",t)},e.transitionDuration)}function E(t){v=void 0,c!==void 0&&(c(),c=void 0),(t===!0||i.value===!0)&&(me(w),V(),W(m),D(b)),t!==!0&&(n=null)}function F(){(f.value!==null||e.scrollTarget!==void 0)&&(S.value=ye(f.value,e.scrollTarget),L(S.value,d))}function p(t){g!==!0?(be(h,t),a("click",t)):g=!1}function w(t){B.value===!0&&e.noFocus!==!0&&qe(l.value,t.target)!==!0&&y()}function b(t){a("escapeKey"),x(t)}function d(){Me({targetEl:l.value,offset:e.offset,anchorEl:f.value,anchorOrigin:O.value,selfOrigin:$.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function ee(){return R(Pe,U.value,()=>i.value===!0?R("div",{role:"menu",...s,ref:l,tabindex:-1,class:["q-menu q-position-engine scroll"+G.value,s.class],style:[s.style,_.value],...J.value},Te(o.default)):null)}return ke(E),Object.assign(h,{focus:y,updatePosition:d}),Y}});function Ke(e,o,a){return a<=o?o:Math.min(a,Math.max(o,e))}function We(e,o,a){if(a<=o)return o;const s=a-o+1;let n=o+(e-o)%s;return n<o&&(n=s+n),n===0?0:n}function je(e,o=2,a="0"){if(e==null)return e;const s=""+e;return s.length>=o?s:new Array(o-s.length+1).join(a)+s}export{He as Q,Ke as b,We as n,je as p};
