import{_ as f,d as p,N as m,r,o as u,c as h,w as v,e as o,a as t,Q as n}from"./index.69d4ee77.js";import{Q as w}from"./QPage.f08360d3.js";import{u as k}from"./use-quasar.b38635d6.js";import{L as y}from"./LeadInformation.21fcd9fc.js";import{A as L,a as $,P as g}from"./ProjectSerializer.0c5731e8.js";import{W as j}from"./Workflow_main.1e4e793e.js";import{c as z}from"./common_constants.94b43302.js";import"./QSelect.b7dff7c0.js";import"./QItemSection.eb86688d.js";import"./QItemLabel.acda2029.js";import"./QMenu.ed365563.js";import"./position-engine.d37da7ee.js";import"./backend_connection.a3f6274f.js";import"./axios.6e1fcf85.js";import"./ClosePopup.e4ecd437.js";import"./utils.99aafcb0.js";import"./uuid.6153c38a.js";import"./data_caches.cd56a1ba.js";const I=p({name:"RentProjectEnterLead",components:{LeadInformation:y,ActivityLog:L,Workflow:$,ProjectSerializer:g},setup(){return{q:k()}},data(){return{}},computed:{default_workflow_id(){return j.default_rent_workflow_id},project_type(){return z.project_type_constants.project_type_rent},no_save_reason(){return this.$refs.LeadInformation.serializer_card_data.patch_id==="notset"?(console.log("Patch error",this.$refs.LeadInformation.serializer_card_data.patch_id),"You must select a patch"):this.$refs.LeadInformation.serializer_card_data.landlord_name.length<3?"Enter landlord name":this.$refs.LeadInformation.serializer_card_data.contact_phone.length<3?"Enter a contact phonenumber":""},serialized_data(){return{leadinformation:this.$refs.LeadInformation.serializer_card_data}}},methods:{click_cancel(){this.$router.push("/tools")},click_save(e){if(this.no_save_reason!==""){m.create({color:"negative",message:this.no_save_reason,timeout:2e3});return}this.q.loading.show({message:"Saving lead..."}),this.$refs.ProjectSerializer.save_project({dict_of_card_info:this.serialized_data,activity_log:this.$refs.ActivityLog.serializer_card_data,workflow:this.$refs.Workflow.serializer_card_data,patch_id:this.serialized_data.leadinformation.patch_id,location:void 0,passthroughdata:{add_another:e,patch_id:this.serialized_data.leadinformation.patch_id}})},save_project_complete({success:e,response:a,passthroughdata:i}){this.q.loading.hide(),e&&(i.add_another?(this.reset_data(),this.$refs.LeadInformation.select_patch_by_id(i.patch_id)):this.$router.push("/tools"))},reset_data(){this.$refs.LeadInformation.reset_data()}},mounted(){typeof this.$route.query.defaultpatch!="undefined"&&this.$refs.LeadInformation.select_patch_by_id(this.$route.query.defaultpatch)}}),S={class:"fit column wrap justify-start items-start content-center"},P=o("h2",null,"Enter new Rental Lead",-1),b=o("p",null,"Enter a new rental lead to follow up later.",-1),C={class:"enterlead-btnbar"},q={class:"enterlead-hiddenparts"};function W(e,a,i,A,E,Q){const s=r("LeadInformation"),l=r("ProjectSerializer"),d=r("ActivityLog"),c=r("Workflow");return u(),h(w,{class:""},{default:v(()=>[o("div",S,[P,b,t(s,{ref:"LeadInformation"},null,512),o("div",C,[t(n,{label:"Cancel",onClick:e.click_cancel},null,8,["onClick"]),t(n,{color:"primary",label:"Save",onClick:a[0]||(a[0]=_=>e.click_save(!1))}),t(n,{color:"primary",label:"Save and add another",onClick:a[1]||(a[1]=_=>e.click_save(!0))})]),t(l,{ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete,project_type:e.project_type,success_message:"Lead Saved"},null,8,["onSaveprojectcomplete","project_type"]),o("div",q,[t(d,{ref:"ActivityLog"},null,512),t(c,{ref:"Workflow",default_workflow_id:e.default_workflow_id},null,8,["default_workflow_id"])])])]),_:1})}var ee=f(I,[["render",W]]);export{ee as default};
