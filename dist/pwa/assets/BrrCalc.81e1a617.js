import{Q as J}from"./QPage.d407dbbb.js";import{d as w,_ as y,o as f,c as b,w as c,a as i,e as r,ad as M,ae as D,ag as g,af as I,f as d,ar as X,L as P,t as l,aq as $,r as m,N as k,M as Z,O as x,a7 as ee,as as E}from"./index.cb6f97dd.js";import{Q as te,I as U,F as ae,G as se,P as re,R as ne,S as ie,O as oe,a as le}from"./FeatureTable.454c4104.js";import{u as z}from"./utils.7b533ce3.js";import{Q as ce,a as v,b as T,c as ue,d as _e}from"./QTable.4d07da09.js";import{Q as B}from"./QTr.477d44b9.js";import{Q as de}from"./QExpansionItem.f7fc9258.js";import{u as he}from"./utils.5f33790e.js";import{u as j}from"./backend_connection.a66c37cc.js";import"./position-engine.357b4f89.js";import"./QItemLabel.8e11b690.js";import"./axios.6e1fcf85.js";const fe=w({name:"BrrCalcVision",emits:["projectchanged"],data(){return{devplan:"",emit_project_change_notification:!0}},computed:{serializer_card_data(){return{devplan:this.devplan}}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged")}},methods:{helpdevplan(){this.$q.dialog({title:"What is the development plan?",message:"Enter the development plan. E.g. Split into two flats"}).onOk(()=>{})},serializer_load_data(e){this.emit_project_change_notification=!1,this.devplan=e.devplan;const s=this;setTimeout(function(){s.emit_project_change_notification=!0},50)}}}),me=r("div",{class:"text-h6"},"Vision",-1),pe={class:"row"};function ge(e,s,n,t,a,o){return f(),b(I,{inline:"",class:"q-ma-sm card-style"},{default:c(()=>[i(g,null,{default:c(()=>[me,r("div",pe,[i(M,{modelValue:e.devplan,"onUpdate:modelValue":s[0]||(s[0]=u=>e.devplan=u),label:"What is the development plan?",class:"col-grow"},null,8,["modelValue"]),i(D,{round:"",color:"primary",icon:"info",onClick:e.helpdevplan},null,8,["onClick"])])]),_:1})]),_:1})}var be=y(fe,[["render",ge]]);const ve=w({name:"BrrCalcFinance",emits:["projectchanged"],props:["gdv_total"],data(){return{refinance:{userefinance:!0,ltv:{min:75,max:75}},emit_project_change_notification:!0}},methods:{format_currency(e){return z.format_currency(e)},serializer_load_data(e){this.emit_project_change_notification=!1,this.refinance.userefinance=e.refinance_userefinance,this.refinance.ltv=e.refinance_userefinance_ltv;const s=this;setTimeout(function(){s.emit_project_change_notification=!0},50)}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged")}},computed:{serializer_card_data(){return{refinance_userefinance:this.refinance.userefinance,refinance_userefinance_ltv:this.refinance.ltv}},get_refinance(){return this.refinance},refinanceamount(){return{worst:this.gdv_total.min*(this.refinance.ltv.min/100),best:this.gdv_total.max*(this.refinance.ltv.max/100)}},refinance_out_items(){let e=[];return this.refinance.userefinance&&e.push({name:"Mortgage Refinance",worst:this.refinanceamount.worst,best:this.refinanceamount.best}),e}}}),we=r("div",{class:"text-h6"},"Refinance",-1),ye={key:0};function $e(e,s,n,t,a,o){return f(),b(I,{inline:"",class:"q-ma-sm card-style"},{default:c(()=>[i(g,null,{default:c(()=>[we,d(" This section is for adding refinance details. After the refurbishment is complete the refinance stage can be used to pull money out of the deal. "),i(X,{modelValue:e.refinance.userefinance,"onUpdate:modelValue":s[0]||(s[0]=u=>e.refinance.userefinance=u),label:"Refinance after refurbishment"},null,8,["modelValue"]),e.refinance.userefinance?(f(),P("div",ye,[d(" Refinance LTV "+l(e.refinance.ltv.min)+"% - "+l(e.refinance.ltv.max)+"% ",1),i(te,{modelValue:e.refinance.ltv,"onUpdate:modelValue":s[1]||(s[1]=u=>e.refinance.ltv=u),min:0,max:100,step:5,"thumb-size":"40px","drag-range":"",label:"","left-label-value":e.refinance.ltv.min+"%","right-label-value":e.refinance.ltv.max+"%"},null,8,["modelValue","left-label-value","right-label-value"]),r("div",null,"Refinance amount: "+l(e.format_currency(e.refinanceamount.worst))+" - "+l(e.format_currency(e.refinanceamount.best)),1)])):$("",!0)]),_:1})]),_:1})}var ke=y(ve,[["render",$e]]);function N(e){return e.filter(function(s){return s.type==="ledger"})}function V(e,s){e.push({type:"blank",key:e.length}),e.push({type:"title",key:e.length,name:s})}function C(e,s,n,t){let a=N(e);var o=void 0,u=void 0;a.length>0&&(o=a[a.length-1].worst,u=a[a.length-1].best);function _(h,S){var R=0;typeof h!="undefined"&&(R=h.bal);var q="",A="";return S>0?q=S:A=S,{in:q,out:A,bal:R+S}}e.push({type:"ledger",key:e.length,name:s,worst:_(o,n),best:_(u,t)})}const Se=w({name:"BrrCalcDealSummary",props:["is_valid_input","purchaserange","finance_in_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","finance_out_items","refinance_out_items","finance_during_items"],components:{InvalidMessage:U},data(){return{table:{columns:[{name:"item",label:"Item",field:"item"},{name:"win",label:"In",field:"win"},{name:"wout",label:"Out",field:"wout"},{name:"wbal",label:"Balance",field:"wbal"},{name:"bin",label:"In",field:"bin"},{name:"bout",label:"Out",field:"bout"},{name:"bbal",label:"Balance",field:"bbal"}]}}},methods:{format_currency(e){return typeof e=="string"&&e===""?"":z.format_currency(e)}},computed:{final_bal(){let e=N(this.items);return e.length===0?{worst:0,best:0}:{worst:e[e.length-1].worst.bal,best:e[e.length-1].best.bal}},money_in(){var e=this.finance_in_items.reduce((n,t)=>n+t.worst,0),s=this.finance_in_items.reduce((n,t)=>n+t.best,0);return{worst:e,best:s}},items(){var e=[];typeof this.finance_in_items!="undefined"&&this.finance_in_items.map(function(n){C(e,n.name,n.worst,n.best)}),typeof this.purchase_items!="undefined"&&this.purchase_items.map(function(n){C(e,n.name,n.worst,n.best)}),typeof this.stampduty_items!="undefined"&&this.stampduty_items.map(function(n){C(e,n.name,n.worst,n.best)}),typeof this.othercosts_items!="undefined"&&this.othercosts_items.map(function(n){C(e,n.name,n.worst,n.best)}),V(e,"During Project"),typeof this.finance_during_items!="undefined"&&this.finance_during_items.map(function(n){C(e,n.name,n.worst,n.best)}),typeof this.refurb_cost_items!="undefined"&&this.refurb_cost_items.map(function(n){C(e,n.name,n.worst,n.best)});let s=!1;return typeof this.refinance_out_items!="undefined"&&(this.refinance_out_items.length>0&&(s=!0,V(e,"Exit finance")),this.refinance_out_items.map(function(n){C(e,n.name,n.worst,n.best)})),typeof this.finance_out_items!="undefined"&&(this.finance_out_items.length>0&&(s||V(e,"Exit finance")),this.finance_out_items.map(function(n){C(e,n.name,n.worst,n.best)})),e}}}),Ce=r("div",{class:"text-h6"},"Cashflow Summary",-1),Pe=r("div",{class:"text-subtitle2"},"This section gives a break down of money in and out of the deal. It is broken down twice, for best and worst case figures.",-1),Te=r("div",null," \xA0 ",-1);function Re(e,s,n,t,a,o){const u=m("InvalidMessage");return f(),b(I,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:c(()=>[i(g,null,{default:c(()=>[Ce,Pe]),_:1}),i(g,null,{default:c(()=>[i(u,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),r("div",null,[i(ce,{columns:e.table.columns,rows:e.items,"hide-bottom":"","rows-per-page-options":[100]},{header:c(_=>[i(B,null,{default:c(()=>[i(v),i(v,{colspan:"3",class:"worstcasetablecell"},{default:c(()=>[d("Worst Case")]),_:1}),i(v,{colspan:"3"},{default:c(()=>[d("Best Case")]),_:1})]),_:1}),i(B,{props:_},{default:c(()=>[i(v,null,{default:c(()=>[d(" Item ")]),_:1}),i(v,{class:"worstcasetablecell"},{default:c(()=>[d(" In ")]),_:1}),i(v,{class:"worstcasetablecell"},{default:c(()=>[d(" Out ")]),_:1}),i(v,{class:"worstcasetablecell"},{default:c(()=>[d(" Balance ")]),_:1}),i(v,null,{default:c(()=>[d(" In ")]),_:1}),i(v,null,{default:c(()=>[d(" Out ")]),_:1}),i(v,null,{default:c(()=>[d(" Balance ")]),_:1})]),_:2},1032,["props"])]),body:c(_=>[_.row.type==="ledger"?(f(),b(B,{key:0},{default:c(()=>[i(T,{class:"tablerowcell"},{default:c(()=>[d(l(_.row.name),1)]),_:2},1024),i(T,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.worst.in)),1)]),_:2},1024),i(T,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.worst.out)),1)]),_:2},1024),i(T,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.worst.bal)),1)]),_:2},1024),i(T,{class:"valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.best.in)),1)]),_:2},1024),i(T,{class:"valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.best.out)),1)]),_:2},1024),i(T,{class:"valuetablecell tablerowcell"},{default:c(()=>[d(l(e.format_currency(_.row.best.bal)),1)]),_:2},1024)]),_:2},1024)):$("",!0),_.row.type==="blank"?(f(),b(B,{key:1},{default:c(()=>[i(v,{colspan:"7"},{default:c(()=>[d("\xA0")]),_:1})]),_:1})):$("",!0),_.row.type==="title"?(f(),b(B,{key:2},{default:c(()=>[i(v,{colspan:"7"},{default:c(()=>[d(l(_.row.name),1)]),_:2},1024)]),_:2},1024)):$("",!0)]),_:1},8,["columns","rows"])]),Te]),_:1})]),_:1})}var ze=y(Se,[["render",Re]]);const Ie=w({name:"BrrCalcDealRatingAlternativeSummary",props:["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"],methods:{format_currency(e){return z.format_currency(e)}},computed:{mortgage_rate_display(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max+"%",worst:this.finance_refinance.ltv.min+"%"}:{best:"N/A",worst:"N/A"}},mortgage(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max/100*this.purchaserange.min,worst:this.finance_refinance.ltv.min/100*this.purchaserange.max}:{best:0,worst:0}},deposit(){return{best:this.purchaserange.min-this.mortgage.best,worst:this.purchaserange.max-this.mortgage.worst}},total_money_in(){return{best:this.mortgage.best+this.deposit.best+this.stampduty_total.min+this.othercosts_total.min+this.refurb_cost_total.min,worst:this.mortgage.worst+this.deposit.worst+this.stampduty_total.max+this.othercosts_total.max+this.refurb_cost_total.max}},new_mortgage_amount(){return{best:this.gdv_total.max*(this.finance_refinance.ltv.max/100),worst:this.gdv_total.min*(this.finance_refinance.ltv.min/100)}},monay_pulled_out(){return{best:this.gdv_total.max-this.new_mortgage_amount.best,worst:this.gdv_total.min-this.new_mortgage_amount.worst}},profit(){return{best:this.gdv_total.max-this.total_money_in.best,worst:this.gdv_total.min-this.total_money_in.worst}},money_left_in(){return{best:this.monay_pulled_out.best-this.profit.best,worst:this.monay_pulled_out.worst-this.profit.worst}}}}),Be={class:"alternativetable"},Me=r("thead",null,[r("tr",null,[r("th",{class:"text-left alternativetablecell"}),r("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),r("th",{class:"text-center alternativetablecell"},"Best case")])],-1),qe=r("td",{class:"text-left alternativetablecell"},"Price offered",-1),Ae={class:"text-right alternativetablecell yellowtablecell totaltablecell"},De={class:"text-right alternativetablecell yellowtablecell totaltablecell"},je=r("td",{class:"text-left alternativetablecell"},"Mortgage %",-1),Ee={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ve={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Fe=r("td",{class:"text-left alternativetablecell"},"Mortgage",-1),Oe={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Ue={class:"text-right alternativetablecell totaltablecell"},Ne=r("td",{class:"text-left alternativetablecell"},"Deposit",-1),Ge={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Qe={class:"text-right alternativetablecell totaltablecell"},Le=r("td",{class:"text-left alternativetablecell"},"Stamp Duty",-1),We={class:"text-right alternativetablecell yellowtablecell totaltablecell"},He={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ye=r("td",{class:"text-left alternativetablecell"},"Other costs (Legals, etc)",-1),Ke={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Je={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Xe=r("td",{class:"text-left alternativetablecell"},"Total Refurb Costs",-1),Ze={class:"text-right alternativetablecell bluetablecell totaltablecell"},xe={class:"text-right alternativetablecell bluetablecell totaltablecell"},et=r("td",{class:"text-left alternativetablecell"},"Total Money In",-1),tt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},at={class:"text-right alternativetablecell totaltablecell"},st=r("tr",null,[r("td",null,"\xA0"),r("td",{class:"worstcasetablecell"}),r("td")],-1),rt=r("td",{class:"text-left alternativetablecell"},"End Value",-1),nt={class:"text-right alternativetablecell yellowtablecell totaltablecell"},it={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ot=r("td",{class:"text-left alternativetablecell"},"New Mortgage Amount",-1),lt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ct={class:"text-right alternativetablecell totaltablecell"},ut=r("td",{class:"text-left alternativetablecell"},"Money Pulled Out",-1),_t={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},dt={class:"text-right alternativetablecell totaltablecell"},ht=r("tr",null,[r("td",null,"\xA0"),r("td",{class:"worstcasetablecell"}),r("td")],-1),ft=r("td",{class:"text-left alternativetablecell"},"Profit",-1),mt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},pt={class:"text-right alternativetablecell totaltablecell"},gt=r("td",{class:"text-left alternativetablecell"},"Money Left In",-1),bt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},vt={class:"text-right alternativetablecell totaltablecell"};function wt(e,s,n,t,a,o){return f(),b(de,{"expand-separator":"",label:"Alternative summary format"},{default:c(()=>[r("div",null,[d(" This is another way of viewing the project numbers that is commonly used. I have included this for comparison. "),r("table",Be,[Me,r("tbody",null,[r("tr",null,[qe,r("td",Ae,l(e.format_currency(e.purchaserange.max)),1),r("td",De,l(e.format_currency(e.purchaserange.min)),1)]),r("tr",null,[je,r("td",Ee,l(e.mortgage_rate_display.worst),1),r("td",Ve,l(e.mortgage_rate_display.best),1)]),r("tr",null,[Fe,r("td",Oe,l(e.format_currency(e.mortgage.worst)),1),r("td",Ue,l(e.format_currency(e.mortgage.best)),1)]),r("tr",null,[Ne,r("td",Ge,l(e.format_currency(e.deposit.worst)),1),r("td",Qe,l(e.format_currency(e.deposit.best)),1)]),r("tr",null,[Le,r("td",We,l(e.format_currency(e.stampduty_total.max)),1),r("td",He,l(e.format_currency(e.stampduty_total.min)),1)]),r("tr",null,[Ye,r("td",Ke,l(e.format_currency(e.othercosts_total.max)),1),r("td",Je,l(e.format_currency(e.othercosts_total.min)),1)]),r("tr",null,[Xe,r("td",Ze,l(e.format_currency(e.refurb_cost_total.max)),1),r("td",xe,l(e.format_currency(e.refurb_cost_total.min)),1)]),r("tr",null,[et,r("th",tt,l(e.format_currency(e.total_money_in.worst)),1),r("th",at,l(e.format_currency(e.total_money_in.best)),1)]),st,r("tr",null,[rt,r("td",nt,l(e.format_currency(e.gdv_total.min)),1),r("td",it,l(e.format_currency(e.gdv_total.max)),1)]),r("tr",null,[ot,r("td",lt,l(e.format_currency(e.new_mortgage_amount.worst)),1),r("td",ct,l(e.format_currency(e.new_mortgage_amount.best)),1)]),r("tr",null,[ut,r("td",_t,l(e.format_currency(e.monay_pulled_out.worst)),1),r("td",dt,l(e.format_currency(e.monay_pulled_out.best)),1)]),ht,r("tr",null,[ft,r("td",mt,l(e.format_currency(e.profit.worst)),1),r("td",pt,l(e.format_currency(e.profit.best)),1)]),r("tr",null,[gt,r("td",bt,l(e.format_currency(e.money_left_in.worst)),1),r("td",vt,l(e.format_currency(e.money_left_in.best)),1)])])]),d(" Note: The profit amounts may not match because this method does not take into account finance costs. ")])]),_:1})}var yt=y(Ie,[["render",wt]]);const $t=w({name:"BrrCalcDealRatingCompareDoneup",props:["purchaserange","refurb_cost_total","gdv_total"],methods:{format_currency(e){return z.format_currency(e)},format_percent(e){return z.format_percent(e)}},computed:{total_spent(){return{worst:this.purchaserange.max+this.refurb_cost_total.max,best:this.purchaserange.min+this.refurb_cost_total.min}},gain(){return{worst:this.gdv_total.min-this.total_spent.worst,best:this.gdv_total.max-this.total_spent.best}},profit_percentage(){return{worst:this.gain.worst/this.total_spent.worst,best:this.gain.best/this.total_spent.best}}}}),kt=r("div",{class:"text-h5"},"Compare this project to buying a done up property",-1),St=r("div",null,"This section compares this project with buying a property that is already done up. To account for the time and risk involved with a refurbishment we expect the end value of the property to be more than if we had just bought one.",-1),Ct={class:"alternativetable"},Pt=r("thead",null,[r("tr",null,[r("th",{class:"text-left alternativetablecell"}),r("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),r("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Tt=r("td",{class:"text-left alternativetablecell"},"Purchase + Refurb",-1),Rt={class:"text-right alternativetablecell worstcasetablecell"},zt={class:"text-right alternativetablecell"},It=r("td",{class:"text-left alternativetablecell"},"End Value",-1),Bt={class:"text-right alternativetablecell worstcasetablecell"},Mt={class:"text-right alternativetablecell"},qt=r("td",{class:"text-left alternativetablecell totaltablecell"},"Gain",-1),At={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Dt={class:"text-right alternativetablecell totaltablecell"},jt=r("td",{class:"text-left alternativetablecell totaltablecell"},"Percentage",-1),Et={class:"text-right alternativetablecell worstcasetablecell finaltotaltablecell"},Vt={class:"text-right alternativetablecell finaltotaltablecell"};function Ft(e,s,n,t,a,o){return f(),P("div",null,[kt,St,r("table",Ct,[Pt,r("tbody",null,[r("tr",null,[Tt,r("td",Rt,l(e.format_currency(e.total_spent.worst)),1),r("td",zt,l(e.format_currency(e.total_spent.best)),1)]),r("tr",null,[It,r("td",Bt,l(e.format_currency(e.gdv_total.min)),1),r("td",Mt,l(e.format_currency(e.gdv_total.max)),1)]),r("tr",null,[qt,r("td",At,l(e.format_currency(e.gain.worst)),1),r("td",Dt,l(e.format_currency(e.gain.best)),1)]),r("tr",null,[jt,r("td",Et,l(e.format_percent(e.profit_percentage.worst)),1),r("td",Vt,l(e.format_percent(e.profit_percentage.best)),1)])])])])}var Ot=y($t,[["render",Ft]]);const Ut=w({name:"BrrCalcDealRating",props:["is_valid_input","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","purchaserange","stampduty_total","othercosts_total","refurb_cost_total"],components:{dealRatingAlternativeSummary:yt,FeatureTable:ae,InvalidMessage:U,dealRatingCompareDoneup:Ot},data(){return{}},methods:{format_currency(e){return z.format_currency(e)}},computed:{features(){let e=[];var s=Math.min(this.cash_out_of_deal_minus_cash_in.best,this.cash_out_of_deal_minus_cash_in.worst);s>0?e.push({type:"positive",text:"All money out deal! - All initial investment returned plus at least "+this.format_currency(s)}):e.push({type:"negative",text:"Not all money out deal! - Might leave "+this.format_currency(-1*s)+" in."});var n=Math.min(this.profit.best,this.profit.worst);n<0?e.push({type:"negative",text:"Deal makes a loss! - End value might be "+this.format_currency(-1*n)+" less than investment."}):n<this.gdv_total.min*.25?e.push({type:"negative",text:"Low amount of profit! - Low profit "+this.format_currency(n)+" less than 25% of gdv."}):e.push({type:"positive",text:"Profit making deal! - Profit of "+this.format_currency(n)+"!"});var t=Math.min(this.annualroi.worst,this.annualroi.best);return t<3?e.push({type:"negative",text:"Very low ROI! "+t.toFixed(1)+"%"}):t>10&&e.push({type:"positive",text:"Good ROI! "+t.toFixed(1)+"%"}),e},cash_out_of_deal_minus_cash_in(){return{best:this.deal_summary_final_bal.best-this.finance_totalmoneyneeded.best,worst:this.deal_summary_final_bal.worst-this.finance_totalmoneyneeded.worst}},percent_left_in(){return this.finance_refinance.userefinance?{best:100-this.finance_refinance.ltv.max,worst:100-this.finance_refinance.ltv.min}:{best:100,worst:100}},amount_equity_left_in(){return{best:this.gdv_total.max*(this.percent_left_in.best/100),worst:this.gdv_total.min*(this.percent_left_in.worst/100)}},total_end_value(){return{best:this.amount_equity_left_in.best+this.deal_summary_final_bal.best,worst:this.amount_equity_left_in.worst+this.deal_summary_final_bal.worst}},profit(){return{best:this.total_end_value.best-this.finance_totalmoneyneeded.best,worst:this.total_end_value.worst-this.finance_totalmoneyneeded.worst}},roi(){return{best:100*this.profit.best/this.finance_totalmoneyneeded.best,worst:100*this.profit.worst/this.finance_totalmoneyneeded.worst}},annualroi(){return{worst:this.roi.worst*(12/this.refurbmonths.worst),best:this.roi.best*(12/this.refurbmonths.best)}}}}),Nt=r("div",{class:"text-h6"},"Project Rating",-1),Gt=r("div",{class:"text-subtitle2"},"How good is this project?",-1),Qt=r("div",{class:"text-h5"},"Profit/Loss",-1),Lt=r("div",null,"Compare what we have put into the deal vs what we get out of it. These calculations won't account for time invested or the risk taken on in the project",-1),Wt={class:"text-h5"},Ht=r("div",{class:"text-h6"},"Deal Features",-1);function Yt(e,s,n,t,a,o){const u=m("InvalidMessage"),_=m("dealRatingCompareDoneup"),h=m("dealRatingAlternativeSummary"),S=m("FeatureTable");return f(),b(I,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:c(()=>[i(g,null,{default:c(()=>[Nt,Gt]),_:1}),i(g,null,{default:c(()=>[i(u,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),Qt,Lt,r("div",Wt,"Total cash in: "+l(e.format_currency(e.finance_totalmoneyneeded.worst))+" - "+l(e.format_currency(e.finance_totalmoneyneeded.best))+" Worst - Best",1),i(_,{purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","refurb_cost_total","gdv_total"])]),_:1}),i(g,null,{default:c(()=>[i(h,{purchaserange:e.purchaserange,finance_refinance:e.finance_refinance,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"])]),_:1}),i(g,null,{default:c(()=>[Ht,i(S,{features:e.features,"onUpdate:features":s[0]||(s[0]=R=>e.features=R)},null,8,["features"])]),_:1})]),_:1})}var Kt=y(Ut,[["render",Yt]]);function Jt(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}const Xt=w({name:"WebLinksComponent",props:["weblinks"],emits:["updateweblinks"],data(){return{}},computed:{weblinkdisplay(){return this.weblinks.map(function(e){const s=new URL(e.label);let n="web",t=s.hostname;return s.hostname==="www.google.com"&&(s.pathname.startsWith("/maps/@")&&(s.pathname.includes("/data=")?(t="Google Streetview",n="streetview"):(t="Google Map",n="map")),s.pathname.startsWith("/maps/place")&&(t="Google Place",n="place")),{id:e.id,label:e.label,text:t,icon:n}})}},methods:{clickweblink(e){window.open(e.label,"_blank").focus()},delweblink(e){const s=this.weblinks.filter(function(n){return e!==n.id});this.$emit("updateweblinks",s)},addweblink(){const e=this;this.$q.dialog({title:"Add weblink",message:"Add weblink to information about this property (rightmove, zoopla, etc.)",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(s=>{if(s=s.trim(),!s.startsWith("http")){k.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"});return}const n=e.weblinks;n.push({id:Jt(),label:s}),this.$emit("updateweblinks",n)})}}});function Zt(e,s,n,t,a,o){return f(),P("div",null,[(f(!0),P(Z,null,x(e.weblinkdisplay,u=>(f(),P("div",{key:u},[i(ue,{clickable:"",onClick:_=>e.clickweblink(u),removable:"",onRemove:_=>e.delweblink(u.id),color:"primary","text-color":"white",icon:u.icon},{default:c(()=>[d(l(u.text),1)]),_:2},1032,["onClick","onRemove","icon"])]))),128)),i(D,{round:"",color:"primary",icon:"add",onClick:e.addweblink},null,8,["onClick"])])}var xt=y(Xt,[["render",Zt]]);const ea=w({name:"DealBasicInfo",emits:["saveproject"],components:{Weblinks:xt},setup(){return{backend_connection_store:j()}},data(){return{patch:{id:"notset",name:"Not Set"},address:"",postcode:"",weblinks:[],new_patch_value:"",selling_agent:"",notes:"",changed:!1,autosave_seconds_left:60,ever_saved:!1,save_in_progress:!1,save_monitor_function_running:!1}},watch:{serializer_card_data(e){this.set_changed_true()}},computed:{serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,weblinks:this.weblinks,selling_agent:this.selling_agent,notes:this.notes}},no_save_message(){return this.patch.id==="notset"?"Select patch":this.address.length<3?"Enter address":this.save_in_progress?"Saving...":""},can_save(){return this.save_in_progress?!1:!!this.changed},save_btn_text(){return this.no_save_message!==""?"Not able to save ("+this.no_save_message+")":this.changed?this.autosave_seconds_left===-1?"Save Now":"Save now (auto save in "+this.autosave_seconds_left+")":this.ever_saved?"Saved":"Not able to save (No changes)"},security_role_cansave(){return this.backend_connection_store.security_role_cansave},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{updateweblinks(e){this.weblinks=e,this.set_changed_true()},serializer_load_data(e){this.address=e.address,this.postcode=e.postcode,this.weblinks=e.weblinks,this.selling_agent=e.selling_agent,this.notes=e.notes,this.patch=this.patch_list.filter(function(n){return n.id===e.patch_id})[0],this.ever_saved=!0;const s=this;setTimeout(function(){s.changed=!1,s.autosave_seconds_left=-1},50)},set_changed_true(){this.changed=!0,this.no_save_message===""&&(this.autosave_seconds_left=10,this.start_save_monitor_function())},start_save_monitor_function(){this.save_monitor_function_running||this.save_monitor_function()},save_monitor_function(){if(this.save_monitor_function_running=!0,this.save_in_progress)return;if(this.autosave_seconds_left===-1){this.save_monitor_function_running=!1;return}const e=this;if(e.autosave_seconds_left=e.autosave_seconds_left-1,e.autosave_seconds_left<1){this.save_monitor_function_running=!1,this.save_now();return}setTimeout(e.save_monitor_function,1e3)},click_save_btn(){this.autosave_seconds_left=-1,this.save_now()},save_now(){!this.can_save||(this.save_in_progress=!0,this.$emit("saveproject"))},save_project_complete_notification({success:e,response:s}){console.log("save complet notif"),this.save_in_progress=!1,e?(this.changed=!1,this.ever_saved=!0):this.autosave_seconds_left=-1},select_patch_by_id(e){console.log("TODO select_patch_by_id",e),this.patch=this.patch_list.filter(function(s){return s.id===e})[0]},select_patch(e){if(e.id==="create"){const s=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(n=>{s.new_patch_value=n;const t={ok:s.createpatchcallback,error:function(o){console.log("s",o),k.create({color:"negative",message:"Create patch failed "+o.response.data.message,timeout:2e3})}},a={patch_name:n};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:a,callback:t})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(s){return s.name===e.new_patch_value})[0],this.new_patch_value=""},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const s={ok:function(n){k.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(n){k.create({color:"negative",message:"Copy failed",timeout:2e3})}};he.copyTextToClipboard2(e,s)}}}),ta=r("div",{class:"text-h6"},"Basic Information",-1),aa=r("div",{class:"text-subtitle2"},"Basic information about this project",-1),sa={key:0},ra={key:1},na=r("div",{class:"text-h6"},"Weblinks",-1);function ia(e,s,n,t,a,o){const u=m("Weblinks");return e.security_role_cansave?(f(),b(I,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(g,null,{default:c(()=>[ta,aa]),_:1}),i(g,null,{default:c(()=>[e.ever_saved?$("",!0):(f(),P("div",sa,[i(_e,{modelValue:e.patch,"onUpdate:modelValue":[s[0]||(s[0]=_=>e.patch=_),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(f(),P("div",ra," Patch: "+l(e.patch.name),1)):$("",!0),r("div",null,[i(M,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":s[1]||(s[1]=_=>e.address=_),label:"Address"},null,8,["modelValue"])]),r("div",null,[i(M,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":s[3]||(s[3]=_=>e.postcode=_),label:"Postcode"},{append:c(()=>[e.isEmpty(e.postcode)?$("",!0):(f(),b(ee,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:s[2]||(s[2]=_=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])])]),_:1}),i(g,null,{default:c(()=>[r("div",null,[na,i(u,{weblinks:e.weblinks,onUpdateweblinks:e.updateweblinks},null,8,["weblinks","onUpdateweblinks"])]),r("div",null,[i(M,{filled:"",clearable:"",modelValue:e.selling_agent,"onUpdate:modelValue":s[4]||(s[4]=_=>e.selling_agent=_),label:"Selling Agent"},null,8,["modelValue"])]),r("div",null,[i(M,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":s[5]||(s[5]=_=>e.notes=_),label:"Notes"},null,8,["modelValue"])])]),_:1}),i(g,null,{default:c(()=>[r("div",null,[i(D,{color:"primary",icon:"save",label:e.save_btn_text,onClick:e.click_save_btn},null,8,["label","onClick"])])]),_:1})]),_:1})):$("",!0)}var oa=y(ea,[["render",ia]]);function la(e,s,n){const t=[];t.push({range:"Main!A1",values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.push({range:"Main!A2:B2",values:[["Patch:",s.patch.name]]}),t.push({range:"Main!A3:B3",values:[["Address:",s.serialized_data.dealbasicinfo.address]]}),t.push({range:"Main!E3:E3",values:[[s.serialized_data.dealbasicinfo.postcode]]}),t.push({range:"Main!A4:A4",values:[["Links:"]]});let a=3;return s.serialized_data.dealbasicinfo.weblinks.forEach(function(o){a=a+1,t.push({range:"Main!B"+a.toString()+":B"+a.toString(),values:[['=HYPERLINK("'+o.label+'", "'+o.label+'")']]})}),a=a+1,a=a+1,t.push({range:"Main!A"+a.toString()+":B"+a.toString(),values:[["Selling Agent:",s.serialized_data.dealbasicinfo.selling_agent]]}),a=a+1,t.push({range:"Main!A"+a.toString()+":B"+a.toString(),values:[["Notes:",s.serialized_data.dealbasicinfo.notes]]}),a=a+1,t.push({range:"Main!A"+a.toString()+":B"+a.toString(),values:[["Vision:",s.serialized_data.vision.devplan]]}),a=a+1,a=a+1,t.push({range:"Main!A"+a.toString()+":A"+a.toString(),values:[["Caculations provided here are for reference only and should be manually checked."]]}),t}function ca(e,s,n){const t=[];return t.push({repeatCell:{range:{sheetId:n.Main,startRowIndex:0,endRowIndex:s.serialized_data.dealbasicinfo.weblinks.length+6+1,startColumnIndex:0,endColumnIndex:1},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}),t}var F={get_sheet_main_values:la,get_sheet_main:ca};function ua(e){function s(n,t,a,o,u){return{repeatCell:{range:{sheetId:e,startRowIndex:n,endRowIndex:t,startColumnIndex:a,endColumnIndex:o},cell:{userEnteredFormat:{numberFormat:{type:"NUMBER",pattern:u}}},fields:"userEnteredFormat.numberFormat"}}}return{makeboldandvaligntop:function(n,t,a,o){return{repeatCell:{range:{sheetId:e,startRowIndex:n,endRowIndex:t,startColumnIndex:a,endColumnIndex:o},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeitalicandvaligntop:function(n,t,a,o){return{repeatCell:{range:{sheetId:e,startRowIndex:n,endRowIndex:t,startColumnIndex:a,endColumnIndex:o},cell:{userEnteredFormat:{textFormat:{italic:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},formatnumbermisc:function(n,t,a,o,u){return s(n,t,a,o,u)},formatcurrency:function(n,t,a,o){return s(n,t,a,o,"[$\xA3-809]#,##0.00")},formatpercentage:function(n,t,a,o){return s(n,t,a,o,"0.00%")},adjustcolumnwidth:function(n,t){return{updateDimensionProperties:{range:{sheetId:e,dimension:"COLUMNS",startIndex:n,endIndex:n+1},properties:{pixelSize:t},fields:"pixelSize"}}}}}var _a={get_sheet_utils:ua};const p="Purchase Phase";function da(e,s,n){return{name:"Buying Cash",pre_stage:function(t){},start_details:function(t){return[["Purchase Price",s.serialized_data.purchaseprice.purchaserangevalue.max,s.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(t){return[]}}}function ha(e,s,n){return{name:"Buying with a Mortgage",pre_stage:function(t,a){const o=[],u=t.cur_row;t.cur_row=t.cur_row+1,t.value_requests.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["","Worst","Best"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,1,3)),t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Purchase Price",s.serialized_data.purchaseprice.purchaserangevalue.max,s.serialized_data.purchaseprice.purchaserangevalue.min]]}),t.requests.push(a.formatcurrency(u,t.cur_row,1,3)),t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Mortage Rate",s.serialized_data.finance.mortgage.rate.max/100,s.serialized_data.finance.mortgage.rate.min/100]]}),t.requests.push(a.formatpercentage(t.cur_row-1,t.cur_row,1,3)),t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Mortgage LTV",s.serialized_data.finance.mortgage.ltv.max/100,s.serialized_data.finance.mortgage.ltv.min/100]]}),t.requests.push(a.formatpercentage(t.cur_row-1,t.cur_row,1,3)),t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Total Mortgage","=B"+(u+2).toString()+"*B"+(t.cur_row-1).toString(),"=C"+(u+2).toString()+"*C"+(t.cur_row-1).toString()]]}),t.requests.push(a.formatcurrency(t.cur_row-1,t.cur_row,1,3)),t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Monthly Payments","=(B"+(t.cur_row-1).toString()+"*B"+(u+3).toString()+")/12","=(C"+(t.cur_row-1).toString()+"*C"+(u+3).toString()+")/12"]]}),t.requests.push(a.formatcurrency(t.cur_row-1,t.cur_row,1,3)),t.misc_data.monthly_payments_row=t.cur_row,t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Deposit","=B"+(u+2).toString()+"-B"+(t.cur_row-2).toString(),"=C"+(u+2).toString()+"-C"+(t.cur_row-2).toString()]]}),t.requests.push(a.formatcurrency(t.cur_row-1,t.cur_row,1,3)),t.misc_data.deposit_row=t.cur_row,t.cur_row=t.cur_row+1,o.push({range:p+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Refurb Duration Months",s.serialized_data.refurbcost.refurbtimerange.max,s.serialized_data.refurbcost.refurbtimerange.min]]}),t.requests.push(a.formatnumbermisc(t.cur_row-1,t.cur_row,1,3,"0")),t.misc_data.refurb_duration_row=t.cur_row,t.requests.push(a.makeboldandvaligntop(u,t.cur_row,0,1)),t.cur_row=t.cur_row+1,t.value_requests.push(o)},start_details:function(t){return[["Deposit","=B"+t.misc_data.deposit_row.toString(),"=C"+t.misc_data.deposit_row.toString()],["Mortgage Arangement",s.serialized_data.finance.mortgage.arrangementfee,s.serialized_data.finance.mortgage.arrangementfee]]},end_details:function(t){return[["Mortgage Payments","=B"+t.misc_data.monthly_payments_row.toString()+"*B"+t.misc_data.refurb_duration_row.toString(),"=C"+t.misc_data.monthly_payments_row.toString()+"*C"+t.misc_data.refurb_duration_row.toString()],["(During refurbishment)","",""]]}}}function fa(e,s,n){return{name:"Buying with a Bridge",pre_stage:function(t){},start_details:function(t){return[["Purchase Price",s.serialized_data.purchaseprice.purchaserangevalue.max,s.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(t){return[["Bridge Costs",s.finance_bridgecost.worst,s.finance_bridgecost.best]]}}}function ma(e,s,n){return s.serialized_data.finance.mortgage.usemortgage?ha(e,s):s.serialized_data.finance.bridge.usebridge?fa(e,s):da(e,s)}function pa(e,s,n){const t=_a.get_sheet_utils(n[p]);let a={cur_row:0,requests:[],value_requests:[],misc_data:{}};a.requests.push(t.adjustcolumnwidth(0,170)),a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":B"+a.cur_row.toString(),values:[["Patch:",s.patch.name]]}),a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":B"+a.cur_row.toString(),values:[["Address:",s.serialized_data.dealbasicinfo.address]]}),a.value_requests.push({range:p+"!E"+a.cur_row.toString()+":E"+a.cur_row.toString(),values:[[s.serialized_data.dealbasicinfo.postcode]]}),a.requests.push(t.makeboldandvaligntop(0,a.cur_row,0,1)),a.cur_row=a.cur_row+1;const o=ma(e,s);a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":A"+a.cur_row.toString(),values:[[o.name]]}),a.requests.push(t.makeboldandvaligntop(a.cur_row-1,a.cur_row,0,1)),o.pre_stage(a,t),a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["","Worst","Best"]]}),a.requests.push(t.makeboldandvaligntop(a.cur_row-1,a.cur_row,1,3));const u=a.cur_row;let _=o.start_details(a);return _.push(["Refurbishment",s.refurb_cost_total.max,s.refurb_cost_total.min]),_.push(["Stamp Duty",s.stampduty_total.max,s.stampduty_total.min]),s.othercosts_items_detail.forEach(function(h){_.push([h.name,-1*h.worst,-1*h.best])}),s.caculated_loan_details.forEach(function(h){_.push([h.name+" interest",h.interest,h.interest])}),_=_.concat(o.end_details(a)),_.forEach(function(h){a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[[h[0],h[1],h[2]]]}),h[0]==="(During refurbishment)"?a.requests.push(t.makeitalicandvaligntop(a.cur_row-1,a.cur_row,0,1)):a.requests.push(t.makeboldandvaligntop(a.cur_row-1,a.cur_row,0,1))}),a.cur_row=a.cur_row+1,a.cur_row=a.cur_row+1,a.value_requests.push({range:p+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Total Money needed","=SUM(B"+(u+1).toString()+":B"+(a.cur_row-1).toString()+")","=SUM(C"+(u+1).toString()+":C"+(a.cur_row-1).toString()+")"]]}),a.requests.push(t.makeboldandvaligntop(a.cur_row-1,a.cur_row,0,3)),a.requests.push(t.formatcurrency(u,a.cur_row,1,3)),{value_requests:a.value_requests,requests:a.requests}}var O={sheet_name:p,get_sheet_values:pa};const ga=w({name:"SaveToGoogleSheetCompoennt",props:["serialized_data","patch","refurb_cost_total","stampduty_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost"],setup(){return{backend_connection_store:j()}},data(){return{}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave}},methods:{click_export(){E.show();const e=google.accounts.oauth2.initTokenClient({client_id:this.$rjmgclientid,scope:this.$rjmgscopes,callback:this.execute_export});gapi.client.getToken()===null?e.requestAccessToken({prompt:"consent"}):e.requestAccessToken({prompt:""})},execute_export(){try{gapi.client.sheets.spreadsheets.create({properties:{title:"evernetproperties.com-"+this.patch.name+"-"+this.serialized_data.dealbasicinfo.address}}).then(e=>{this.spreadsheets_batchupdate(e.result)})}catch(e){this.sheet_api_error_handler(e);return}},spreadsheets_batchupdate(e){let s={Main:e.sheets[0].properties.sheetId},n=[];n.push({updateSheetProperties:{properties:{sheetId:e.sheets[0].properties.sheetId,title:"Main"},fields:"title"}});const t=[O.sheet_name];t.forEach(function(o){n.push({addSheet:{properties:{title:o}}})}),n=n.concat(F.get_sheet_main(e,this,s));const a={requests:n};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:a}).then(o=>{const u=o.result;console.log("spreadsheet Batch Update result",o.result.replies),o.result.replies.forEach(function(_){typeof _.addSheet!="undefined"&&t.forEach(function(h){_.addSheet.properties.title===h&&(s[h]=_.addSheet.properties.sheetId)})}),this.spreadsheets_batchupdate_after_all_sheets_added(e,s)})}catch(o){this.sheet_api_error_handler(o);return}},spreadsheets_batchupdate_after_all_sheets_added(e,s){let n=[],t=[];t=t.concat(F.get_sheet_main_values(e,this,s));let a=O.get_sheet_values(e,this,s);if(n=n.concat(a.requests),t=t.concat(a.value_requests),n.length===0){console.log("No requests required"),this.spreadsheets_values_batchupdate(e,s,t);return}const o={requests:n};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:o}).then(u=>{const _=u.result;console.log("spreadsheet Batch Update after all sheets added result",u.result.replies),this.spreadsheets_values_batchupdate(e,s,t)})}catch(u){this.sheet_api_error_handler(u);return}},spreadsheets_values_batchupdate(e,s,n){const t={data:n,valueInputOption:"USER_ENTERED"};try{gapi.client.sheets.spreadsheets.values.batchUpdate({spreadsheetId:e.spreadsheetId,resource:t}).then(a=>{const o=a.result;console.log(`${o.totalUpdatedCells} cells updated.`),this.sheet_final_complete(e)})}catch(a){this.sheet_api_error_handler(a);return}},open_sheet(e){window.open(e.spreadsheetUrl,"_blank").focus()},sheet_api_error_handler(e){E.hide(),console.log("Error-"+e.message),k.create({color:"negative",message:"Export to google sheets failed "+e.message,timeout:2e3})},sheet_final_complete(e){this.open_sheet(e),E.hide()}}}),ba=r("div",{class:"text-h6"},"Export to Spreadsheet",-1),va=r("div",{class:"text-subtitle2"},"Export figures into a google docs spreadsheet.",-1),wa=r("div",{class:"textdiv"}," This feature will generate a spreadsheet containing all the current values for this project and output it to a document in your google drive. ",-1);function ya(e,s,n,t,a,o){return e.security_role_cansave?(f(),b(I,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(g,null,{default:c(()=>[ba,va]),_:1}),i(g,null,{default:c(()=>[r("div",null,[i(D,{color:"primary",icon:"save",label:"Export to google sheets",onClick:e.click_export},null,8,["onClick"])]),wa]),_:1})]),_:1})):$("",!0)}var $a=y(ga,[["render",ya]]);const ka=w({name:"ProjectSerializer",emits:["saveprojectcomplete"],setup(){return{backend_connection_store:j()}},data(){return{loaded_project_id:void 0,proj_summary_data:{metadata:void 0,timestamp_first_entered:void 0}}},methods:{serializer_load_data(e){this.loaded_project_id=e.id,this.proj_summary_data.timestamp_first_entered=e.timestamp_first_entered,this.proj_summary_data.metadata=e.metadata},save_project({dict_of_card_info:e}){const s={};for(const o in Object.keys(e)){const u=Object.keys(e)[o];s[u]=JSON.parse(JSON.stringify(e[u]))}const n={user_id:this.backend_connection_store.user_profile.id,patch_id:e.dealbasicinfo.patch_id,timestamp_first_entered:this.proj_summary_data.timestamp_first_entered,initial_phase:{total_money_in:0,start_value:0,end_value:0,flip_roi:0},reoccurring_phase:[],location:{},workflow:{},activity_log:[],sub_section_details:s,tags:[],risks:[]};typeof this.loaded_project_id!="undefined"?(n.id=this.loaded_project_id,n.metadata=this.proj_summary_data.metadata):n.timestamp_first_entered=new Date().toISOString();const t=this,a={ok:t.save_api_call_success,error:t.save_api_call_fail};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects",method:"POST",data:n,callback:a})},save_api_call_success(e){this.$emit("saveprojectcomplete",{success:!0,response:e}),this.serializer_load_data(e.data),k.create({color:"positive",message:"Project Saved",timeout:2e3})},save_api_call_fail(e){this.$emit("saveprojectcomplete",{success:!1,response:e}),k.create({color:"negative",message:"Save failed - "+e.response.data.message,timeout:2e3})}},mounted(){}});function Sa(e,s,n,t,a,o){return f(),P("div")}var Ca=y(ka,[["render",Sa]]);const Pa=w({name:"CalcBrrToFlip",components:{GdvCard:se,PurchasePrice:re,RefurbCost:ne,StampDuty:ie,OtherCosts:oe,DealSummary:ze,Finance:le,Vision:be,DealRating:Kt,Refinance:ke,DealBasicInfo:oa,ProjectSerializer:Ca,SaveToGoogleSheet:$a},setup(){return{backend_connection_store:j()}},data(){return{isMounted:!1,purchaserange:{min:18e4,max:19e4}}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave},is_valid_input(){return this.isMounted?!(!this.$refs.PurchasePrice.isValid||!this.$refs.GdvCard.isValid):!0},deal_summary_final_bal(){return this.isMounted?this.$refs.DealSummary.final_bal:{best:0,worst:0}},finance_refinance(){return this.isMounted?this.$refs.Refinance.get_refinance:{userefinance:!1,ltv:{min:75,max:75}}},caculated_loan_details(){return this.isMounted?this.$refs.Finance.caculated_loan_details:[]},finance_bridgecost(){return this.isMounted?this.$refs.Finance.bridgecost:{best:0,worst:0}},finance_totalmoneyneeded(){return this.isMounted?this.$refs.Finance.totalmoneyneeded:{best:0,worst:0}},finance_in_items(){return this.isMounted?this.$refs.Finance.finance_in_items:[]},finance_during_items(){return this.isMounted?this.$refs.Finance.finance_during_items:[]},finance_out_items(){return this.isMounted?this.$refs.Finance.finance_out_items:[]},refinance_out_items(){return this.isMounted?this.$refs.Refinance.refinance_out_items:[]},purchase_items(){return this.isMounted?this.$refs.PurchasePrice.purchase_items:[]},stampduty_items(){return this.isMounted?this.$refs.StampDuty.stampduty_items:[]},othercosts_items(){return this.isMounted?this.$refs.OtherCosts.othercosts_items:[]},othercosts_items_detail(){return this.isMounted?this.$refs.OtherCosts.othercosts_items_detail:[]},refurb_cost_items(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_items:[]},refurb_cost_total(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_total:[]},refurbmonths(){return this.isMounted?this.$refs.RefurbCost.refurbmonths:[]},stampduty_total(){return this.isMounted?this.$refs.StampDuty.stampduty:[]},othercosts_total(){return this.isMounted?this.$refs.OtherCosts.total:[]},gdv_total(){return this.isMounted?this.$refs.GdvCard.total:[]},serialized_data(){return this.isMounted?{dealbasicinfo:this.$refs.DealBasicInfo.serializer_card_data,vision:this.$refs.Vision.serializer_card_data,gdvcard:this.$refs.GdvCard.serializer_card_data,purchaseprice:this.$refs.PurchasePrice.serializer_card_data,refurbcost:this.$refs.RefurbCost.serializer_card_data,stampduty:this.$refs.StampDuty.serializer_card_data,othercosts:this.$refs.OtherCosts.serializer_card_data,finance:this.$refs.Finance.serializer_card_data,refinance:this.$refs.Refinance.serializer_card_data}:{}},patch(){return this.isMounted?this.$refs.DealBasicInfo.patch:{id:"notset",name:"Not Set"}}},methods:{projectchanged(){this.$refs.DealBasicInfo.set_changed_true()},save_project(){this.$refs.ProjectSerializer.save_project({dict_of_card_info:this.serialized_data})},load_project_into_cards(e){this.$refs.ProjectSerializer.serializer_load_data(e),this.$refs.DealBasicInfo.serializer_load_data(e.sub_section_details.dealbasicinfo),typeof e.sub_section_details.vision!="undefined"&&this.$refs.Vision.serializer_load_data(e.sub_section_details.vision),typeof e.sub_section_details.gdvcard!="undefined"&&this.$refs.GdvCard.serializer_load_data(e.sub_section_details.gdvcard),typeof e.sub_section_details.purchaseprice!="undefined"&&this.$refs.PurchasePrice.serializer_load_data(e.sub_section_details.purchaseprice),typeof e.sub_section_details.refurbcost!="undefined"&&this.$refs.RefurbCost.serializer_load_data(e.sub_section_details.refurbcost),typeof e.sub_section_details.stampduty!="undefined"&&this.$refs.StampDuty.serializer_load_data(e.sub_section_details.stampduty),typeof e.sub_section_details.othercosts!="undefined"&&this.$refs.OtherCosts.serializer_load_data(e.sub_section_details.othercosts),typeof e.sub_section_details.finance!="undefined"&&this.$refs.Finance.serializer_load_data(e.sub_section_details.finance),typeof e.sub_section_details.refinance!="undefined"&&this.$refs.Refinance.serializer_load_data(e.sub_section_details.refinance)},save_project_complete({success:e,response:s}){this.$refs.DealBasicInfo.save_project_complete_notification({success:e,response:s})},load_project_api_fail(e){console.log("Failed to load project via API - ",e),k.create({color:"bg-grey-2",message:"Error loading project "+e,timeout:2e3,color:"negative"}),this.load_complete()},load_project_api_success(e){this.load_project_into_cards(e.data),k.create({color:"bg-grey-2",message:"Project Loaded",timeout:2e3,color:"positive"}),this.load_complete()},load_complete(){const e=this;setTimeout(function(){e.isMounted=!0},5)},call_load_api(){const e=this,s={ok:e.load_project_api_success,error:e.load_project_api_fail};e.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+e.$route.query.projectid,method:"GET",data:void 0,callback:s})}},mounted(){const e=this;if(typeof e.$route.query.projectid=="undefined"){if(e.load_complete(),typeof e.$route.query.patchid!="undefined"){if(!e.security_role_cansave)return;this.$refs.DealBasicInfo.select_patch_by_id(e.$route.query.patchid)}return}if(e.security_role_cansave){e.call_load_api();return}setTimeout(function(){e.call_load_api()},1e3)}}),Ta={class:"main-page fit col wrap justify-center items-center content-center"},Ra=r("h1",null,"Buy Refurbish Rent Refinance Calculator",-1),za=r("div",null,"This calculator can be used for calculating deal information for a Buy, Refurbish, Rent, Refinance project (BRRR). You can use this page to perform these calculations.",-1),Ia={class:"row"};function Ba(e,s,n,t,a,o){const u=m("DealBasicInfo"),_=m("Vision"),h=m("GdvCard"),S=m("PurchasePrice"),R=m("RefurbCost"),q=m("StampDuty"),A=m("OtherCosts"),G=m("Finance"),Q=m("Refinance"),L=m("DealSummary"),W=m("DealRating"),H=m("ProjectSerializer"),Y=m("SaveToGoogleSheet");return f(),b(J,{class:"flex flex-center"},{default:c(()=>[r("div",Ta,[Ra,za,r("div",Ia,[i(u,{ref:"DealBasicInfo",onSaveproject:e.save_project},null,8,["onSaveproject"]),i(_,{ref:"Vision",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(h,{ref:"GdvCard",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(S,{ref:"PurchasePrice",purchaserange:e.purchaserange,"onUpdate:purchaserange":s[0]||(s[0]=K=>e.purchaserange=K),onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(R,{ref:"RefurbCost",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(q,{ref:"StampDuty",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(A,{ref:"OtherCosts",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(G,{ref:"Finance",purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurbmonths:e.refurbmonths,gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["purchaserange","refurb_cost_total","stampduty_total","othercosts_total","refurbmonths","gdv_total","onProjectchanged"]),i(Q,{ref:"Refinance",gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["gdv_total","onProjectchanged"]),i(L,{ref:"DealSummary",purchaserange:e.purchaserange,finance_in_items:e.finance_in_items,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,refinance_out_items:e.refinance_out_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items","finance_out_items","finance_during_items","refinance_out_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),i(W,{ref:"DealRating",purchaserange:e.purchaserange,finance_totalmoneyneeded:e.finance_totalmoneyneeded,deal_summary_final_bal:e.deal_summary_final_bal,finance_refinance:e.finance_refinance,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","stampduty_total","othercosts_total","refurb_cost_total","is_valid_input"]),e.security_role_cansave?(f(),b(H,{key:0,ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete},null,8,["onSaveprojectcomplete"])):$("",!0),i(Y,{ref:"SaveToGoogleSheet",serialized_data:e.serialized_data,patch:e.patch,stampduty_total:e.stampduty_total,refurb_cost_total:e.refurb_cost_total,othercosts_items_detail:e.othercosts_items_detail,caculated_loan_details:e.caculated_loan_details,finance_bridgecost:e.finance_bridgecost},null,8,["serialized_data","patch","stampduty_total","refurb_cost_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost"])])])]),_:1})}var Qa=y(Pa,[["render",Ba]]);export{Qa as default};
