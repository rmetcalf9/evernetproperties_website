import{Q as h}from"./QSelect.1baf746e.js";import{d as k,N as d,_ as g,r as w,o as s,c as f,w as r,a as o,K as _,L as c,f as b,Q as V,t as y,e as n,af as i,a9 as C,ae as T,aa as L}from"./index.aadad3da.js";import{u as S,a as N}from"./backend_connection.c277c5b1.js";import{W as j}from"./ProjectSerializer.c7bdafd4.js";const U=k({name:"LeadInformationCard",emits:["projectchanged","navigate_away"],props:["ever_saved"],components:{Weblinks:j},setup(){return{backend_connection_store:S()}},data(){return{emit_project_change_notification:!0,patch:{id:"notset",name:"Not Set"},address:"",postcode:"",landlord_name:"",contact_phone:"",contact_email:"",advert_information:"",advertweblinks:[],lead_source:"Not Selected",lead_source_options:["Not Selected","Gumtree","Facebook","Spareroom","Networking","Open Rent","Council HMO List","Referral","Response to Campaign","Right move","Other"]}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","LeadInformation:serializer")}},computed:{serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,landlord_name:this.landlord_name,contact_phone:this.contact_phone,contact_email:this.contact_email,advert_information:this.advert_information,advertweblinks:this.advertweblinks,lead_source:this.lead_source}},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{reset_data(){console.log("RESET DATA CALL"),this.emit_project_change_notification=!1,this.patch={id:"notset",name:"Not Set"},this.address="",this.postcode="",this.landlord_name="",this.contact_phone="",this.contact_email="",this.advert_information="",this.advertweblinks=[],this.lead_source="Not Selected";const e=this;setTimeout(function(){e.emit_project_change_notification=!0},50)},serializer_load_data(e){this.emit_project_change_notification=!1,this.address=e.address,this.postcode=e.postcode,this.landlord_name=e.landlord_name,this.contact_phone=e.contact_phone,this.contact_email=e.contact_email,this.advert_information=e.advert_information,this.lead_source=e.lead_source,this.patch=this.patch_list.filter(function(l){return l.id===e.patch_id})[0],typeof e.advertweblinks=="undefined"?this.advertweblinks=[]:this.advertweblinks=e.advertweblinks;const t=this;setTimeout(function(){t.emit_project_change_notification=!0},50)},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const t={ok:function(l){d.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(l){d.create({color:"negative",message:"Copy failed",timeout:2e3})}};N.copyTextToClipboard2(e,t)},select_patch_by_id(e){console.log("LeadInformation select_patch_by_id",e),this.patch=this.patch_list.filter(function(t){return t.id===e})[0]},select_patch(e){if(e.id==="create"){const t=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(l=>{t.new_patch_value=l;const p={ok:t.createpatchcallback,error:function(u){d.create({color:"negative",message:"Create patch failed "+u.response.data.message,timeout:2e3})}},m={patch_name:l};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:m,callback:p})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(t){return t.name===e.new_patch_value})[0],this.new_patch_value=""},updateadvertweblinks(e){this.advertweblinks=e,this.emit_project_change_notification&&this.$emit("projectchanged","LeadInformation:updateweblinks")}}}),I=n("div",{class:"text-h6"},"Lead Information",-1),A={key:0},$={key:1,class:"brrcalc-dealbasicinfo-patch"},Q=n("div",null,"Advert Links",-1),E=n("div",null,"Lead Source Gumtree/Facebook/Spareroom",-1);function P(e,t,l,p,m,u){const v=w("Weblinks");return s(),f(L,{inline:"",class:"q-ma-sm card-style col-grow"},{default:r(()=>[o(T,null,{default:r(()=>[I,e.ever_saved?c("",!0):(s(),_("div",A,[o(h,{modelValue:e.patch,"onUpdate:modelValue":[t[0]||(t[0]=a=>e.patch=a),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(s(),_("div",$,[b(" Patch: "),o(V,{flat:"",onClick:t[1]||(t[1]=a=>e.$emit("navigate_away",{dest:"/tools/cansave/patches/"+e.patch.id+"?starttab=rent_projects"}))},{default:r(()=>[b(y(e.patch.name),1)]),_:1})])):c("",!0),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":t[2]||(t[2]=a=>e.address=a),label:"Address"},null,8,["modelValue"])]),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":t[4]||(t[4]=a=>e.postcode=a),label:"Postcode"},{append:r(()=>[e.isEmpty(e.postcode)?c("",!0):(s(),f(C,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:t[3]||(t[3]=a=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])]),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.landlord_name,"onUpdate:modelValue":t[5]||(t[5]=a=>e.landlord_name=a),label:"Landlord Name"},null,8,["modelValue"])]),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.contact_phone,"onUpdate:modelValue":t[6]||(t[6]=a=>e.contact_phone=a),label:"Contact Phone"},null,8,["modelValue"])]),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.contact_email,"onUpdate:modelValue":t[7]||(t[7]=a=>e.contact_email=a),label:"Contact Email"},null,8,["modelValue"])]),n("div",null,[o(i,{filled:"",clearable:"",modelValue:e.advert_information,"onUpdate:modelValue":t[8]||(t[8]=a=>e.advert_information=a),label:"Advert Information",autogrow:""},null,8,["modelValue"])]),Q,o(v,{ref:"Weblinks",weblinks:e.advertweblinks,onUpdateweblinks:e.updateadvertweblinks},null,8,["weblinks","onUpdateweblinks"]),E,o(h,{modelValue:e.lead_source,"onUpdate:modelValue":t[9]||(t[9]=a=>e.lead_source=a),options:e.lead_source_options,label:"Lead Source","emit-value":"","option-label":"name"},null,8,["modelValue","options"])]),_:1})]),_:1})}var z=g(U,[["render",P]]);export{z as L};
