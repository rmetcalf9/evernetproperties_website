import{i as Dt,h as ze,aw as dt,j as Q,k as D,n as _t,B as Mt,an as _e,ax as zt,q as C,$ as Xe,a3 as Et,ay as Lt,a7 as pe,A as Ot,u as ht,az as Ft,al as Ut,g as Be,S as Ee,T as Ze,m as Ce,v as Nt,aa as Wt,ab as Gt,x as ft,d as E,_ as L,o as f,K as b,a as i,a8 as I,w as c,a9 as X,ag as j,e as o,af as H,av as Re,aA as Pe,ar as A,f as k,aB as Qt,r as $,c as V,au as Ae,t as h,N as J,L as ce,M as de,am as qe,aC as Le,aD as Ht,ao as xe}from"./index.e0d01b45.js";import{Q as Kt}from"./QResizeObserver.925a978b.js";import{r as Yt,Q as mt,a as Jt,b as Z,c as Xt}from"./QTable.653af1df.js";import{Q as Zt}from"./QPage.57c7099b.js";import{Q as Fe,c as xt,T as er}from"./TodoItem.abf70927.js";import{C as Ie}from"./ClosePopup.25bbe3c1.js";import{u as he}from"./utils.884fc253.js";import{S as tr,I as gt,G as rr,P as ar,R as sr,a as or,O as nr,F as ir,D as lr}from"./DealRating.6b297a8c.js";import{Q as le}from"./QTd.061ba20f.js";import{Q as ur}from"./QExpansionItem.3c272d29.js";import{F as cr}from"./FeatureTable.70eb0e5b.js";import{u as we,a as dr}from"./backend_connection.eb509816.js";import{W as Te}from"./Workflow_main.6049b641.js";import"./QItemLabel.063876e6.js";import"./position-engine.a721a3fa.js";import"./axios.6e1fcf85.js";let _r=0;const hr=["click","keydown"],fr={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${_r++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function mr(e,r,s,a){const t=Dt(dt,ze);if(t===ze)return console.error("QTab/QRouteTab component needs to be child of QTabs"),ze;const{proxy:u}=ht(),n=Q(null),l=Q(null),m=Q(null),p=D(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),_=D(()=>t.currentModel.value===e.name),B=D(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(_.value===!0?" q-tab--active"+(t.tabProps.value.activeClass?" "+t.tabProps.value.activeClass:"")+(t.tabProps.value.activeColor?` text-${t.tabProps.value.activeColor}`:"")+(t.tabProps.value.activeBgColor?` bg-${t.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&t.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||t.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(a!==void 0?a.linkClass.value:"")),R=D(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(t.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),y=D(()=>e.disable===!0||t.hasFocus.value===!0||_.value===!1&&t.hasActiveTab.value===!0?-1:e.tabindex||0);function N(w,F){if(F!==!0&&n.value!==null&&n.value.focus(),e.disable===!0){a!==void 0&&a.hasRouterLink.value===!0&&Xe(w);return}if(a===void 0){t.updateModel({name:e.name}),s("click",w);return}if(a.hasRouterLink.value===!0){const W=(O={})=>{let K;const G=O.to===void 0||Ft(O.to,e.to)===!0?t.avoidRouteWatcher=Ut():null;return a.navigateToRouterLink(w,{...O,returnRouterError:!0}).catch(ie=>{K=ie}).then(ie=>{if(G===t.avoidRouteWatcher&&(t.avoidRouteWatcher=!1,K===void 0&&(ie===void 0||ie.message.startsWith("Avoided redundant navigation")===!0)&&t.updateModel({name:e.name})),O.returnRouterError===!0)return K!==void 0?Promise.reject(K):ie})};s("click",w,W),w.defaultPrevented!==!0&&W();return}s("click",w)}function x(w){Et(w,[13,32])?N(w,!0):Lt(w)!==!0&&w.keyCode>=35&&w.keyCode<=40&&w.altKey!==!0&&w.metaKey!==!0&&t.onKbdNavigate(w.keyCode,u.$el)===!0&&Xe(w),s("keydown",w)}function ne(){const w=t.tabProps.value.narrowIndicator,F=[],W=C("div",{ref:m,class:["q-tab__indicator",t.tabProps.value.indicatorClass]});e.icon!==void 0&&F.push(C(pe,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&F.push(C("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&F.push(e.alertIcon!==void 0?C(pe,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):C("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),w===!0&&F.push(W);const O=[C("div",{class:"q-focus-helper",tabindex:-1,ref:n}),C("div",{class:R.value},Ot(r.default,F))];return w===!1&&O.push(W),O}const re={name:D(()=>e.name),rootRef:l,tabIndicatorRef:m,routeData:a};_t(()=>{t.unregisterTab(re)}),Mt(()=>{t.registerTab(re)});function fe(w,F){const W={ref:l,class:B.value,tabindex:y.value,role:"tab","aria-selected":_.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:N,onKeydown:x,...F};return _e(C(w,W,ne()),[[zt,p.value]])}return{renderTab:fe,$tabs:t}}var et=Be({name:"QTab",props:fr,emits:hr,setup(e,{slots:r,emit:s}){const{renderTab:a}=mr(e,r,s);return()=>a("div")}});function gr(e,r,s){const a=s===!0?["left","right"]:["top","bottom"];return`absolute-${r===!0?a[0]:a[1]}${e?` text-${e}`:""}`}const pr=["left","center","right","justify"];var vr=Be({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>pr.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:r,emit:s}){const{proxy:a}=ht(),{$q:t}=a,{registerTick:u}=Ee(),{registerTick:n}=Ee(),{registerTick:l}=Ee(),{registerTimeout:m,removeTimeout:p}=Ze(),{registerTimeout:_,removeTimeout:B}=Ze(),R=Q(null),y=Q(null),N=Q(e.modelValue),x=Q(!1),ne=Q(!0),re=Q(!1),fe=Q(!1),w=[],F=Q(0),W=Q(!1);let O=null,K=null,G;const ie=D(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:gr(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),bt=D(()=>{const d=F.value,g=N.value;for(let v=0;v<d;v++)if(w[v].name.value===g)return!0;return!1}),yt=D(()=>`q-tabs__content--align-${x.value===!0?"left":fe.value===!0?"justify":e.align}`),St=D(()=>`q-tabs row no-wrap items-center q-tabs--${x.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),kt=D(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+yt.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),ye=D(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),Se=D(()=>e.vertical!==!0&&t.lang.rtl===!0),je=D(()=>Yt===!1&&Se.value===!0);Ce(Se,ge),Ce(()=>e.modelValue,d=>{Ve({name:d,setCurrent:!0,skipEmit:!0})}),Ce(()=>e.outsideArrows,ke);function Ve({name:d,setCurrent:g,skipEmit:v}){N.value!==d&&(v!==!0&&e["onUpdate:modelValue"]!==void 0&&s("update:modelValue",d),(g===!0||e["onUpdate:modelValue"]===void 0)&&($t(N.value,d),N.value=d))}function ke(){u(()=>{Ue({width:R.value.offsetWidth,height:R.value.offsetHeight})})}function Ue(d){if(ye.value===void 0||y.value===null)return;const g=d[ye.value.container],v=Math.min(y.value[ye.value.scroll],Array.prototype.reduce.call(y.value.children,(z,T)=>z+(T[ye.value.content]||0),0)),M=g>0&&v>g;x.value=M,M===!0&&n(ge),fe.value=g<parseInt(e.breakpoint,10)}function $t(d,g){const v=d!=null&&d!==""?w.find(z=>z.name.value===d):null,M=g!=null&&g!==""?w.find(z=>z.name.value===g):null;if(v&&M){const z=v.tabIndicatorRef.value,T=M.tabIndicatorRef.value;O!==null&&(clearTimeout(O),O=null),z.style.transition="none",z.style.transform="none",T.style.transition="none",T.style.transform="none";const S=z.getBoundingClientRect(),U=T.getBoundingClientRect();T.style.transform=e.vertical===!0?`translate3d(0,${S.top-U.top}px,0) scale3d(1,${U.height?S.height/U.height:1},1)`:`translate3d(${S.left-U.left}px,0,0) scale3d(${U.width?S.width/U.width:1},1,1)`,l(()=>{O=setTimeout(()=>{O=null,T.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",T.style.transform="none"},70)})}M&&x.value===!0&&me(M.rootRef.value)}function me(d){const{left:g,width:v,top:M,height:z}=y.value.getBoundingClientRect(),T=d.getBoundingClientRect();let S=e.vertical===!0?T.top-M:T.left-g;if(S<0){y.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(S),ge();return}S+=e.vertical===!0?T.height-z:T.width-v,S>0&&(y.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(S),ge())}function ge(){const d=y.value;if(d===null)return;const g=d.getBoundingClientRect(),v=e.vertical===!0?d.scrollTop:Math.abs(d.scrollLeft);Se.value===!0?(ne.value=Math.ceil(v+g.width)<d.scrollWidth-1,re.value=v>0):(ne.value=v>0,re.value=e.vertical===!0?Math.ceil(v+g.height)<d.scrollHeight:Math.ceil(v+g.width)<d.scrollWidth)}function Ne(d){K!==null&&clearInterval(K),K=setInterval(()=>{Tt(d)===!0&&ae()},5)}function We(){Ne(je.value===!0?Number.MAX_SAFE_INTEGER:0)}function Ge(){Ne(je.value===!0?0:Number.MAX_SAFE_INTEGER)}function ae(){K!==null&&(clearInterval(K),K=null)}function Ct(d,g){const v=Array.prototype.filter.call(y.value.children,U=>U===g||U.matches&&U.matches(".q-tab.q-focusable")===!0),M=v.length;if(M===0)return;if(d===36)return me(v[0]),v[0].focus(),!0;if(d===35)return me(v[M-1]),v[M-1].focus(),!0;const z=d===(e.vertical===!0?38:37),T=d===(e.vertical===!0?40:39),S=z===!0?-1:T===!0?1:void 0;if(S!==void 0){const U=Se.value===!0?-1:1,ee=v.indexOf(g)+S*U;return ee>=0&&ee<M&&(me(v[ee]),v[ee].focus({preventScroll:!0})),!0}}const qt=D(()=>je.value===!0?{get:d=>Math.abs(d.scrollLeft),set:(d,g)=>{d.scrollLeft=-g}}:e.vertical===!0?{get:d=>d.scrollTop,set:(d,g)=>{d.scrollTop=g}}:{get:d=>d.scrollLeft,set:(d,g)=>{d.scrollLeft=g}});function Tt(d){const g=y.value,{get:v,set:M}=qt.value;let z=!1,T=v(g);const S=d<T?-1:1;return T+=S*5,T<0?(z=!0,T=0):(S===-1&&T<=d||S===1&&T>=d)&&(z=!0,T=d),M(g,T),ge(),z}function Qe(d,g){for(const v in d)if(d[v]!==g[v])return!1;return!0}function At(){let d=null,g={matchedLen:0,queryDiff:9999,hrefLen:0};const v=w.filter(S=>S.routeData!==void 0&&S.routeData.hasRouterLink.value===!0),{hash:M,query:z}=a.$route,T=Object.keys(z).length;for(const S of v){const U=S.routeData.exact.value===!0;if(S.routeData[U===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ee,query:De,matched:jt,href:Vt}=S.routeData.resolvedLink.value,Me=Object.keys(De).length;if(U===!0){if(ee!==M||Me!==T||Qe(z,De)===!1)continue;d=S.name.value;break}if(ee!==""&&ee!==M||Me!==0&&Qe(De,z)===!1)continue;const se={matchedLen:jt.length,queryDiff:T-Me,hrefLen:Vt.length-ee.length};if(se.matchedLen>g.matchedLen){d=S.name.value,g=se;continue}else if(se.matchedLen!==g.matchedLen)continue;if(se.queryDiff<g.queryDiff)d=S.name.value,g=se;else if(se.queryDiff!==g.queryDiff)continue;se.hrefLen>g.hrefLen&&(d=S.name.value,g=se)}d===null&&w.some(S=>S.routeData===void 0&&S.name.value===N.value)===!0||Ve({name:d,setCurrent:!0})}function Bt(d){if(p(),W.value!==!0&&R.value!==null&&d.target&&typeof d.target.closest=="function"){const g=d.target.closest(".q-tab");g&&R.value.contains(g)===!0&&(W.value=!0,x.value===!0&&me(g))}}function Rt(){m(()=>{W.value=!1},30)}function $e(){Ke.avoidRouteWatcher===!1?_(At):B()}function He(){if(G===void 0){const d=Ce(()=>a.$route.fullPath,$e);G=()=>{d(),G=void 0}}}function Pt(d){w.push(d),F.value++,ke(),d.routeData===void 0||a.$route===void 0?_(()=>{if(x.value===!0){const g=N.value,v=g!=null&&g!==""?w.find(M=>M.name.value===g):null;v&&me(v.rootRef.value)}}):(He(),d.routeData.hasRouterLink.value===!0&&$e())}function It(d){w.splice(w.indexOf(d),1),F.value--,ke(),G!==void 0&&d.routeData!==void 0&&(w.every(g=>g.routeData===void 0)===!0&&G(),$e())}const Ke={currentModel:N,tabProps:ie,hasFocus:W,hasActiveTab:bt,registerTab:Pt,unregisterTab:It,verifyRouteModel:$e,updateModel:Ve,onKbdNavigate:Ct,avoidRouteWatcher:!1};Nt(dt,Ke);function Ye(){O!==null&&clearTimeout(O),ae(),G!==void 0&&G()}let Je;return _t(Ye),Wt(()=>{Je=G!==void 0,Ye()}),Gt(()=>{Je===!0&&He(),ke()}),()=>C("div",{ref:R,class:St.value,role:"tablist",onFocusin:Bt,onFocusout:Rt},[C(Kt,{onResize:Ue}),C("div",{ref:y,class:kt.value,onScroll:ge},ft(r.default)),C(pe,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(ne.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||t.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:We,onTouchstartPassive:We,onMouseupPassive:ae,onMouseleavePassive:ae,onTouchendPassive:ae}),C(pe,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(re.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||t.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:Ge,onTouchstartPassive:Ge,onMouseupPassive:ae,onMouseleavePassive:ae,onTouchendPassive:ae})])}});const wr=E({name:"BrrCalcToolbarCallSellingAgent",emits:["activity_log"],data(){return{dialog_visible:Q(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"call_agent",text:"Called selling agent spoke to ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),br={class:"brrcalctoolbar"},yr=o("div",{class:"text-h6"},"Log call with selling agent",-1);function Sr(e,r,s,a,t,u){return f(),b("div",br,[i(I,{color:"primary",icon:"call",label:"Selling agent",onClick:e.open_dialog},null,8,["onClick"]),i(Pe,{modelValue:e.dialog_visible,"onUpdate:modelValue":r[3]||(r[3]=n=>e.dialog_visible=n)},{default:c(()=>[i(X,null,{default:c(()=>[i(j,{class:"row items-center q-pb-none"},{default:c(()=>[yr,i(Fe),_e(i(I,{icon:"close",flat:"",round:"",dense:""},null,512),[[Ie]])]),_:1}),i(j,null,{default:c(()=>[o("div",null,[i(H,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":r[0]||(r[0]=n=>e.spoke_to=n),label:"Spoke to",rules:[n=>n.length>2||"Too short"]},null,8,["modelValue","rules"])]),o("div",null,[i(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":r[1]||(r[1]=n=>e.notes=n),label:"Notes",rules:[n=>n.length>2||"Too short"]},null,8,["modelValue","rules"])]),i(Re,{align:"right",class:"text-primary"},{default:c(()=>[i(I,{label:"Cancel",onClick:r[2]||(r[2]=n=>this.dialog_visible=!1)}),i(I,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var kr=L(wr,[["render",Sr]]);const $r=E({name:"BrrCalcToolbarResearchCall",emits:["activity_log"],data(){return{dialog_visible:Q(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"research_call",text:"Research call with ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),Cr={class:"brrcalctoolbar"},qr=o("div",{class:"text-h6"},"Log research call",-1);function Tr(e,r,s,a,t,u){return f(),b("div",Cr,[i(I,{color:"primary",icon:"call",label:"Research",onClick:e.open_dialog},null,8,["onClick"]),i(Pe,{modelValue:e.dialog_visible,"onUpdate:modelValue":r[3]||(r[3]=n=>e.dialog_visible=n)},{default:c(()=>[i(X,null,{default:c(()=>[i(j,{class:"row items-center q-pb-none"},{default:c(()=>[qr,i(Fe),_e(i(I,{icon:"close",flat:"",round:"",dense:""},null,512),[[Ie]])]),_:1}),i(j,null,{default:c(()=>[o("div",null,[i(H,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":r[0]||(r[0]=n=>e.spoke_to=n),label:"Spoke to",rules:[n=>n.length>2||"Too short"]},null,8,["modelValue","rules"])]),o("div",null,[i(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":r[1]||(r[1]=n=>e.notes=n),label:"Notes",rules:[n=>n.length>2||"Too short"]},null,8,["modelValue","rules"])]),i(Re,{align:"right",class:"text-primary"},{default:c(()=>[i(I,{label:"Cancel",onClick:r[2]||(r[2]=n=>this.dialog_visible=!1)}),i(I,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Ar=L($r,[["render",Tr]]);const Br=2,Rr=E({name:"BrrCalcToolbarSaveButton",props:["reason_project_not_savable"],emits:["saveproject"],data(){return{changed:!1,autosave_seconds_left:60,ever_saved:!1,save_in_progress:!1,save_monitor_function_running:!1,pending_set_changed:!1}},computed:{no_save_message(){return this.reason_project_not_savable!==""?this.reason_project_not_savable:this.save_in_progress?"Saving...":""},can_save(){return this.save_in_progress?!1:!!this.changed},save_btn_text(){return this.save_in_progress?"Saving...":this.no_save_message!==""?"Not able to save ("+this.no_save_message+")":this.changed?this.autosave_seconds_left===-1?"Save Now":"Save now (auto save in "+this.autosave_seconds_left+")":this.ever_saved?"Saved":"Not able to save (No changes)"},is_project_changed(){return this.changed}},methods:{serializer_load_data(e){this.ever_saved=!0},click_btn(){this.autosave_seconds_left=-1,this.save_now()},set_changed_true(){if(this.pending_set_changed){console.log("SaveButton.vue:set_changed_true - set changed called but there is already one pending");return}if(this.save_in_progress){console.log("SaveButton.vue:set_changed_true - Delay set changed due to save in progress");const e=this;setTimeout(function(){e.pending_set_changed=!1,e.set_changed_true()},1e3);return}this.changed=!0,this.no_save_message===""&&(this.autosave_seconds_left=Br,this.start_save_monitor_function())},start_save_monitor_function(){this.save_monitor_function_running||this.save_monitor_function()},save_monitor_function(){if(this.save_monitor_function_running=!0,this.save_in_progress)return;if(this.autosave_seconds_left===-1){this.save_monitor_function_running=!1;return}const e=this;if(e.autosave_seconds_left=e.autosave_seconds_left-1,e.autosave_seconds_left<1){this.save_monitor_function_running=!1,this.save_now();return}setTimeout(e.save_monitor_function,1e3)},save_now(){!this.can_save||(this.save_in_progress=!0,this.$emit("saveproject"))},save_project_complete_notification({success:e,response:r}){console.log("SaveButton - Save completed notification recieved"),this.save_in_progress=!1,e?(this.changed=!1,this.ever_saved=!0):this.autosave_seconds_left=-1}}}),Pr={class:"brrcalctoolbar"};function Ir(e,r,s,a,t,u){return f(),b("div",Pr,[i(I,{color:"primary",icon:"save",label:e.save_btn_text,onClick:e.click_btn},null,8,["label","onClick"])])}var jr=L(Rr,[["render",Ir]]);function tt(){return{due:"1",description:"",type:"other",group:""}}const Vr=E({name:"BrrCalcToolbarTodoButton",emits:["createtodo"],data(){return{dialog_visible:!1,dialog_data:tt(),type_options:xt.todo_item_types,due_options:[{label:"1 Day",value:"1"},{label:"3 Days",value:"3"},{label:"5 Days",value:"5"}]}},computed:{isDisabled(){return!1}},methods:{open_dialog(){this.dialog_data=tt(),this.dialog_visible=!0},click_ok(){if(this.$refs.field_description.validate(),this.$refs.field_description.hasError)return;let e=this.dialog_data.group;this.dialog_data.type==="agent"&&(e=""),this.dialog_data.type==="sourcer"&&(e="");const r=parseInt(this.dialog_data.due),s=new Date(new Date().getTime()+r*24*60*60*1e3),a={id:he.uuidv4(),weight:"100",due_date:s.toISOString(),description:this.dialog_data.description,done:!1,done_date:"",group:e,type:this.dialog_data.type,done_text:""};this.$emit("createtodo",a),this.dialog_visible=!1},helpgrouping(){this.$q.dialog({title:"Todo Item Grouping",message:"The grouping field can be left blank. It can be used to group todo items together in displays.",html:!1}).onOk(()=>{})}}}),Dr={class:"brrcalctoolbar-todobutton"},Mr=o("div",{class:"text-h6"},"Log todo task for this project",-1),zr={class:"brrcalctoolbar-field"},Er={key:0,class:"brrcalctoolbar-field col flex"},Lr={class:"brrcalctoolbar-field"},Or={class:"brrcalctoolbar-field"};function Fr(e,r,s,a,t,u){return f(),b("div",Dr,[i(I,{color:"primary",icon:"rule",label:"Add TODO",onClick:e.open_dialog},null,8,["onClick"]),i(Pe,{modelValue:e.dialog_visible,"onUpdate:modelValue":r[5]||(r[5]=n=>e.dialog_visible=n)},{default:c(()=>[i(X,{class:"brrcalctoolbar-card"},{default:c(()=>[i(j,{class:"row items-center q-pb-none"},{default:c(()=>[Mr,i(Fe),_e(i(I,{icon:"close",flat:"",round:"",dense:""},null,512),[[Ie]])]),_:1}),i(j,null,{default:c(()=>[o("div",null,[o("div",zr,[i(mt,{modelValue:e.dialog_data.type,"onUpdate:modelValue":r[0]||(r[0]=n=>e.dialog_data.type=n),options:e.type_options,label:"Type of Task","emit-value":"","map-options":""},null,8,["modelValue","options"])]),e.dialog_data.type==="other"?(f(),b("div",Er,[i(H,{modelValue:e.dialog_data.group,"onUpdate:modelValue":r[1]||(r[1]=n=>e.dialog_data.group=n),label:"Grouping",class:"col-grow"},null,8,["modelValue"]),i(I,{round:"",dense:"",flat:"",icon:"info",onClick:e.helpgrouping},null,8,["onClick"])])):A("",!0),o("div",Lr,[i(H,{modelValue:e.dialog_data.description,"onUpdate:modelValue":r[2]||(r[2]=n=>e.dialog_data.description=n),label:"Description",autogrow:"",rules:[n=>n.trim().length>3||"Minimum 4 characters"],ref:"field_description"},null,8,["modelValue","rules"])]),o("div",Or,[k("How long until it's due: "),i(Qt,{modelValue:e.dialog_data.due,"onUpdate:modelValue":r[3]||(r[3]=n=>e.dialog_data.due=n),options:e.due_options,color:"primary",inline:""},null,8,["modelValue","options"])])]),i(Re,{align:"right",class:"text-primary"},{default:c(()=>[i(I,{label:"Cancel",onClick:r[4]||(r[4]=n=>this.dialog_visible=!1)}),i(I,{color:"primary",icon:"rule",label:"Ok",onClick:e.click_ok,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Ur=L(Vr,[["render",Fr]]);const Nr=E({name:"BrrCalcToolbar",props:["reason_project_not_savable","is_saved_project_with_id"],emits:["activity_log","saveproject","createtodo"],components:{CallSellingAgent:kr,ResearchCall:Ar,SaveButton:jr,TodoButton:Ur},data(){return{}},computed:{ever_saved(){return this.$refs.SaveToolbar.ever_saved},is_project_changed(){return this.$refs.SaveToolbar.is_project_changed}},methods:{click_save_btn(){this.$refs.SaveToolbar.click_btn()},set_changed_true(){this.$refs.SaveToolbar.set_changed_true()},save_project_complete_notification(e){this.$refs.SaveToolbar.save_project_complete_notification(e)},serializer_load_data(e){this.$refs.SaveToolbar.serializer_load_data(e)}}}),Wr={class:"row brrcalctoolbar"};function Gr(e,r,s,a,t,u){const n=$("SaveButton"),l=$("CallSellingAgent"),m=$("ResearchCall"),p=$("TodoButton");return f(),b("div",Wr,[i(n,{ref:"SaveToolbar",onSaveproject:r[0]||(r[0]=_=>e.$emit("saveproject")),reason_project_not_savable:e.reason_project_not_savable},null,8,["reason_project_not_savable"]),i(l,{onActivity_log:r[1]||(r[1]=_=>e.$emit("activity_log",_))}),i(m,{onActivity_log:r[2]||(r[2]=_=>e.$emit("activity_log",_))}),e.is_saved_project_with_id?(f(),V(p,{key:0,onCreatetodo:r[3]||(r[3]=_=>e.$emit("createtodo",_))})):A("",!0)])}var Qr=L(Nr,[["render",Gr]]);function rt(){return{flip:!1,hmo:!1}}const Hr=E({name:"BrrCalcVision",emits:["projectchanged"],data(){return{devplan:"",strategy:rt(),emit_project_change_notification:!0}},computed:{serializer_card_data(){return{devplan:this.devplan,strategy:this.strategy}}},watch:{serializer_card_data(e){this.setchanged()}},methods:{setchanged(){this.emit_project_change_notification&&this.$emit("projectchanged","Vision")},helpdevplan(){this.$q.dialog({title:"What is the development plan?",message:"Enter the development plan. E.g. Split into two flats"}).onOk(()=>{})},serializer_load_data(e){this.emit_project_change_notification=!1,this.devplan=e.devplan,typeof e.strategy=="undefined"?this.strategy=rt():(this.strategy.flip=e.strategy.flip,this.strategy.hmo=e.strategy.hmo);const r=this;setTimeout(function(){r.emit_project_change_notification=!0},50)}}}),Kr=o("div",{class:"text-h6"},"Vision",-1),Yr={class:"row"},Jr=o("div",{class:"text-h6"},"Strategies",-1);function Xr(e,r,s,a,t,u){return f(),V(X,{inline:"",class:"q-ma-sm card-style"},{default:c(()=>[i(j,null,{default:c(()=>[Kr,o("div",Yr,[i(H,{modelValue:e.devplan,"onUpdate:modelValue":r[0]||(r[0]=n=>e.devplan=n),label:"What is the development plan?",class:"col-grow"},null,8,["modelValue"]),i(I,{round:"",color:"primary",icon:"info",onClick:e.helpdevplan},null,8,["onClick"])]),k(" \xA0 "),Jr,o("div",null,[i(Ae,{modelValue:e.strategy.flip,"onUpdate:modelValue":r[1]||(r[1]=n=>e.strategy.flip=n),label:"Flip",onClick:e.setchanged},null,8,["modelValue","onClick"])]),o("div",null,[i(Ae,{modelValue:e.strategy.hmo,"onUpdate:modelValue":r[2]||(r[2]=n=>e.strategy.hmo=n),label:"HMO",onClick:e.setchanged},null,8,["modelValue","onClick"])])]),_:1})]),_:1})}var Zr=L(Hr,[["render",Xr]]);function at(){return{min:6,max:6}}const xr=E({name:"BrrCalcFinance",emits:["projectchanged"],props:["gdv_total"],components:{SliderWithTextInput:tr},data(){return{refinance:{userefinance:!0,ltv:{min:75,max:75},rate:at()},emit_project_change_notification:!0}},methods:{format_currency(e){return he.format_currency(e)},serializer_load_data(e){this.emit_project_change_notification=!1,this.refinance.userefinance=e.refinance_userefinance,this.refinance.ltv=e.refinance_userefinance_ltv,typeof e.refinance_userefinance_rate=="undefined"?this.refinance.rate=at():this.refinance.rate=e.refinance_userefinance_rate;const r=this;setTimeout(function(){r.emit_project_change_notification=!0},50)}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","Refinance")}},computed:{monthly_payments(){return{worst:this.refinanceamount.worst*(this.refinance.rate.min/(100*12)),best:this.refinanceamount.best*(this.refinance.rate.max/(100*12))}},serializer_card_data(){return{refinance_userefinance:this.refinance.userefinance,refinance_userefinance_ltv:this.refinance.ltv,refinance_userefinance_rate:this.refinance.rate}},get_refinance(){return this.refinance},refinanceamount(){return{worst:this.gdv_total.min*(this.refinance.ltv.min/100),best:this.gdv_total.max*(this.refinance.ltv.max/100)}},refinance_out_items(){let e=[];return this.refinance.userefinance&&e.push({name:"Mortgage Refinance",worst:this.refinanceamount.worst,best:this.refinanceamount.best}),e}}}),ea=o("div",{class:"text-h6"},"Refinance",-1),ta={key:0},ra=o("hr",null,null,-1),aa=o("hr",null,null,-1);function sa(e,r,s,a,t,u){const n=$("SliderWithTextInput");return f(),V(X,{inline:"",class:"q-ma-sm card-style"},{default:c(()=>[i(j,null,{default:c(()=>[ea,k(" This section is for adding refinance details. After the refurbishment is complete the refinance stage can be used to pull money out of the deal. "),i(Ae,{modelValue:e.refinance.userefinance,"onUpdate:modelValue":r[0]||(r[0]=l=>e.refinance.userefinance=l),label:"Refinance after refurbishment"},null,8,["modelValue"]),e.refinance.userefinance?(f(),b("div",ta,[k(" Refinance LTV "+h(e.refinance.ltv.min)+"% - "+h(e.refinance.ltv.max)+"% ",1),i(n,{ref:"slider",range:e.refinance.ltv,"onUpdate:range":r[1]||(r[1]=l=>e.refinance.ltv=l),min:0,max:100,step:5,left_label_value:e.refinance.ltv.min+"%",right_label_value:e.refinance.ltv.max+"%",min_label_text:"Worst LTV %",max_label_text:"Best LTV %"},null,8,["range","left_label_value","right_label_value"]),ra,k(" Intrest rate "+h(e.refinance.rate.min)+"% - "+h(e.refinance.rate.max)+"% ",1),i(n,{ref:"slider",range:e.refinance.rate,"onUpdate:range":r[2]||(r[2]=l=>e.refinance.rate=l),min:0,max:50,step:.1,left_label_value:e.refinance.rate.min+"%",right_label_value:e.refinance.rate.max+"%",min_label_text:"Worst %",max_label_text:"Best %"},null,8,["range","left_label_value","right_label_value"]),aa,o("div",null,"Refinance amount: "+h(e.format_currency(e.refinanceamount.worst))+" - "+h(e.format_currency(e.refinanceamount.best)),1),o("div",null,"Monthly Payments: "+h(e.format_currency(e.monthly_payments.worst))+" - "+h(e.format_currency(e.monthly_payments.best)),1)])):A("",!0)]),_:1})]),_:1})}var oa=L(xr,[["render",sa]]),ve=Be({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:r}){const s=D(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>C("tr",{class:s.value},ft(r.default))}});function pt(e){return e.filter(function(r){return r.type==="ledger"})}function Oe(e,r){e.push({type:"blank",key:e.length}),e.push({type:"title",key:e.length,name:r})}function oe(e,r,s,a){let t=pt(e);var u=void 0,n=void 0;t.length>0&&(u=t[t.length-1].worst,n=t[t.length-1].best);function l(m,p){var _=0;typeof m!="undefined"&&(_=m.bal);var B="",R="";return p>0?B=p:R=p,{in:B,out:R,bal:_+p}}e.push({type:"ledger",key:e.length,name:r,worst:l(u,s),best:l(n,a)})}const na=E({name:"BrrCalcDealSummary",props:["is_valid_input","purchaserange","finance_in_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","finance_out_items","refinance_out_items","finance_during_items"],components:{InvalidMessage:gt},data(){return{table:{columns:[{name:"item",label:"Item",field:"item"},{name:"win",label:"In",field:"win"},{name:"wout",label:"Out",field:"wout"},{name:"wbal",label:"Balance",field:"wbal"},{name:"bin",label:"In",field:"bin"},{name:"bout",label:"Out",field:"bout"},{name:"bbal",label:"Balance",field:"bbal"}]}}},methods:{format_currency(e){return typeof e=="string"&&e===""?"":he.format_currency(e)}},computed:{final_bal(){let e=pt(this.items);return e.length===0?{worst:0,best:0}:{worst:e[e.length-1].worst.bal,best:e[e.length-1].best.bal}},money_in(){var e=this.finance_in_items.reduce((s,a)=>s+a.worst,0),r=this.finance_in_items.reduce((s,a)=>s+a.best,0);return{worst:e,best:r}},items(){var e=[];typeof this.finance_in_items!="undefined"&&this.finance_in_items.map(function(s){oe(e,s.name,s.worst,s.best)}),typeof this.purchase_items!="undefined"&&this.purchase_items.map(function(s){oe(e,s.name,s.worst,s.best)}),typeof this.stampduty_items!="undefined"&&this.stampduty_items.map(function(s){oe(e,s.name,s.worst,s.best)}),typeof this.othercosts_items!="undefined"&&this.othercosts_items.map(function(s){oe(e,s.name,s.worst,s.best)}),Oe(e,"During Project"),typeof this.finance_during_items!="undefined"&&this.finance_during_items.map(function(s){oe(e,s.name,s.worst,s.best)}),typeof this.refurb_cost_items!="undefined"&&this.refurb_cost_items.map(function(s){oe(e,s.name,s.worst,s.best)});let r=!1;return typeof this.refinance_out_items!="undefined"&&(this.refinance_out_items.length>0&&(r=!0,Oe(e,"Exit finance")),this.refinance_out_items.map(function(s){oe(e,s.name,s.worst,s.best)})),typeof this.finance_out_items!="undefined"&&(this.finance_out_items.length>0&&(r||Oe(e,"Exit finance")),this.finance_out_items.map(function(s){oe(e,s.name,s.worst,s.best)})),e}}}),ia=o("div",{class:"text-h6"},"Cashflow Summary",-1),la=o("div",{class:"text-subtitle2"},"This section gives a break down of money in and out of the deal. It is broken down twice, for best and worst case figures.",-1),ua=o("div",null," \xA0 ",-1);function ca(e,r,s,a,t,u){const n=$("InvalidMessage");return f(),V(X,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[ia,la]),_:1}),i(j,null,{default:c(()=>[i(n,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),o("div",null,[i(Jt,{columns:e.table.columns,rows:e.items,"hide-bottom":"","rows-per-page-options":[100]},{header:c(l=>[i(ve,null,{default:c(()=>[i(Z),i(Z,{colspan:"3",class:"worstcasetablecell"},{default:c(()=>[k("Worst Case")]),_:1}),i(Z,{colspan:"3"},{default:c(()=>[k("Best Case")]),_:1})]),_:1}),i(ve,{props:l},{default:c(()=>[i(Z,null,{default:c(()=>[k(" Item ")]),_:1}),i(Z,{class:"worstcasetablecell"},{default:c(()=>[k(" In ")]),_:1}),i(Z,{class:"worstcasetablecell"},{default:c(()=>[k(" Out ")]),_:1}),i(Z,{class:"worstcasetablecell"},{default:c(()=>[k(" Balance ")]),_:1}),i(Z,null,{default:c(()=>[k(" In ")]),_:1}),i(Z,null,{default:c(()=>[k(" Out ")]),_:1}),i(Z,null,{default:c(()=>[k(" Balance ")]),_:1})]),_:2},1032,["props"])]),body:c(l=>[l.row.type==="ledger"?(f(),V(ve,{key:0},{default:c(()=>[i(le,{class:"tablerowcell"},{default:c(()=>[k(h(l.row.name),1)]),_:2},1024),i(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.worst.in)),1)]),_:2},1024),i(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.worst.out)),1)]),_:2},1024),i(le,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.worst.bal)),1)]),_:2},1024),i(le,{class:"valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.best.in)),1)]),_:2},1024),i(le,{class:"valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.best.out)),1)]),_:2},1024),i(le,{class:"valuetablecell tablerowcell"},{default:c(()=>[k(h(e.format_currency(l.row.best.bal)),1)]),_:2},1024)]),_:2},1024)):A("",!0),l.row.type==="blank"?(f(),V(ve,{key:1},{default:c(()=>[i(Z,{colspan:"7"},{default:c(()=>[k("\xA0")]),_:1})]),_:1})):A("",!0),l.row.type==="title"?(f(),V(ve,{key:2},{default:c(()=>[i(Z,{colspan:"7"},{default:c(()=>[k(h(l.row.name),1)]),_:2},1024)]),_:2},1024)):A("",!0)]),_:1},8,["columns","rows"])]),ua]),_:1})]),_:1})}var da=L(na,[["render",ca]]);const _a=E({name:"BrrCalcDealRatingAlternativeSummary",props:["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"],methods:{format_currency(e){return he.format_currency(e)}},computed:{mortgage_rate_display(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max+"%",worst:this.finance_refinance.ltv.min+"%"}:{best:"N/A",worst:"N/A"}},mortgage(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max/100*this.purchaserange.min,worst:this.finance_refinance.ltv.min/100*this.purchaserange.max}:{best:0,worst:0}},deposit(){return{best:this.purchaserange.min-this.mortgage.best,worst:this.purchaserange.max-this.mortgage.worst}},total_money_in(){return{best:this.mortgage.best+this.deposit.best+this.stampduty_total.min+this.othercosts_total.min+this.refurb_cost_total.min,worst:this.mortgage.worst+this.deposit.worst+this.stampduty_total.max+this.othercosts_total.max+this.refurb_cost_total.max}},new_mortgage_amount(){return{best:this.gdv_total.max*(this.finance_refinance.ltv.max/100),worst:this.gdv_total.min*(this.finance_refinance.ltv.min/100)}},monay_pulled_out(){return{best:this.gdv_total.max-this.new_mortgage_amount.best,worst:this.gdv_total.min-this.new_mortgage_amount.worst}},profit(){return{best:this.gdv_total.max-this.total_money_in.best,worst:this.gdv_total.min-this.total_money_in.worst}},money_left_in(){return{best:this.monay_pulled_out.best-this.profit.best,worst:this.monay_pulled_out.worst-this.profit.worst}}}}),ha={class:"alternativetable"},fa=o("thead",null,[o("tr",null,[o("th",{class:"text-left alternativetablecell"}),o("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),o("th",{class:"text-center alternativetablecell"},"Best case")])],-1),ma=o("td",{class:"text-left alternativetablecell"},"Price offered",-1),ga={class:"text-right alternativetablecell yellowtablecell totaltablecell"},pa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},va=o("td",{class:"text-left alternativetablecell"},"Mortgage %",-1),wa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ba={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ya=o("td",{class:"text-left alternativetablecell"},"Mortgage",-1),Sa={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ka={class:"text-right alternativetablecell totaltablecell"},$a=o("td",{class:"text-left alternativetablecell"},"Deposit",-1),Ca={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},qa={class:"text-right alternativetablecell totaltablecell"},Ta=o("td",{class:"text-left alternativetablecell"},"Stamp Duty",-1),Aa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ba={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ra=o("td",{class:"text-left alternativetablecell"},"Other costs (Legals, etc)",-1),Pa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ia={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ja=o("td",{class:"text-left alternativetablecell"},"Total Refurb Costs",-1),Va={class:"text-right alternativetablecell bluetablecell totaltablecell"},Da={class:"text-right alternativetablecell bluetablecell totaltablecell"},Ma=o("td",{class:"text-left alternativetablecell"},"Total Money In",-1),za={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Ea={class:"text-right alternativetablecell totaltablecell"},La=o("tr",null,[o("td",null,"\xA0"),o("td",{class:"worstcasetablecell"}),o("td")],-1),Oa=o("td",{class:"text-left alternativetablecell"},"End Value",-1),Fa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Ua={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Na=o("td",{class:"text-left alternativetablecell"},"New Mortgage Amount",-1),Wa={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Ga={class:"text-right alternativetablecell totaltablecell"},Qa=o("td",{class:"text-left alternativetablecell"},"Money Pulled Out",-1),Ha={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Ka={class:"text-right alternativetablecell totaltablecell"},Ya=o("tr",null,[o("td",null,"\xA0"),o("td",{class:"worstcasetablecell"}),o("td")],-1),Ja=o("td",{class:"text-left alternativetablecell"},"Profit",-1),Xa={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Za={class:"text-right alternativetablecell totaltablecell"},xa=o("td",{class:"text-left alternativetablecell"},"Money Left In",-1),es={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ts={class:"text-right alternativetablecell totaltablecell"};function rs(e,r,s,a,t,u){return f(),V(ur,{"expand-separator":"",label:"Alternative summary format"},{default:c(()=>[o("div",null,[k(" This is another way of viewing the project numbers that is commonly used. I have included this for comparison. "),o("table",ha,[fa,o("tbody",null,[o("tr",null,[ma,o("td",ga,h(e.format_currency(e.purchaserange.max)),1),o("td",pa,h(e.format_currency(e.purchaserange.min)),1)]),o("tr",null,[va,o("td",wa,h(e.mortgage_rate_display.worst),1),o("td",ba,h(e.mortgage_rate_display.best),1)]),o("tr",null,[ya,o("td",Sa,h(e.format_currency(e.mortgage.worst)),1),o("td",ka,h(e.format_currency(e.mortgage.best)),1)]),o("tr",null,[$a,o("td",Ca,h(e.format_currency(e.deposit.worst)),1),o("td",qa,h(e.format_currency(e.deposit.best)),1)]),o("tr",null,[Ta,o("td",Aa,h(e.format_currency(e.stampduty_total.max)),1),o("td",Ba,h(e.format_currency(e.stampduty_total.min)),1)]),o("tr",null,[Ra,o("td",Pa,h(e.format_currency(e.othercosts_total.max)),1),o("td",Ia,h(e.format_currency(e.othercosts_total.min)),1)]),o("tr",null,[ja,o("td",Va,h(e.format_currency(e.refurb_cost_total.max)),1),o("td",Da,h(e.format_currency(e.refurb_cost_total.min)),1)]),o("tr",null,[Ma,o("th",za,h(e.format_currency(e.total_money_in.worst)),1),o("th",Ea,h(e.format_currency(e.total_money_in.best)),1)]),La,o("tr",null,[Oa,o("td",Fa,h(e.format_currency(e.gdv_total.min)),1),o("td",Ua,h(e.format_currency(e.gdv_total.max)),1)]),o("tr",null,[Na,o("td",Wa,h(e.format_currency(e.new_mortgage_amount.worst)),1),o("td",Ga,h(e.format_currency(e.new_mortgage_amount.best)),1)]),o("tr",null,[Qa,o("td",Ha,h(e.format_currency(e.monay_pulled_out.worst)),1),o("td",Ka,h(e.format_currency(e.monay_pulled_out.best)),1)]),Ya,o("tr",null,[Ja,o("td",Xa,h(e.format_currency(e.profit.worst)),1),o("td",Za,h(e.format_currency(e.profit.best)),1)]),o("tr",null,[xa,o("td",es,h(e.format_currency(e.money_left_in.worst)),1),o("td",ts,h(e.format_currency(e.money_left_in.best)),1)])])]),k(" Note: The profit amounts may not match because this method does not take into account finance costs. ")])]),_:1})}var as=L(_a,[["render",rs]]);const ss=E({name:"BrrCalcDealRatingCompareDoneup",props:["purchaserange","refurb_cost_total","gdv_total"],methods:{format_currency(e){return he.format_currency(e)},format_percent(e){return he.format_percent(e)}},computed:{total_spent(){return{worst:this.purchaserange.max+this.refurb_cost_total.max,best:this.purchaserange.min+this.refurb_cost_total.min}},gain(){return{worst:this.gdv_total.min-this.total_spent.worst,best:this.gdv_total.max-this.total_spent.best}},profit_percentage(){return{worst:this.gain.worst/this.total_spent.worst,best:this.gain.best/this.total_spent.best}}}}),os=o("div",{class:"text-h5"},"Compare this project to buying a done up property",-1),ns=o("div",null,"This section compares this project with buying a property that is already done up. To account for the time and risk involved with a refurbishment we expect the end value of the property to be more than if we had just bought one.",-1),is={class:"alternativetable"},ls=o("thead",null,[o("tr",null,[o("th",{class:"text-left alternativetablecell"}),o("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),o("th",{class:"text-center alternativetablecell"},"Best case")])],-1),us=o("td",{class:"text-left alternativetablecell"},"Purchase + Refurb",-1),cs={class:"text-right alternativetablecell worstcasetablecell"},ds={class:"text-right alternativetablecell"},_s=o("td",{class:"text-left alternativetablecell"},"End Value",-1),hs={class:"text-right alternativetablecell worstcasetablecell"},fs={class:"text-right alternativetablecell"},ms=o("td",{class:"text-left alternativetablecell totaltablecell"},"Gain",-1),gs={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ps={class:"text-right alternativetablecell totaltablecell"},vs=o("td",{class:"text-left alternativetablecell totaltablecell"},"Percentage",-1),ws={class:"text-right alternativetablecell worstcasetablecell finaltotaltablecell"},bs={class:"text-right alternativetablecell finaltotaltablecell"};function ys(e,r,s,a,t,u){return f(),b("div",null,[os,ns,o("table",is,[ls,o("tbody",null,[o("tr",null,[us,o("td",cs,h(e.format_currency(e.total_spent.worst)),1),o("td",ds,h(e.format_currency(e.total_spent.best)),1)]),o("tr",null,[_s,o("td",hs,h(e.format_currency(e.gdv_total.min)),1),o("td",fs,h(e.format_currency(e.gdv_total.max)),1)]),o("tr",null,[ms,o("td",gs,h(e.format_currency(e.gain.worst)),1),o("td",ps,h(e.format_currency(e.gain.best)),1)]),o("tr",null,[vs,o("td",ws,h(e.format_percent(e.profit_percentage.worst)),1),o("td",bs,h(e.format_percent(e.profit_percentage.best)),1)])])])])}var Ss=L(ss,[["render",ys]]);const ks=E({name:"BrrCalcDealRating",props:["is_valid_input","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","purchaserange","stampduty_total","othercosts_total","refurb_cost_total"],components:{dealRatingAlternativeSummary:as,FeatureTable:cr,InvalidMessage:gt,dealRatingCompareDoneup:Ss},data(){return{}},methods:{format_currency(e){return he.format_currency(e)}},computed:{features(){let e=[];var r=Math.min(this.cash_out_of_deal_minus_cash_in.best,this.cash_out_of_deal_minus_cash_in.worst);r>0?e.push({type:"positive",text:"All money out deal! - All initial investment returned plus at least "+this.format_currency(r)}):e.push({type:"negative",text:"Not all money out deal! - Might leave "+this.format_currency(-1*r)+" in."});var s=Math.min(this.profit.best,this.profit.worst);s<0?e.push({type:"negative",text:"Deal makes a loss! - End value might be "+this.format_currency(-1*s)+" less than investment."}):s<this.gdv_total.min*.25?e.push({type:"negative",text:"Low amount of profit! - Low profit "+this.format_currency(s)+" less than 25% of gdv."}):e.push({type:"positive",text:"Profit making deal! - Profit of "+this.format_currency(s)+"!"});var a=Math.min(this.annualroi.worst,this.annualroi.best);return a<3?e.push({type:"negative",text:"Very low ROI! "+a.toFixed(1)+"%"}):a>10&&e.push({type:"positive",text:"Good ROI! "+a.toFixed(1)+"%"}),e},cash_out_of_deal_minus_cash_in(){return{best:this.deal_summary_final_bal.best-this.finance_totalmoneyneeded.best,worst:this.deal_summary_final_bal.worst-this.finance_totalmoneyneeded.worst}},percent_left_in(){return this.finance_refinance.userefinance?{best:100-this.finance_refinance.ltv.max,worst:100-this.finance_refinance.ltv.min}:{best:100,worst:100}},amount_equity_left_in(){return{best:this.gdv_total.max*(this.percent_left_in.best/100),worst:this.gdv_total.min*(this.percent_left_in.worst/100)}},total_end_value(){return{best:this.amount_equity_left_in.best+this.deal_summary_final_bal.best,worst:this.amount_equity_left_in.worst+this.deal_summary_final_bal.worst}},profit(){return{best:this.total_end_value.best-this.finance_totalmoneyneeded.best,worst:this.total_end_value.worst-this.finance_totalmoneyneeded.worst}},roi(){return{best:100*this.profit.best/this.finance_totalmoneyneeded.best,worst:100*this.profit.worst/this.finance_totalmoneyneeded.worst}},annualroi(){return{worst:this.roi.worst*(12/this.refurbmonths.worst),best:this.roi.best*(12/this.refurbmonths.best)}}}}),$s=o("div",{class:"text-h6"},"Project Rating",-1),Cs=o("div",{class:"text-subtitle2"},"How good is this project?",-1),qs=o("div",{class:"text-h5"},"Profit/Loss",-1),Ts=o("div",null,"Compare what we have put into the deal vs what we get out of it. These calculations won't account for time invested or the risk taken on in the project",-1),As={class:"text-h5"},Bs=o("div",{class:"text-h6"},"Deal Features",-1);function Rs(e,r,s,a,t,u){const n=$("InvalidMessage"),l=$("dealRatingCompareDoneup"),m=$("dealRatingAlternativeSummary"),p=$("FeatureTable");return f(),V(X,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[$s,Cs]),_:1}),i(j,null,{default:c(()=>[i(n,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),qs,Ts,o("div",As,"Total cash in: "+h(e.format_currency(e.finance_totalmoneyneeded.worst))+" - "+h(e.format_currency(e.finance_totalmoneyneeded.best))+" Worst - Best",1),i(l,{purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","refurb_cost_total","gdv_total"])]),_:1}),i(j,null,{default:c(()=>[i(m,{purchaserange:e.purchaserange,finance_refinance:e.finance_refinance,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"])]),_:1}),i(j,null,{default:c(()=>[Bs,i(p,{features:e.features,"onUpdate:features":r[0]||(r[0]=_=>e.features=_)},null,8,["features"])]),_:1})]),_:1})}var Ps=L(ks,[["render",Rs]]);function Is(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}function st(e,r){return{id:Is(),label:e,displaytext:r}}const js=E({name:"WebLinksComponent",props:["weblinks"],emits:["updateweblinks"],data(){return{edit_dialog:{visible:!1,record:{},title:"",message:""}}},computed:{weblinkdisplay(){return this.weblinks.map(function(e){if(typeof e.displaytext!="undefined"&&e.displaytext!=null&&e.displaytext.trim().length>0)return{id:e.id,label:e.label,text:e.displaytext,icon:"star"};const r=new URL(e.label);let s="web",a=r.hostname;return r.hostname==="www.google.com"&&(r.pathname.startsWith("/maps/@")&&(r.pathname.includes("/data=")?(a="Google Streetview",s="streetview"):(a="Google Map",s="map")),r.pathname.startsWith("/maps/place")&&(a="Google Place",s="place")),{id:e.id,label:e.label,text:a,icon:s}})}},methods:{editweblink(e){this.edit_dialog.record=JSON.parse(JSON.stringify(this.weblinks.filter(function(r){return r.id===e})[0])),this.edit_dialog.title="Edit Weblink",this.edit_dialog.message="",this.edit_dialog.visible=!0},editweblinkok(){if(!this.validate_weblink(this.edit_dialog.record))return;const e=this,r=this.weblinks.filter(function(s){return e.edit_dialog.record.id!==s.id});r.push(this.edit_dialog.record),this.edit_dialog.visible=!1,e.$emit("updateweblinks",r)},apiaddweblink({url:e,displaytext:r}){const s=this.weblinks.filter(function(a){return!0});s.push(st(e,r)),this.$emit("updateweblinks",s)},clickweblink(e){window.open(e.label,"_blank").focus()},delweblink(e){const r=this.weblinks.filter(function(s){return e!==s.id});this.edit_dialog.visible=!1,this.$emit("updateweblinks",r)},validate_weblink(e){return typeof e.label=="undefined"?(J.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1):e.label===null?(J.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1):e.label.startsWith("http")?!0:(J.create({color:"bg-grey-2",message:"Link must start with http",timeout:2e3,color:"negative"}),!1)},addweblink(){this.edit_dialog.title="Add Weblink",this.edit_dialog.message="Add weblink to information about this property (rightmove, zoopla, etc.)",this.edit_dialog.record=st("",""),this.edit_dialog.visible=!0}}}),Vs={class:"text-h6"},Ds={style:{width:"25vw"}};function Ms(e,r,s,a,t,u){return f(),b("div",null,[(f(!0),b(ce,null,de(e.weblinkdisplay,n=>(f(),b("div",{key:n},[i(Xt,{clickable:"",onClick:l=>e.clickweblink(n),removable:"",onRemove:l=>e.editweblink(n.id),color:"primary","text-color":"white",icon:n.icon,"icon-remove":"edit"},{default:c(()=>[k(h(n.text),1)]),_:2},1032,["onClick","onRemove","icon"])]))),128)),i(I,{round:"",color:"primary",icon:"add",onClick:e.addweblink},null,8,["onClick"]),i(Pe,{modelValue:e.edit_dialog.visible,"onUpdate:modelValue":r[3]||(r[3]=n=>e.edit_dialog.visible=n)},{default:c(()=>[i(X,null,{default:c(()=>[i(j,null,{default:c(()=>[o("div",Vs,h(e.edit_dialog.title),1)]),_:1}),i(j,{class:"q-pt-none"},{default:c(()=>[o("div",Ds,[k(h(e.edit_dialog.message)+" ",1),i(H,{modelValue:e.edit_dialog.record.displaytext,"onUpdate:modelValue":r[0]||(r[0]=n=>e.edit_dialog.record.displaytext=n),label:"Display Text",clearable:""},null,8,["modelValue"]),i(H,{modelValue:e.edit_dialog.record.label,"onUpdate:modelValue":r[1]||(r[1]=n=>e.edit_dialog.record.label=n),label:"URL",clearable:""},null,8,["modelValue"])])]),_:1}),i(Re,{align:"right"},{default:c(()=>[i(I,{flat:"",label:"Delete",color:"negative",onClick:r[2]||(r[2]=n=>e.delweblink(e.edit_dialog.record.id))}),_e(i(I,{flat:"",label:"Cancel",color:"primary"},null,512),[[Ie]]),i(I,{flat:"",label:"OK",onClick:e.editweblinkok},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var zs=L(js,[["render",Ms]]);function ot(){return{type:"self",value:""}}const Es=E({name:"DealBasicInfo",emits:["projectchanged","navigate_away"],props:["ever_saved"],components:{Weblinks:zs},setup(){return{backend_connection_store:we()}},data(){return{patch:{id:"notset",name:"Not Set"},address:"",postcode:"",weblinks:[],new_patch_value:"",selling_agent:"",notes:"",emit_project_change_notification:!0,deal_source:ot(),deal_source_local_only:{self_check_box:!0,value:""}}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:serializer")}},computed:{deal_source_is_self(){return this.deal_source.type==="self"},serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,weblinks:this.weblinks,selling_agent:this.selling_agent,notes:this.notes,deal_source:this.deal_source}},reason_project_not_savable(){return this.patch.id==="notset"?"Select patch":typeof this.address=="undefeind"||this.address===null||this.address.length<3?"Enter address":""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{apiaddweblink(e){return this.$refs.Weblinks.apiaddweblink(e)},updatedealsource(){let e="self";this.deal_source_local_only.self_check_box===!1&&(e="text");let r=this.deal_source_local_only.value;this.deal_source={type:e,value:r}},updateweblinks(e){this.weblinks=e,this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:updateweblinks")},serializer_load_data(e){this.emit_project_change_notification=!1,this.address=e.address,this.postcode=e.postcode,this.weblinks=e.weblinks,this.selling_agent=e.selling_agent,this.notes=e.notes,this.patch=this.patch_list.filter(function(s){return s.id===e.patch_id})[0],typeof e.deal_source=="undefined"?this.deal_source=ot():this.deal_source=e.deal_source,this.deal_source_local_only.self_check_box=this.deal_source.type==="self",this.deal_source_local_only.value=this.deal_source.value,this.updatedealsource();const r=this;setTimeout(function(){r.emit_project_change_notification=!0,r.changed=!1,r.autosave_seconds_left=-1},50)},select_patch_by_id(e){this.patch=this.patch_list.filter(function(r){return r.id===e})[0]},select_patch(e){if(e.id==="create"){const r=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(s=>{r.new_patch_value=s;const a={ok:r.createpatchcallback,error:function(u){J.create({color:"negative",message:"Create patch failed "+u.response.data.message,timeout:2e3})}},t={patch_name:s};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:t,callback:a})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(r){return r.name===e.new_patch_value})[0],this.new_patch_value=""},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const r={ok:function(s){J.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(s){J.create({color:"negative",message:"Copy failed",timeout:2e3})}};dr.copyTextToClipboard2(e,r)}}}),Ls=o("div",{class:"text-h6"},"Basic Information",-1),Os=o("div",{class:"text-subtitle2"},"Basic information about this project",-1),Fs={key:0},Us={key:1,class:"brrcalc-dealbasicinfo-patch"},Ns=o("div",{class:"text-h6"},"Weblinks",-1),Ws=o("div",null,"Deal Source",-1);function Gs(e,r,s,a,t,u){const n=$("Weblinks");return e.security_role_cansave?(f(),V(X,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[Ls,Os]),_:1}),i(j,null,{default:c(()=>[e.ever_saved?A("",!0):(f(),b("div",Fs,[i(mt,{modelValue:e.patch,"onUpdate:modelValue":[r[0]||(r[0]=l=>e.patch=l),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(f(),b("div",Us,[k(" Patch: "),i(I,{flat:"",onClick:r[1]||(r[1]=l=>e.$emit("navigate_away",{dest:"/tools/cansave/patches/"+e.patch.id}))},{default:c(()=>[k(h(e.patch.name),1)]),_:1})])):A("",!0),o("div",null,[i(H,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":r[2]||(r[2]=l=>e.address=l),label:"Address"},null,8,["modelValue"])]),o("div",null,[i(H,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":r[4]||(r[4]=l=>e.postcode=l),label:"Postcode"},{append:c(()=>[e.isEmpty(e.postcode)?A("",!0):(f(),V(pe,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:r[3]||(r[3]=l=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])])]),_:1}),i(qe,{class:"basic-info-seperator"}),i(j,null,{default:c(()=>[o("div",null,[Ns,i(n,{ref:"Weblinks",weblinks:e.weblinks,onUpdateweblinks:e.updateweblinks},null,8,["weblinks","onUpdateweblinks"])]),i(qe,{class:"basic-info-seperator"}),o("div",null,[i(H,{filled:"",clearable:"",modelValue:e.selling_agent,"onUpdate:modelValue":r[5]||(r[5]=l=>e.selling_agent=l),label:"Selling Agent"},null,8,["modelValue"])]),i(qe,{class:"basic-info-seperator"}),o("div",null,[i(H,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":r[6]||(r[6]=l=>e.notes=l),label:"Notes"},null,8,["modelValue"])]),i(qe,{class:"basic-info-seperator"}),Ws,o("div",null,[i(Ae,{modelValue:e.deal_source_local_only.self_check_box,"onUpdate:modelValue":[r[7]||(r[7]=l=>e.deal_source_local_only.self_check_box=l),e.updatedealsource],label:"Self sourced"},null,8,["modelValue","onUpdate:modelValue"])]),o("div",null,[i(H,{filled:"",autogrow:"",modelValue:e.deal_source_local_only.value,"onUpdate:modelValue":[r[8]||(r[8]=l=>e.deal_source_local_only.value=l),e.updatedealsource],label:"Name of source",disable:e.deal_source_local_only.self_check_box},null,8,["modelValue","disable","onUpdate:modelValue"])])]),_:1})]),_:1})):A("",!0)}var Qs=L(Es,[["render",Gs]]);function Hs(e,r,s){const a=[];a.push({range:"Main!A1",values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),a.push({range:"Main!A2:B2",values:[["Patch:",r.patch.name]]}),a.push({range:"Main!A3:B3",values:[["Address:",r.serialized_data.dealbasicinfo.address]]}),a.push({range:"Main!E3:E3",values:[[r.serialized_data.dealbasicinfo.postcode]]}),a.push({range:"Main!A4:A4",values:[["Links:"]]});let t=3;return r.serialized_data.dealbasicinfo.weblinks.forEach(function(u){t=t+1,a.push({range:"Main!B"+t.toString()+":B"+t.toString(),values:[['=HYPERLINK("'+u.label+'", "'+u.label+'")']]})}),t=t+1,t=t+1,a.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Selling Agent:",r.serialized_data.dealbasicinfo.selling_agent]]}),t=t+1,a.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Notes:",r.serialized_data.dealbasicinfo.notes]]}),t=t+1,a.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Vision:",r.serialized_data.vision.devplan]]}),t=t+1,t=t+1,a.push({range:"Main!A"+t.toString()+":A"+t.toString(),values:[["Caculations provided here are for reference only and should be manually checked."]]}),a}function Ks(e,r,s){const a=[];return a.push({repeatCell:{range:{sheetId:s.Main,startRowIndex:0,endRowIndex:r.serialized_data.dealbasicinfo.weblinks.length+6+1,startColumnIndex:0,endColumnIndex:1},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}),a}var nt={get_sheet_main_values:Hs,get_sheet_main:Ks};function Ys(e){function r(s,a,t,u,n){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:a,startColumnIndex:t,endColumnIndex:u},cell:{userEnteredFormat:{numberFormat:{type:"NUMBER",pattern:n}}},fields:"userEnteredFormat.numberFormat"}}}return{makeboldandvaligntop:function(s,a,t,u){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:a,startColumnIndex:t,endColumnIndex:u},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeitalicandvaligntop:function(s,a,t,u){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:a,startColumnIndex:t,endColumnIndex:u},cell:{userEnteredFormat:{textFormat:{italic:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeboldandvaligntopandsetfontsize:function(s,a,t,u,n){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:a,startColumnIndex:t,endColumnIndex:u},cell:{userEnteredFormat:{textFormat:{fontSize:n,bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},formatnumbermisc:function(s,a,t,u,n){return r(s,a,t,u,n)},formatcurrency:function(s,a,t,u){return r(s,a,t,u,"[$\xA3-809]#,##0.00")},formatpercentage:function(s,a,t,u){return r(s,a,t,u,"0.00%")},adjustcolumnwidth:function(s,a){return{updateDimensionProperties:{range:{sheetId:e,dimension:"COLUMNS",startIndex:s,endIndex:s+1},properties:{pixelSize:a},fields:"pixelSize"}}}}}var be={get_sheet_utils:Ys};const q="Purchase Phase",vt="Bridge Amount";function Js(e,r,s){return{name:"Buying Cash",pre_stage:function(a){},start_details:function(a){return[["Purchase Price",r.serialized_data.purchaseprice.purchaserangevalue.max,r.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(a){return[]}}}function Xs(e,r,s){return{name:"Buying with a Mortgage",pre_stage:function(a,t){const u=[],n=a.cur_row;a.cur_row=a.cur_row+1,a.value_requests.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["","Worst","Best"]]}),a.requests.push(t.makeboldandvaligntop(a.cur_row-1,a.cur_row,1,3)),a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Purchase Price",r.serialized_data.purchaseprice.purchaserangevalue.max,r.serialized_data.purchaseprice.purchaserangevalue.min]]}),a.requests.push(t.formatcurrency(n,a.cur_row,1,3)),a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Mortage Rate",r.serialized_data.finance.mortgage.rate.max/100,r.serialized_data.finance.mortgage.rate.min/100]]}),a.requests.push(t.formatpercentage(a.cur_row-1,a.cur_row,1,3)),a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Mortgage LTV",r.serialized_data.finance.mortgage.ltv.max/100,r.serialized_data.finance.mortgage.ltv.min/100]]}),a.requests.push(t.formatpercentage(a.cur_row-1,a.cur_row,1,3)),a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Total Mortgage","=B"+(n+2).toString()+"*B"+(a.cur_row-1).toString(),"=C"+(n+2).toString()+"*C"+(a.cur_row-1).toString()]]}),a.requests.push(t.formatcurrency(a.cur_row-1,a.cur_row,1,3)),a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Monthly Payments","=(B"+(a.cur_row-1).toString()+"*B"+(n+3).toString()+")/12","=(C"+(a.cur_row-1).toString()+"*C"+(n+3).toString()+")/12"]]}),a.requests.push(t.formatcurrency(a.cur_row-1,a.cur_row,1,3)),a.misc_data.monthly_payments_row=a.cur_row,a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Deposit","=B"+(n+2).toString()+"-B"+(a.cur_row-2).toString(),"=C"+(n+2).toString()+"-C"+(a.cur_row-2).toString()]]}),a.requests.push(t.formatcurrency(a.cur_row-1,a.cur_row,1,3)),a.misc_data.deposit_row=a.cur_row,a.cur_row=a.cur_row+1,u.push({range:q+"!A"+a.cur_row.toString()+":C"+a.cur_row.toString(),values:[["Refurb Duration Months",r.serialized_data.refurbcost.refurbtimerange.max,r.serialized_data.refurbcost.refurbtimerange.min]]}),a.requests.push(t.formatnumbermisc(a.cur_row-1,a.cur_row,1,3,"0")),a.misc_data.refurb_duration_row=a.cur_row,a.requests.push(t.makeboldandvaligntop(n,a.cur_row,0,1)),a.cur_row=a.cur_row+1,a.value_requests.push(u)},start_details:function(a){return[["Deposit","=B"+a.misc_data.deposit_row.toString(),"=C"+a.misc_data.deposit_row.toString()],["Mortgage Arangement",r.serialized_data.finance.mortgage.arrangementfee,r.serialized_data.finance.mortgage.arrangementfee]]},end_details:function(a){return[["Mortgage Payments","=B"+a.misc_data.monthly_payments_row.toString()+"*B"+a.misc_data.refurb_duration_row.toString(),"=C"+a.misc_data.monthly_payments_row.toString()+"*C"+a.misc_data.refurb_duration_row.toString()],["(During refurbishment)","",""]]}}}function Zs(e,r,s){return{name:"Buying with a Bridge",pre_stage:function(a){},start_details:function(a){return[["Purchase Price",r.serialized_data.purchaseprice.purchaserangevalue.max,r.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(a){return[["Bridge Costs",r.finance_bridgecost.worst,r.finance_bridgecost.best],[vt,r.finance_bridgeamount.worst*-1,r.finance_bridgeamount.best*-1]]}}}function xs(e,r,s){return r.serialized_data.finance.mortgage.usemortgage?Xs(e,r):r.serialized_data.finance.bridge.usebridge?Zs(e,r):Js(e,r)}function eo(e,r,s){const a=be.get_sheet_utils(s[q]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};t.requests.push(a.adjustcolumnwidth(0,170)),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",r.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",r.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:q+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[r.serialized_data.dealbasicinfo.postcode]]}),t.requests.push(a.makeboldandvaligntop(0,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const u=xs(e,r);t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[u.name]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),u.pre_stage(t,a),t.cur_row=t.cur_row+1,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["","Worst","Best"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,1,3));const n=t.cur_row;let l=u.start_details(t);l.push(["Refurbishment",r.refurb_cost_total.max,r.refurb_cost_total.min]),l.push(["Stamp Duty",r.stampduty_total.max,r.stampduty_total.min]),r.othercosts_items_detail.forEach(function(_){l.push([_.name,-1*_.worst,-1*_.best])}),r.caculated_loan_details.forEach(function(_){l.push([_.name,_.amount*-1,_.amount*-1]),l.push([_.name+" interest",_.interest,_.interest])}),l=l.concat(u.end_details(t));let m={};l.forEach(function(_){t.cur_row=t.cur_row+1,m[_[0]]=t.cur_row,t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[[_[0],_[1],_[2]]]}),_[0]==="(During refurbishment)"?t.requests.push(a.makeitalicandvaligntop(t.cur_row-1,t.cur_row,0,1)):t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1))}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const p=t.cur_row;return t.value_requests.push({range:q+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Total Money needed","=SUM(B"+(n+1).toString()+":B"+(t.cur_row-1).toString()+")","=SUM(C"+(n+1).toString()+":C"+(t.cur_row-1).toString()+")"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,3)),t.requests.push(a.formatcurrency(n,t.cur_row,1,3)),r.serialized_data.finance.bridge.usebridge&&r.serialized_data.refinance.refinance_userefinance&&to(t,a,r,p,m),{value_requests:t.value_requests,requests:t.requests}}function to(e,r,s,a,t){const u=t[vt];e.cur_row=e.cur_row+1,e.cur_row=e.cur_row+1,e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Refinance to exit bridge"]]}),e.requests.push(r.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,1)),e.cur_row=e.cur_row+1;const n=e.cur_row;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["GDV",s.gdv_total.min,s.gdv_total.max]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const l=e.cur_row;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance LTV",s.serialized_data.refinance.refinance_userefinance_ltv.min/100,s.serialized_data.refinance.refinance_userefinance_ltv.max/100]]}),e.requests.push(r.formatpercentage(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1,e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance Rate",s.serialized_data.refinance.refinance_userefinance_rate.min/100,s.serialized_data.refinance.refinance_userefinance_rate.max/100]]}),e.requests.push(r.formatpercentage(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const m=e.cur_row;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance mortgage total","=B"+n.toString()+"*B"+l.toString(),"=C"+n.toString()+"*C"+l.toString()]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const p=e.cur_row;let _=p;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Pay back bridge","=B"+u.toString()+" * -1","=C"+u.toString()+" * -1"]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),s.caculated_loan_details.forEach(function(y){e.cur_row=e.cur_row+1,_=e.cur_row,e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Pay back "+y.name,y.amount,y.amount]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3))}),e.cur_row=e.cur_row+1;const B=e.cur_row;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Remaining","=B"+m.toString()+"-sum(B"+p.toString()+":B"+_.toString()+")","=C"+m.toString()+"-sum(C"+p.toString()+":C"+_.toString()+")"]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const R=e.cur_row;e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Original Money in","=B"+a.toString(),"=C"+a.toString()]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.requests.push(r.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,3)),e.cur_row=e.cur_row+1,e.value_requests.push({range:q+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Left in","=B"+R.toString()+"-B"+B.toString(),"=C"+R.toString()+"-C"+B.toString()]]}),e.requests.push(r.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.requests.push(r.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,3))}var ro={sheet_name:q,get_sheet_values:eo};const te="GDV Comparables";function ao(e,r,s){const a=be.get_sheet_utils(s[te]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const u=[120,246,100,74,100,100,47,100,100,100,145,100,198];let n=0;for(;n<u.length;)t.requests.push(a.adjustcolumnwidth(n,u[n])),n++;t.cur_row=t.cur_row+1,t.value_requests.push({range:te+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:te+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",r.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:te+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",r.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:te+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[r.serialized_data.dealbasicinfo.postcode]]}),t.cur_row=t.cur_row+1,["EPC Floorspace:","Type:","Condition:","Sold History"].forEach(function(B){t.value_requests.push({range:te+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[B]]}),t.cur_row=t.cur_row+1}),t.requests.push(a.makeboldandvaligntop(0,t.cur_row-1,0,1)),t.cur_row=t.cur_row+6,t.value_requests.push({range:te+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["Source","Address","Type","Price type","Amount","Date","SQM","price per sqm","Condition","Value of ours","Distance","Place","Notes"]]}),t.cur_row=t.cur_row+1,t.requests.push(a.makeboldandvaligntop(t.cur_row-2,t.cur_row-1,0,13));const m=t.cur_row;let p=0;for(;p<15;)t.value_requests.push({range:te+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["","","","SOLD","","","","=E"+t.cur_row.toString()+"/G"+t.cur_row.toString(),"","=H"+t.cur_row.toString()+"*$B$4","","",""]]}),t.cur_row=t.cur_row+1,p++;const _=t.cur_row;return t.requests.push(a.formatcurrency(m-1,_-1,4,5)),t.requests.push(a.formatcurrency(m-1,_-1,7,8)),t.requests.push(a.formatcurrency(m-1,_-1,9,10)),{value_requests:t.value_requests,requests:t.requests}}var so={sheet_name:te,get_sheet_values:ao};function oo(e,r,s,a,t){e.cur_row=e.cur_row+1,e.value_requests.push({range:r+"!A"+e.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:r+"!A"+e.cur_row.toString(),values:[[t]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:r+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Patch:",s.patch.name]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:r+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Address:",s.serialized_data.dealbasicinfo.address]]}),e.requests.push(a.makeboldandvaligntop(0,e.cur_row,0,1)),e.cur_row=e.cur_row+1}var wt={header:oo};const P="HMO Monthly Profit Estimate";function no(e,r,s){const a=be.get_sheet_utils(s[P]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const u=[100,100,100,100,30];let n=0;for(;n<u.length;)t.requests.push(a.adjustcolumnwidth(n,u[n])),n++;wt.header(t,P,r,a,"Comparison of HMO income vs running costs"),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Caculation"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":F"+t.cur_row.toString(),values:[["Option 1","","","","","Option 2"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Room","Num","Monthly Rate","Total","","Room","Num","Monthly Rate","Total"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9));const l=[["Ensuite","-1","550"],["Non-ensuite","-1","500"],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]],m=t.cur_row;l.forEach(function(y){t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[[y[0],y[1],y[2],"=B"+t.cur_row.toString()+"*C"+t.cur_row.toString(),"",y[0],y[1],y[2],"=G"+t.cur_row.toString()+"*H"+t.cur_row.toString()]]})}),t.cur_row=t.cur_row+1;const p=t.cur_row;t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Total","=sum(B"+(m+1).toString()+":B"+(t.cur_row-1).toString()+")","","=sum(D"+(m+1).toString()+":D"+(t.cur_row-1).toString()+")","","Total","=sum(G"+(m+1).toString()+":G"+(t.cur_row-1).toString()+")","","=sum(I"+(m+1).toString()+":I"+(t.cur_row-1).toString()+")"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9)),t.requests.push(a.formatcurrency(m-1,t.cur_row,2,4)),t.requests.push(a.formatcurrency(m-1,t.cur_row,7,9)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const _=t.cur_row;t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Used Figure","=D"+p.toString(),"(Select the total of the option above to use for the profit caculation)"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Costs"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const B=t.cur_row;t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Management","=B"+_.toString()+"*0.15","(assumed 15%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Maintainance","=B"+_.toString()+"*0.1","(10%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["Council tax","=1370.41/12","TODO VERIFY","(Put Band and link to local authority council tax page here as a note)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Gas","155","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Electric","120","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Water","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Internet","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Building insurance","","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company insurance",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company account",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["TV Licence","14.13","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["HMO Licence","16.25","TODO VERIFY","(Place link to council HMO licencing page here)"]]}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const R=t.cur_row;return t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Spend","=sum(B"+B.toString()+":B"+(t.cur_row-1).toString()+")"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:P+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Profit","=B"+_.toString()+"-B"+R.toString()]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.requests.push(a.formatcurrency(B-1,t.cur_row,1,2)),{value_requests:t.value_requests,requests:t.requests}}var io={sheet_name:P,get_sheet_values:no};const ue="HMO Room Sizes";function lo(e,r,s){const a=be.get_sheet_utils(s[ue]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const u=[130,100,58,58,100,200,200];let n=0;for(;n<u.length;)t.requests.push(a.adjustcolumnwidth(n,u[n])),n++;wt.header(t,ue,r,a,"List of room sizes to check against licence standards"),t.cur_row=t.cur_row+1,t.value_requests.push({range:ue+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Total area (sqm)"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const l=t.cur_row;return t.value_requests.push({range:ue+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["Level","Room on plan","x","y","sqm","Reconfig Use","Notes"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),[["Ground","Kitchen","-1","-1"],["Ground","Dinning Room","-1","-1"],["Bedroom","Dinning Room","-1","-1"],["","","2",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""]].forEach(function(p){t.cur_row=t.cur_row+1,t.value_requests.push({range:ue+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[[p[0],p[1],p[2],p[3],"=C"+t.cur_row.toString()+"*D"+t.cur_row.toString(),"",""]]})}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:ue+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["","","","Total","=sum(E"+(l+1).toString()+":E"+(t.cur_row-1).toString()+")","",""]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),{value_requests:t.value_requests,requests:t.requests}}var uo={sheet_name:ue,get_sheet_values:lo};const Y="Refurb Cost",it=["Clear out (Skips)?","Windows?","Electric?","Boiler?","Fire Doors?","Fire alarm system?","Roof?","Decorate?","EPC Works?"],co=25;function _o(e,r,s){const a=be.get_sheet_utils(s[Y]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};t.requests.push(a.adjustcolumnwidth(0,115)),t.requests.push(a.adjustcolumnwidth(1,149)),t.requests.push(a.adjustcolumnwidth(2,182)),t.requests.push(a.adjustcolumnwidth(3,110)),t.requests.push(a.adjustcolumnwidth(4,110)),t.cur_row=t.cur_row+1,t.value_requests.push({range:Y+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",r.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",r.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:Y+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[r.serialized_data.dealbasicinfo.postcode]]}),t.requests.push(a.makeboldandvaligntop(0,t.cur_row,0,1)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const u=t.cur_row;t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["Room","Item","Description","Labour","Materials"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,5));let n=0;for(;n<co;)t.cur_row=t.cur_row+1,n<it.length&&t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["",it[n],"","",""]]}),n++;t.cur_row=t.cur_row+1;const l=t.cur_row;t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","Total","=sum(D"+(u+1).toString()+":D"+(t.cur_row-1).toString()+")","=sum(E"+(u+1).toString()+":E"+(t.cur_row-1).toString()+")"]]}),t.requests.push(a.makeboldandvaligntop(t.cur_row-1,t.cur_row,2,5)),t.requests.push(a.formatcurrency(u,t.cur_row,3,5)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const m=t.cur_row;t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Gross Total","=sum(D"+l.toString()+":E"+l.toString()+")"]]}),t.cur_row=t.cur_row+1;const p=t.cur_row;return t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Contingency","=E"+m.toString()+"*0.1"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","VAT","=sum(E"+m.toString()+":E"+p.toString()+")*0.2"]]}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:Y+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Net Total","=sum(E"+m.toString()+":E"+(t.cur_row-22).toString()+")"]]}),t.requests.push(a.makeboldandvaligntopandsetfontsize(t.cur_row-1,t.cur_row,3,5,13)),t.requests.push(a.formatcurrency(m,t.cur_row,4,5)),{value_requests:t.value_requests,requests:t.requests}}var ho={sheet_name:Y,get_sheet_values:_o};const fo=E({name:"SaveToGoogleSheetCompoennt",emits:["apiaddweblink","activity_log"],props:["serialized_data","patch","refurb_cost_total","stampduty_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost","finance_bridgeamount","gdv_total"],setup(){return{backend_connection_store:we()}},data(){return{}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave}},methods:{click_export(){Le.show();const e=google.accounts.oauth2.initTokenClient({client_id:this.$rjmgclientid,scope:this.$rjmgscopes,callback:this.execute_export});gapi.client.getToken()===null?e.requestAccessToken({prompt:"consent"}):e.requestAccessToken({prompt:""})},execute_export(){try{gapi.client.sheets.spreadsheets.create({properties:{title:"evernetproperties.com-"+this.patch.name+"-"+this.serialized_data.dealbasicinfo.address}}).then(e=>{this.spreadsheets_batchupdate(e.result)})}catch(e){this.sheet_api_error_handler(e);return}},spreadsheets_batchupdate(e){let r={Main:e.sheets[0].properties.sheetId},s=[];s.push({updateSheetProperties:{properties:{sheetId:e.sheets[0].properties.sheetId,title:"Main"},fields:"title"}});let a=[ro,so];typeof this.serialized_data.vision.strategy!="undefined"&&this.serialized_data.vision.strategy.hmo&&(a.push(io),a.push(uo)),a.push(ho);let t=0;for(;t<a.length;)s.push({addSheet:{properties:{title:a[t].sheet_name}}}),t++;s=s.concat(nt.get_sheet_main(e,this,r));const u={requests:s};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:u}).then(n=>{const l=n.result;console.log("spreadsheet Batch Update result",n.result.replies),n.result.replies.forEach(function(m){if(typeof m.addSheet!="undefined"){let p=0;for(;p<a.length;)m.addSheet.properties.title===a[p].sheet_name&&(r[a[p].sheet_name]=m.addSheet.properties.sheetId),p++}}),this.spreadsheets_batchupdate_after_all_sheets_added(e,r,a)})}catch(n){this.sheet_api_error_handler(n);return}},spreadsheets_batchupdate_after_all_sheets_added(e,r,s){let a=[],t=[];t=t.concat(nt.get_sheet_main_values(e,this,r));let u=0;for(;u<s.length;){let l=s[u].get_sheet_values(e,this,r);a=a.concat(l.requests),t=t.concat(l.value_requests),u++}if(a.length===0){console.log("No requests required"),this.spreadsheets_values_batchupdate(e,r,t);return}const n={requests:a};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:n}).then(l=>{const m=l.result;console.log("spreadsheet Batch Update after all sheets added result",l.result.replies),this.spreadsheets_values_batchupdate(e,r,t)})}catch(l){this.sheet_api_error_handler(l);return}},spreadsheets_values_batchupdate(e,r,s){const a={data:s,valueInputOption:"USER_ENTERED"};try{gapi.client.sheets.spreadsheets.values.batchUpdate({spreadsheetId:e.spreadsheetId,resource:a}).then(t=>{const u=t.result;console.log(`${u.totalUpdatedCells} cells updated.`),this.sheet_final_complete(e)})}catch(t){this.sheet_api_error_handler(t);return}},open_sheet(e){window.open(e.spreadsheetUrl,"_blank").focus()},sheet_api_error_handler(e){Le.hide(),console.log("Error-"+e.message),J.create({color:"negative",message:"Export to google sheets failed "+e.message,timeout:2e3})},sheet_final_complete(e){this.$emit("apiaddweblink",{url:e.spreadsheetUrl,displaytext:"My Calc"});const r={type:"admin",text:"Generated google sheet",head_notes:"Calculation"};this.$emit("activity_log",r),this.open_sheet(e),Le.hide()}}}),mo=o("div",{class:"text-h6"},"Export to Spreadsheet",-1),go=o("div",{class:"text-subtitle2"},"Export figures into a google docs spreadsheet.",-1),po=o("div",{class:"textdiv"}," This feature will generate a spreadsheet containing all the current values for this project and output it to a document in your google drive. ",-1);function vo(e,r,s,a,t,u){return e.security_role_cansave?(f(),V(X,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[mo,go]),_:1}),i(j,null,{default:c(()=>[o("div",null,[i(I,{color:"primary",icon:"save",label:"Export to google sheets",onClick:e.click_export},null,8,["onClick"])]),po]),_:1})]),_:1})):A("",!0)}var wo=L(fo,[["render",vo]]),lt=Be({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:r}){const s=D(()=>e.sent===!0?"sent":"received"),a=D(()=>`q-message-text-content q-message-text-content--${s.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),t=D(()=>`q-message-text q-message-text--${s.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),u=D(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),n=D(()=>e.size!==void 0?`col-${e.size}`:""),l=D(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function m(_){return r.stamp!==void 0?[_,C("div",{class:"q-message-stamp"},r.stamp())]:e.stamp?[_,C("div",{class:"q-message-stamp",[l.value.stamp]:e.stamp})]:[_]}function p(_,B){const R=B===!0?_.length>1?y=>y:y=>C("div",[y]):y=>C("div",{[l.value.msg]:y});return _.map((y,N)=>C("div",{key:N,class:t.value},[C("div",{class:a.value},m(R(y)))]))}return()=>{const _=[];r.avatar!==void 0?_.push(r.avatar()):e.avatar!==void 0&&_.push(C("img",{class:`q-message-avatar q-message-avatar--${s.value}`,src:e.avatar,"aria-hidden":"true"}));const B=[];r.name!==void 0?B.push(C("div",{class:`q-message-name q-message-name--${s.value}`},r.name())):e.name!==void 0&&B.push(C("div",{class:`q-message-name q-message-name--${s.value}`,[l.value.name]:e.name})),r.default!==void 0?B.push(p(Ht(r.default()),!0)):e.text!==void 0&&B.push(p(e.text)),_.push(C("div",{class:n.value},B));const R=[];return r.label!==void 0?R.push(C("div",{class:"q-message-label"},r.label())):e.label!==void 0&&R.push(C("div",{class:"q-message-label",[l.value.label]:e.label})),R.push(C("div",{class:u.value},_)),C("div",{class:`q-message q-message-${s.value}`},R)}}});function ut(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16))}const bo=E({name:"BrrCalcActivityJob",emits:["projectchanged"],data(){return{activity_log:[],emit_project_change_notification:!0}},computed:{serializer_card_data(){return this.activity_log},activity_log_display(){let e=[];const r={book_viewing:{sent:!0,name:"Viewing booked"},hold_viewing:{sent:!1,name:"Viewing"},call_agent:{sent:!0,name:"Call to agent"},research_call:{sent:!0,name:"Research Call"},wf_move:{sent:!1,name:"Workflow"},admin:{sent:!1,name:"Admin action"},offer_made:{sent:!0,name:"Offer made"},offer_rejected:{sent:!1,name:"Offer rejected"},offer_accepted:{sent:!1,name:"Offer accepted"}};let s="";return this.activity_log.forEach(function(a){const t=new Date(a.timestamp),u=t.toDateString(),n=t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});s!==u&&(s=u,e=e.concat([{id:ut(),label:s}]));let l=r[a.type].name;typeof a.head_notes!="undefined"&&(l=l+" ("+a.head_notes+")"),e=e.concat({id:a.t,label:void 0,name:l,text:a.text,sent:r[a.type].sent,stamp:n,avatar:"activity_log_icon_"+a.type+".png"})}),e}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","ActivityLog:serializer")}},methods:{log_activity(e){var r=this.activity_log.filter(function(s){return!0});r.push({id:ut(),type:e.type,timestamp:new Date().toISOString(),text:e.text,head_notes:e.head_notes}),this.activity_log=r,this.$emit("projectchanged","ActivityLog:log_activity")},serializer_load_data(e){this.emit_project_change_notification=!1,this.activity_log=e;const r=this;setTimeout(function(){r.emit_project_change_notification=!0},50)}}}),yo=o("div",{class:"text-h6"},"Activity Log",-1),So={style:{width:"100%","max-width":"400px"}},ko={key:0},$o={key:1},Co=["src"];function qo(e,r,s,a,t,u){return f(),V(X,{inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[yo,o("div",So,[(f(!0),b(ce,null,de(e.activity_log_display,n=>(f(),b("div",{key:n.id},[typeof n.label=="string"?(f(),b("div",ko,[i(lt,{label:n.label},null,8,["label"])])):A("",!0),typeof n.label=="undefined"?(f(),b("div",$o,[i(lt,{name:n.name,text:[n.text],sent:n.sent,stamp:n.stamp,avatar:n.avatar},{avatar:c(()=>[o("img",{class:"q-message-avatar q-message-avatar--sent",alt:"Avatar",src:"/"+n.avatar},null,8,Co)]),_:2},1032,["name","text","sent","stamp","avatar"])])):A("",!0)]))),128))])]),_:1})]),_:1})}var To=L(bo,[["render",qo]]);const Ao=E({name:"BrrCalcTodos",components:{TodoItem:er},setup(){return{backend_connection_store:we()}},data(){return{todos:[]}},computed:{todo_groups(){let e={"":!0};return this.todos.forEach(function(r){e[r.group]=!0}),e},done_todos(){return this.todos.filter(function(e){return e.done===!0})}},methods:{due_todos(e){return this.todos.filter(function(r){return r.group===e&&r.done===!1&&r.due===!0})},notdone_todos(e){return this.todos.filter(function(r){return r.group===e&&r.done===!1&&r.due===!1})},serializer_load_data(e){this.todos=e},add_single_todo(e){this.todos.push(e)},update_todo_item(e){const r=this;r.todos=r.todos.map(function(s){return s.id==e.id&&(s=e),s})}}}),Bo={class:"text-h6 todos-card-head"},Ro={style:{width:"100%","max-width":"400px"}},Po={key:0},Io={key:0,class:"todos-grouptitle"},jo=o("div",null,"Completed Items",-1);function Vo(e,r,s,a,t,u){const n=$("TodoItem");return f(),b("div",null,[i(X,{inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:c(()=>[i(j,null,{default:c(()=>[o("div",Bo,[i(pe,{name:"rule",size:"30px"}),k(" Todo Items")]),o("div",Ro,[(f(!0),b(ce,null,de(Object.keys(e.todo_groups),l=>(f(),b("div",{key:l},[e.due_todos(l).length+e.notdone_todos(l).length>0?(f(),b("div",Po,[l!==""?(f(),b("div",Io,h(l),1)):A("",!0),o("div",null,[(f(!0),b(ce,null,de(e.due_todos(l),m=>(f(),b("div",{key:m.id},[i(n,{todo:m,onUpdate_todo_item:e.update_todo_item},null,8,["todo","onUpdate_todo_item"])]))),128)),(f(!0),b(ce,null,de(e.notdone_todos(l),m=>(f(),b("div",{key:m.id},[i(n,{todo:m,onUpdate_todo_item:e.update_todo_item},null,8,["todo","onUpdate_todo_item"])]))),128))])])):A("",!0)]))),128)),o("div",null,[jo,(f(!0),b(ce,null,de(e.done_todos,l=>(f(),b("div",{key:l.id},[i(n,{todo:l,onUpdate_todo_item:e.update_todo_item},null,8,["todo","onUpdate_todo_item"])]))),128))])])]),_:1})]),_:1})])}var Do=L(Ao,[["render",Vo]]);function ct(){return{workflow_used_id:Te.default_workflow_id,current_stage:Te.workflows[Te.default_workflow_id].initial_stage}}const Mo=E({name:"BrrCalcWorkflow",emits:["projectchanged","activity_log"],data(){return{workflow_data:ct(),emit_project_change_notification:!0}},computed:{serializer_card_data(){return this.workflow_data},workflow_model(){return Te.workflows[this.workflow_data.workflow_used_id]}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","Workflow")}},methods:{progress(e){const r={type:"wf_move",text:"From "+this.workflow_model.stages[this.workflow_data.current_stage].name+" to "+this.workflow_model.stages[e].name,head_notes:"Progressed through workflow"};this.workflow_data.current_stage=e,this.$emit("activity_log",r)},serializer_load_data(e){this.emit_project_change_notification=!1,typeof e.workflow_used_id=="undefined"?this.workflow_data=ct():this.workflow_data=e;const r=this;setTimeout(function(){r.emit_project_change_notification=!0},50)}}}),zo={class:"text-h6"},Eo={class:"col"},Lo={key:0},Oo={key:0},Fo={key:1,class:"resetbuttondiv"};function Uo(e,r,s,a,t,u){return f(),V(X,{inline:"",class:"q-ma-sm card-style"},{default:c(()=>[i(j,null,{default:c(()=>[o("div",zo,"Workflow - "+h(e.workflow_model.name),1),o("div",Eo,[o("div",null,[o("h3",null,"Stage: "+h(e.workflow_model.stages[e.workflow_data.current_stage].name),1)]),typeof e.workflow_model.stages[e.workflow_data.current_stage].progression!="undefined"?(f(),b("table",Lo,[o("tbody",null,[o("tr",null,[o("td",null,[(f(!0),b(ce,null,de(e.workflow_model.stages[e.workflow_data.current_stage].progression.success,n=>(f(),b("div",{key:n.next_stage},[i(I,{color:"positive",icon:"donut_large",label:"Progress to next stage ("+e.workflow_model.stages[n.next_stage].name+")",onClick:l=>e.progress(n.next_stage)},null,8,["label","onClick"])]))),128))]),typeof e.workflow_model.stages[e.workflow_data.current_stage].progression.failed!="undefined"?(f(),b("td",Oo,[i(I,{color:"negative",icon:"directions_off",label:e.workflow_model.stages[e.workflow_model.stages[e.workflow_data.current_stage].progression.failed].name,onClick:r[0]||(r[0]=n=>e.progress(e.workflow_model.stages[e.workflow_data.current_stage].progression.failed))},null,8,["label"])])):A("",!0)])])])):A("",!0),e.workflow_data.current_stage!==e.workflow_model.initial_stage?(f(),b("div",Fo,[i(I,{icon:"donut_large",label:"Reset workflow",onClick:r[1]||(r[1]=n=>e.progress(e.workflow_model.initial_stage))})])):A("",!0)])]),_:1})]),_:1})}var No=L(Mo,[["render",Uo]]);const Wo=E({name:"ProjectSerializer",emits:["saveprojectcomplete"],setup(){return{backend_connection_store:we()}},data(){return{loaded_project_id:void 0,proj_summary_data:{metadata:void 0,timestamp_first_entered:void 0}}},methods:{serializer_load_data(e){this.loaded_project_id=e.id,this.proj_summary_data.timestamp_first_entered=e.timestamp_first_entered,this.proj_summary_data.metadata=e.metadata},save_project({dict_of_card_info:e,activity_log:r,workflow:s}){const a={};for(const l in Object.keys(e)){const m=Object.keys(e)[l];a[m]=JSON.parse(JSON.stringify(e[m]))}const t={user_id:this.backend_connection_store.user_profile.id,patch_id:e.dealbasicinfo.patch_id,timestamp_first_entered:this.proj_summary_data.timestamp_first_entered,initial_phase:{total_money_in:0,start_value:0,end_value:0,flip_roi:0},reoccurring_phase:[],location:{},workflow:s,activity_log:r,sub_section_details:a,tags:[],risks:[]};typeof this.loaded_project_id!="undefined"?(t.id=this.loaded_project_id,t.metadata=this.proj_summary_data.metadata):t.timestamp_first_entered=new Date().toISOString();const u=this,n={ok:u.save_api_call_success,error:u.save_api_call_fail};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects",method:"POST",data:t,callback:n})},save_api_call_success(e){this.$emit("saveprojectcomplete",{success:!0,response:e}),this.serializer_load_data(e.data),J.create({color:"positive",message:"Project Saved",timeout:2e3})},save_api_call_fail(e){this.$emit("saveprojectcomplete",{success:!1,response:e}),J.create({color:"negative",message:"Save failed - "+e.response.data.message,timeout:2e3})}},mounted(){}});function Go(e,r,s,a,t,u){return f(),b("div")}var Qo=L(Wo,[["render",Go]]);const Ho=E({name:"CalcBrrToFlip",components:{GdvCard:rr,PurchasePrice:ar,RefurbCost:sr,StampDuty:or,OtherCosts:nr,DealSummary:da,Finance:ir,Vision:Zr,DealRating:Ps,Refinance:oa,DealBasicInfo:Qs,ProjectSerializer:Qo,SaveToGoogleSheet:wo,ActivityLog:To,BrrToolbar:Qr,Workflow:No,FlipDealRating:lr,Todos:Do},setup(){return{backend_connection_store:we()}},data(){return{tab:"main",isMounted:!1,purchaserange:{min:18e4,max:19e4},loaded_project_id:""}},computed:{is_saved_project_with_id(){return this.loaded_project_id!==""},ever_saved(){return this.isMounted?this.security_role_cansave?this.$refs.BrrToolbar.ever_saved:(console.log("WARNING ever_saved checked when cansave is false"),!1):!1},reason_project_not_savable(){return this.isMounted?this.$refs.DealBasicInfo.reason_project_not_savable:""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},is_valid_input(){return this.isMounted?!(!this.$refs.PurchasePrice.isValid||!this.$refs.GdvCard.isValid):!0},deal_summary_final_bal(){return this.isMounted?this.$refs.DealSummary.final_bal:{best:0,worst:0}},finance_refinance(){return this.isMounted?this.$refs.Refinance.get_refinance:{userefinance:!1,ltv:{min:75,max:75}}},caculated_loan_details(){return this.isMounted?this.$refs.Finance.caculated_loan_details:[]},finance_bridgecost(){return this.isMounted?this.$refs.Finance.bridgecost:{best:0,worst:0}},finance_bridgeamount(){return this.isMounted?this.$refs.Finance.bridgeamount:{best:0,worst:0}},finance_totalmoneyneeded(){return this.isMounted?this.$refs.Finance.totalmoneyneeded:{best:0,worst:0}},finance_in_items(){return this.isMounted?this.$refs.Finance.finance_in_items:[]},finance_in_items_without_cash(){return this.isMounted?this.$refs.Finance.finance_in_items_without_cash:[]},finance_during_items(){return this.isMounted?this.$refs.Finance.finance_during_items:[]},finance_out_items(){return this.isMounted?this.$refs.Finance.finance_out_items:[]},refinance_out_items(){return this.isMounted?this.$refs.Refinance.refinance_out_items:[]},purchase_items(){return this.isMounted?this.$refs.PurchasePrice.purchase_items:[]},stampduty_items(){return this.isMounted?this.$refs.StampDuty.stampduty_items:[]},othercosts_items(){return this.isMounted?this.$refs.OtherCosts.othercosts_items:[]},othercosts_items_detail(){return this.isMounted?this.$refs.OtherCosts.othercosts_items_detail:[]},refurb_cost_items(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_items:[]},refurb_cost_total(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_total:[]},refurbmonths(){return this.isMounted?this.$refs.RefurbCost.refurbmonths:[]},stampduty_total(){return this.isMounted?this.$refs.StampDuty.stampduty:[]},othercosts_total(){return this.isMounted?this.$refs.OtherCosts.total:[]},gdv_total(){return this.isMounted?this.$refs.GdvCard.total:[]},serialized_data(){return this.security_role_cansave?this.isMounted?{dealbasicinfo:this.$refs.DealBasicInfo.serializer_card_data,vision:this.$refs.Vision.serializer_card_data,gdvcard:this.$refs.GdvCard.serializer_card_data,purchaseprice:this.$refs.PurchasePrice.serializer_card_data,refurbcost:this.$refs.RefurbCost.serializer_card_data,stampduty:this.$refs.StampDuty.serializer_card_data,othercosts:this.$refs.OtherCosts.serializer_card_data,finance:this.$refs.Finance.serializer_card_data,refinance:this.$refs.Refinance.serializer_card_data}:{}:(console.log("WARNING serialized_data checked when cansave is false"),{})},patch(){return this.isMounted?this.security_role_cansave?this.$refs.DealBasicInfo.patch:(console.log("WARNING patch method called when cansave is false"),{id:"notset",name:"Not Set"}):{id:"notset",name:"Not Set"}}},methods:{navigate_away(e){const r=this;if(!this.$refs.BrrToolbar.is_project_changed){this.$router.push(e.dest);return}this.$refs.BrrToolbar.click_save_btn(),setTimeout(function(){r.navigate_away(e)},100)},createtodo(e){const r=this,s={ok:function(a){r.$refs.todos.add_single_todo(a.data.todo),J.create({color:"bg-grey-2",message:"Todo added",timeout:2e3,color:"positive"})},error:function(a){J.create({color:"bg-grey-2",message:a.message,timeout:2e3,color:"negative"})}};r.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+r.loaded_project_id+"/todos",method:"POST",data:e,callback:s})},apiaddweblink(e){return this.$refs.DealBasicInfo.apiaddweblink(e)},activity_log(e){if(!this.isMounted){console.log("ERROR - trying to log activity unmounted",e);return}this.$refs.ActivityLog.log_activity(e)},projectchanged(e){if(console.log("BrrCalc page recieved project changed from ",e),!this.security_role_cansave)return!1;if(!this.isMounted){console.log("WARNING = projectchanged called when mounted is false");return}if(typeof this.$refs.BrrToolbar=="undefined")return console.log("WARNING = projectchanged called when BrrToolbar is undefined"),!1;this.$refs.BrrToolbar.set_changed_true()},save_project(){this.$refs.ProjectSerializer.save_project({dict_of_card_info:this.serialized_data,activity_log:this.$refs.ActivityLog.serializer_card_data,workflow:this.$refs.Workflow.serializer_card_data})},load_project_into_cards(e){this.$refs.ProjectSerializer.serializer_load_data(e),this.$refs.DealBasicInfo.serializer_load_data(e.sub_section_details.dealbasicinfo),typeof e.sub_section_details.vision!="undefined"&&this.$refs.Vision.serializer_load_data(e.sub_section_details.vision),typeof e.sub_section_details.gdvcard!="undefined"&&this.$refs.GdvCard.serializer_load_data(e.sub_section_details.gdvcard),typeof e.sub_section_details.purchaseprice!="undefined"&&this.$refs.PurchasePrice.serializer_load_data(e.sub_section_details.purchaseprice),typeof e.sub_section_details.refurbcost!="undefined"&&this.$refs.RefurbCost.serializer_load_data(e.sub_section_details.refurbcost),typeof e.sub_section_details.stampduty!="undefined"&&this.$refs.StampDuty.serializer_load_data(e.sub_section_details.stampduty),typeof e.sub_section_details.othercosts!="undefined"&&this.$refs.OtherCosts.serializer_load_data(e.sub_section_details.othercosts),typeof e.sub_section_details.finance!="undefined"&&this.$refs.Finance.serializer_load_data(e.sub_section_details.finance),typeof e.sub_section_details.refinance!="undefined"&&this.$refs.Refinance.serializer_load_data(e.sub_section_details.refinance),this.$refs.ActivityLog.serializer_load_data(e.activity_log),this.$refs.Workflow.serializer_load_data(e.workflow),this.$refs.BrrToolbar.serializer_load_data({}),this.$refs.todos.serializer_load_data(e.todos)},save_project_complete({success:e,response:r}){this.loaded_project_id=r.data.id,this.$refs.BrrToolbar.save_project_complete_notification({success:e,response:r})},load_project_api_fail(e){J.create({color:"bg-grey-2",message:"Error loading project "+e,timeout:2e3,color:"negative"}),this.load_complete()},load_project_api_success(e){this.loaded_project_id=e.data.id,this.load_project_into_cards(e.data),J.create({color:"bg-grey-2",message:"Project Loaded",timeout:2e3,color:"positive"}),this.load_complete()},load_complete(){const e=this;setTimeout(function(){e.isMounted=!0},105)},call_load_api(){const e=this,r={ok:e.load_project_api_success,error:e.load_project_api_fail};e.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+e.$route.query.projectid,method:"GET",data:void 0,callback:r})}},mounted(){const e=this;if(typeof e.$route.query.projectid=="undefined"){if(e.load_complete(),typeof e.$route.query.patchid!="undefined"){if(!e.security_role_cansave)return;this.$refs.DealBasicInfo.select_patch_by_id(e.$route.query.patchid)}return}if(e.security_role_cansave){e.call_load_api();return}setTimeout(function(){e.call_load_api()},1e3)}}),Ko={class:"main-page fit col wrap justify-center items-center content-center"},Yo=o("h1",null,"Buy Refurbish Rent Refinance Calculator",-1),Jo={class:"row"},Xo={class:"row"};function Zo(e,r,s,a,t,u){const n=$("BrrToolbar"),l=$("DealBasicInfo"),m=$("Vision"),p=$("GdvCard"),_=$("PurchasePrice"),B=$("RefurbCost"),R=$("StampDuty"),y=$("OtherCosts"),N=$("Finance"),x=$("Refinance"),ne=$("DealSummary"),re=$("FlipDealRating"),fe=$("DealRating"),w=$("ProjectSerializer"),F=$("Workflow"),W=$("Todos"),O=$("ActivityLog"),K=$("SaveToGoogleSheet");return f(),V(Zt,{class:"flex"},{default:c(()=>[o("div",Ko,[Yo,e.security_role_cansave?(f(),V(n,{key:0,ref:"BrrToolbar",reason_project_not_savable:e.reason_project_not_savable,is_saved_project_with_id:e.is_saved_project_with_id,onActivity_log:e.activity_log,onSaveproject:e.save_project,onCreatetodo:e.createtodo},null,8,["reason_project_not_savable","is_saved_project_with_id","onActivity_log","onSaveproject","onCreatetodo"])):A("",!0),e.security_role_cansave?(f(),V(vr,{key:1,modelValue:e.tab,"onUpdate:modelValue":r[0]||(r[0]=G=>e.tab=G),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[i(et,{name:"main",label:"Main"}),i(et,{name:"project",label:"Project"})]),_:1},8,["modelValue"])):A("",!0),_e(o("div",Jo,[e.security_role_cansave?(f(),V(l,{key:0,ref:"DealBasicInfo",ever_saved:e.ever_saved,onProjectchanged:e.projectchanged,onNavigate_away:e.navigate_away},null,8,["ever_saved","onProjectchanged","onNavigate_away"])):A("",!0),i(m,{ref:"Vision",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(p,{ref:"GdvCard",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(_,{ref:"PurchasePrice",purchaserange:e.purchaserange,"onUpdate:purchaserange":r[1]||(r[1]=G=>e.purchaserange=G),onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(B,{ref:"RefurbCost",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),i(R,{ref:"StampDuty",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(y,{ref:"OtherCosts",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),i(N,{ref:"Finance",purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurbmonths:e.refurbmonths,gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["purchaserange","refurb_cost_total","stampduty_total","othercosts_total","refurbmonths","gdv_total","onProjectchanged"]),i(x,{ref:"Refinance",gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["gdv_total","onProjectchanged"]),i(ne,{ref:"DealSummary",purchaserange:e.purchaserange,finance_in_items:e.finance_in_items,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,refinance_out_items:e.refinance_out_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items","finance_out_items","finance_during_items","refinance_out_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),i(re,{ref:"FlipDealRating",purchaserange:e.purchaserange,finance_in_items_without_cash:e.finance_in_items_without_cash,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items_without_cash","finance_out_items","finance_during_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),i(fe,{ref:"DealRating",purchaserange:e.purchaserange,finance_totalmoneyneeded:e.finance_totalmoneyneeded,deal_summary_final_bal:e.deal_summary_final_bal,finance_refinance:e.finance_refinance,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","stampduty_total","othercosts_total","refurb_cost_total","is_valid_input"]),e.security_role_cansave?(f(),V(w,{key:1,ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete},null,8,["onSaveprojectcomplete"])):A("",!0)],512),[[xe,e.tab==="main"]]),_e(o("div",Xo,[e.security_role_cansave?(f(),V(F,{key:0,ref:"Workflow",onProjectchanged:e.projectchanged,onActivity_log:e.activity_log},null,8,["onProjectchanged","onActivity_log"])):A("",!0),e.security_role_cansave?(f(),V(W,{key:1,ref:"todos"},null,512)):A("",!0),e.security_role_cansave?(f(),V(O,{key:2,ref:"ActivityLog",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"])):A("",!0),e.security_role_cansave?(f(),V(K,{key:3,ref:"SaveToGoogleSheet",serialized_data:e.serialized_data,patch:e.patch,stampduty_total:e.stampduty_total,refurb_cost_total:e.refurb_cost_total,othercosts_items_detail:e.othercosts_items_detail,caculated_loan_details:e.caculated_loan_details,finance_bridgecost:e.finance_bridgecost,finance_bridgeamount:e.finance_bridgeamount,gdv_total:e.gdv_total,onApiaddweblink:e.apiaddweblink,onActivity_log:e.activity_log},null,8,["serialized_data","patch","stampduty_total","refurb_cost_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost","finance_bridgeamount","gdv_total","onApiaddweblink","onActivity_log"])):A("",!0)],512),[[xe,e.tab==="project"]])])]),_:1})}var gn=L(Ho,[["render",Zo]]);export{gn as default};
