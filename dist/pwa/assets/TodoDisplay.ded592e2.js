import{d as k,N as v,_ as g,r as b,o as n,K as r,ar as _,e as s,f as h,a as p,ax as j,L as c,M as f,t as y,a8 as T}from"./index.68e5778b.js";import{u as C}from"./backend_connection.88424002.js";import{T as N}from"./TodoItem.0f926d8e.js";const U=k({name:"TodoDisplayComponent",props:{patch_id:{type:String,default:void 0}},components:{TodoItem:N},setup(){return{backend_connection_store:C()}},data(){return{loaded:!1,loaded_todo_data:void 0,group_by:"group",group_by_options:[{label:"None",value:"none"},{label:"Group",value:"group"},{label:"Project",value:"project"}]}},computed:{display_groups(){const e=this;let a=[],t={"":{name:"",link_url:void 0,filter:void 0}};return this.group_by==="none"?t[""]={name:"",filter:function(o){return!0}}:this.loaded_todo_data.forEach(function(o){e.group_by==="group"&&(t[o.group]={name:o.group,link_url:void 0,filter:function(i){return i.group===o.group}}),e.group_by==="project"&&(t[o.project_name]={name:o.project_name,link_url:"/tools/brrcalc?projectid="+o.project_id,filter:function(i){return i.project_id===o.project_id}})}),Object.keys(t).map(function(o){if(typeof t[o].filter!="undefined"){let i=t[o].name;i===""&&(i="Ungrouped"),a.push({name:i,link_url:t[o].link_url,due_items:e.loaded_todo_data.filter(t[o].filter).filter(function(u){return u.due}),nondue_items:e.loaded_todo_data.filter(t[o].filter).filter(function(u){return!u.due})})}}),a}},methods:{refresh(){const e=this;let a="/me/todos?done=false";typeof this.patch_id!="undefined"&&(a="/me/todos?done=false&patch_id="+this.patch_id);const t={ok:e.refresh_success,error:function(o){v.create({color:"negative",message:"Failed to load todos",timeout:2e3}),e.$router.push("/tools")}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:a,method:"GET",data:void 0,callback:t})},refresh_success(e){this.loaded_todo_data=e.data.todos,this.loaded=!0}},mounted(){this.loaded=!1,this.refresh()}}),V={class:"tododisplayclass"},$={key:0},B=s("h1",null,"Loading...",-1),D=[B],G={key:1},I={class:"flex"},w={key:0},E={key:1},L={class:"row"};function P(e,a,t,o,i,u){const m=b("TodoItem");return n(),r("div",V,[e.loaded?_("",!0):(n(),r("div",$,D)),e.loaded?(n(),r("div",G,[s("div",null,[s("div",null,[s("div",I,[h("Group: "),p(j,{modelValue:e.group_by,"onUpdate:modelValue":a[0]||(a[0]=d=>e.group_by=d),options:e.group_by_options,color:"primary",inline:""},null,8,["modelValue","options"])])]),(n(!0),r(c,null,f(e.display_groups,d=>(n(),r("div",{key:d.name},[typeof d.link_url=="undefined"?(n(),r("div",w,[s("h2",null,y(d.name),1)])):_("",!0),typeof d.link_url!="undefined"?(n(),r("div",E,[s("h2",null,[h(y(d.name)+" ",1),p(T,{color:"primary",icon:"arrow_forward",onClick:l=>e.$router.push(d.link_url)},null,8,["onClick"])])])):_("",!0),s("div",L,[(n(!0),r(c,null,f(d.due_items,l=>(n(),r("div",{key:l.id},[p(m,{todo:l,include_project:e.group_by!="project",onUpdate_todo_item:e.refresh},null,8,["todo","include_project","onUpdate_todo_item"])]))),128)),(n(!0),r(c,null,f(d.nondue_items,l=>(n(),r("div",{key:l.id},[p(m,{todo:l,include_project:e.group_by!="project",onUpdate_todo_item:e.refresh},null,8,["todo","include_project","onUpdate_todo_item"])]))),128))])]))),128))])])):_("",!0)])}var Q=g(U,[["render",P]]);export{Q as T};
