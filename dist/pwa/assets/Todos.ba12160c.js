import{d as f,j as Q,_ as v,o as a,K as i,a as t,Q as d,w as l,aa as k,ae as p,ak as S,e as n,af as u,ah as j,at as B,L as $,f as L,au as N,r as y,c as V,a9 as A,M as T,O as C,t as z}from"./index.ab210fde.js";import{Q as w}from"./QSpace.43c6e9a1.js";import{C as D}from"./ClosePopup.a2cb6807.js";import{Q as O}from"./QSelect.102c3359.js";import{c as q}from"./common_constants.94b43302.js";import{u as R}from"./uuid.6153c38a.js";import{u as E}from"./backend_connection.01823963.js";import{T as G}from"./TodoItem.3839004c.js";const M=f({name:"BrrCalcToolbarCallSellingAgent",emits:["activity_log"],data(){return{dialog_visible:Q(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"call_agent",text:"Called selling agent spoke to ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),F={class:"brrcalctoolbar"},H=n("div",{class:"text-h6"},"Log call with selling agent",-1);function K(e,o,r,c,g,h){return a(),i("div",F,[t(d,{color:"primary",icon:"call",label:"Selling agent",onClick:e.open_dialog},null,8,["onClick"]),t(B,{modelValue:e.dialog_visible,"onUpdate:modelValue":o[3]||(o[3]=s=>e.dialog_visible=s)},{default:l(()=>[t(k,null,{default:l(()=>[t(p,{class:"row items-center q-pb-none"},{default:l(()=>[H,t(w),S(t(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[D]])]),_:1}),t(p,null,{default:l(()=>[n("div",null,[t(u,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":o[0]||(o[0]=s=>e.spoke_to=s),label:"Spoke to",rules:[s=>s.length>2||"Too short"]},null,8,["modelValue","rules"])]),n("div",null,[t(u,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":o[1]||(o[1]=s=>e.notes=s),label:"Notes",rules:[s=>s.length>2||"Too short"]},null,8,["modelValue","rules"])]),t(j,{align:"right",class:"text-primary"},{default:l(()=>[t(d,{label:"Cancel",onClick:o[2]||(o[2]=s=>this.dialog_visible=!1)}),t(d,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var P=v(M,[["render",K]]);const J=f({name:"BrrCalcToolbarResearchCall",emits:["activity_log"],data(){return{dialog_visible:Q(!1),spoke_to:"",notes:""}},computed:{isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{open_dialog(){this.dialog_visible=!0,this.spoke_to="",this.notes=""},click_selling_agent_btn(){const e={type:"research_call",text:"Research call with ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.$emit("activity_log",e),this.dialog_visible=!1}}}),W={class:"brrcalctoolbar"},X=n("div",{class:"text-h6"},"Log research call",-1);function Y(e,o,r,c,g,h){return a(),i("div",W,[t(d,{color:"primary",icon:"call",label:"Research",onClick:e.open_dialog},null,8,["onClick"]),t(B,{modelValue:e.dialog_visible,"onUpdate:modelValue":o[3]||(o[3]=s=>e.dialog_visible=s)},{default:l(()=>[t(k,null,{default:l(()=>[t(p,{class:"row items-center q-pb-none"},{default:l(()=>[X,t(w),S(t(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[D]])]),_:1}),t(p,null,{default:l(()=>[n("div",null,[t(u,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":o[0]||(o[0]=s=>e.spoke_to=s),label:"Spoke to",rules:[s=>s.length>2||"Too short"]},null,8,["modelValue","rules"])]),n("div",null,[t(u,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":o[1]||(o[1]=s=>e.notes=s),label:"Notes",rules:[s=>s.length>2||"Too short"]},null,8,["modelValue","rules"])]),t(j,{align:"right",class:"text-primary"},{default:l(()=>[t(d,{label:"Cancel",onClick:o[2]||(o[2]=s=>this.dialog_visible=!1)}),t(d,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Z=v(J,[["render",Y]]);const x=2,ee=f({name:"BrrCalcToolbarSaveButton",props:["reason_project_not_savable"],emits:["saveproject"],data(){return{changed:!1,autosave_seconds_left:60,ever_saved:!1,save_in_progress:!1,save_monitor_function_running:!1,pending_set_changed:!1}},computed:{no_save_message(){return this.reason_project_not_savable!==""?this.reason_project_not_savable:this.save_in_progress?"Saving...":""},can_save(){return this.save_in_progress?!1:!!this.changed},save_btn_text(){return this.save_in_progress?"Saving...":this.no_save_message!==""?"Not able to save ("+this.no_save_message+")":this.changed?this.autosave_seconds_left===-1?"Save Now":"Save now (auto save in "+this.autosave_seconds_left+")":this.ever_saved?"Saved":"Not able to save (No changes)"},is_project_changed(){return this.changed}},methods:{serializer_load_data(e){this.ever_saved=!0},click_btn(){if(!!this.changed){if(this.no_save_message!==""){this.$q.dialog({title:"Not currently able to save",message:this.no_save_message,html:!0});return}this.autosave_seconds_left=-1,this.save_now()}},set_changed_true(e){if(this.pending_set_changed){console.log("SaveButton.vue:set_changed_true - set changed called but there is already one pending");return}if(this.save_in_progress){console.log("SaveButton.vue:set_changed_true - Delay set changed due to save in progress");const o=this;setTimeout(function(){o.pending_set_changed=!1,o.set_changed_true()},1e3);return}this.changed=!0,this.no_save_message===""&&(typeof e!="undefined"&&typeof e.autosave_seconds!="undefined"?this.autosave_seconds_left=e.autosave_seconds:this.autosave_seconds_left=x,this.start_save_monitor_function())},start_save_monitor_function(){this.save_monitor_function_running||this.save_monitor_function()},save_monitor_function(){if(this.save_monitor_function_running=!0,this.save_in_progress)return;if(this.autosave_seconds_left===-1){this.save_monitor_function_running=!1;return}const e=this;if(e.autosave_seconds_left=e.autosave_seconds_left-1,e.autosave_seconds_left<1){this.save_monitor_function_running=!1,this.save_now();return}setTimeout(e.save_monitor_function,1e3)},save_now(){!this.can_save||(this.save_in_progress=!0,this.$emit("saveproject"))},save_project_complete_notification({success:e,response:o}){console.log("SaveButton - Save completed notification recieved"),this.save_in_progress=!1,e?(this.changed=!1,this.ever_saved=!0):this.autosave_seconds_left=-1}}}),oe={class:"brrcalctoolbar"};function te(e,o,r,c,g,h){return a(),i("div",oe,[t(d,{color:"primary",icon:"save",label:e.save_btn_text,onClick:e.click_btn},null,8,["label","onClick"])])}var se=v(ee,[["render",te]]);function U(){return{due:"1",description:"",type:"other",group:""}}const ae=f({name:"BrrCalcToolbarTodoButton",emits:["createtodo"],data(){return{dialog_visible:!1,dialog_data:U(),type_options:q.todo_item_types,due_options:[{label:"1 Day",value:"1"},{label:"3 Days",value:"3"},{label:"5 Days",value:"5"}]}},computed:{isDisabled(){return!1}},methods:{open_dialog(){this.dialog_data=U(),this.dialog_visible=!0},click_ok(){if(this.$refs.field_description.validate(),this.$refs.field_description.hasError)return;let e=this.dialog_data.group;this.dialog_data.type==="agent"&&(e=""),this.dialog_data.type==="sourcer"&&(e="");const o=parseInt(this.dialog_data.due),r=new Date(new Date().getTime()+o*24*60*60*1e3),c={id:R(),weight:"100",due_date:r.toISOString(),description:this.dialog_data.description,done:!1,done_date:"",group:e,type:this.dialog_data.type,done_text:""};this.$emit("createtodo",c),this.dialog_visible=!1},helpgrouping(){this.$q.dialog({title:"Todo Item Grouping",message:"The grouping field can be left blank. It can be used to group todo items together in displays.",html:!1}).onOk(()=>{})}}}),le={class:"brrcalctoolbar-todobutton"},ne=n("div",{class:"text-h6"},"Log todo task for this project",-1),ie={class:"brrcalctoolbar-field"},re={key:0,class:"brrcalctoolbar-field col flex"},de={class:"brrcalctoolbar-field"},_e={class:"brrcalctoolbar-field"};function ue(e,o,r,c,g,h){return a(),i("div",le,[t(d,{color:"primary",icon:"rule",label:"Add TODO",onClick:e.open_dialog},null,8,["onClick"]),t(B,{modelValue:e.dialog_visible,"onUpdate:modelValue":o[5]||(o[5]=s=>e.dialog_visible=s)},{default:l(()=>[t(k,{class:"brrcalctoolbar-card"},{default:l(()=>[t(p,{class:"row items-center q-pb-none"},{default:l(()=>[ne,t(w),S(t(d,{icon:"close",flat:"",round:"",dense:""},null,512),[[D]])]),_:1}),t(p,null,{default:l(()=>[n("div",null,[n("div",ie,[t(O,{modelValue:e.dialog_data.type,"onUpdate:modelValue":o[0]||(o[0]=s=>e.dialog_data.type=s),options:e.type_options,label:"Type of Task","emit-value":"","map-options":""},null,8,["modelValue","options"])]),e.dialog_data.type==="other"?(a(),i("div",re,[t(u,{modelValue:e.dialog_data.group,"onUpdate:modelValue":o[1]||(o[1]=s=>e.dialog_data.group=s),label:"Grouping",class:"col-grow"},null,8,["modelValue"]),t(d,{round:"",dense:"",flat:"",icon:"info",onClick:e.helpgrouping},null,8,["onClick"])])):$("",!0),n("div",de,[t(u,{modelValue:e.dialog_data.description,"onUpdate:modelValue":o[2]||(o[2]=s=>e.dialog_data.description=s),label:"Description",autogrow:"",rules:[s=>s.trim().length>3||"Minimum 4 characters"],ref:"field_description"},null,8,["modelValue","rules"])]),n("div",_e,[L("How long until it's due: "),t(N,{modelValue:e.dialog_data.due,"onUpdate:modelValue":o[3]||(o[3]=s=>e.dialog_data.due=s),options:e.due_options,color:"primary",inline:""},null,8,["modelValue","options"])])]),t(j,{align:"right",class:"text-primary"},{default:l(()=>[t(d,{label:"Cancel",onClick:o[4]||(o[4]=s=>this.dialog_visible=!1)}),t(d,{color:"primary",icon:"rule",label:"Ok",onClick:e.click_ok,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var ce=v(ae,[["render",ue]]);const pe=f({name:"BrrCalcToolbar",props:{reason_project_not_savable:{type:String},is_saved_project_with_id:{type:Boolean},is_rent_project:{type:Boolean,default:!1}},emits:["activity_log","saveproject","createtodo"],components:{CallSellingAgent:P,ResearchCall:Z,SaveButton:se,TodoButton:ce},data(){return{}},computed:{ever_saved(){return this.$refs.SaveToolbar.ever_saved},is_project_changed(){return this.$refs.SaveToolbar.is_project_changed}},methods:{click_save_btn(){this.$refs.SaveToolbar.click_btn()},set_changed_true(e){this.$refs.SaveToolbar.set_changed_true(e)},save_project_complete_notification(e){this.$refs.SaveToolbar.save_project_complete_notification(e)},serializer_load_data(e){this.$refs.SaveToolbar.serializer_load_data(e)}}}),me={class:"row brrcalctoolbar"};function fe(e,o,r,c,g,h){const s=y("SaveButton"),_=y("CallSellingAgent"),m=y("ResearchCall"),I=y("TodoButton");return a(),i("div",me,[t(s,{ref:"SaveToolbar",onSaveproject:o[0]||(o[0]=b=>e.$emit("saveproject")),reason_project_not_savable:e.reason_project_not_savable},null,8,["reason_project_not_savable"]),e.is_rent_project?$("",!0):(a(),V(_,{key:0,onActivity_log:o[1]||(o[1]=b=>e.$emit("activity_log",b))})),t(m,{onActivity_log:o[2]||(o[2]=b=>e.$emit("activity_log",b))}),e.is_saved_project_with_id?(a(),V(I,{key:1,onCreatetodo:o[3]||(o[3]=b=>e.$emit("createtodo",b))})):$("",!0)])}var Ne=v(pe,[["render",fe]]);const ve=f({name:"CommonCalcLocation",emits:["projectchanged"],data(){return{coords:{lat:"",long:""},entry_mode:""}},computed:{serializer_card_data(){return{coords:this.coords,entry_mode:this.entry_mode}}},watch:{serializer_card_data(e){this.setchanged()}},methods:{setchanged(){this.emit_project_change_notification&&this.$emit("projectchanged","Location")},serializer_load_data(e){this.emit_project_change_notification=!1,this.coords={lat:"",long:""},this.entry_mode="",typeof e.coords!="undefined"&&(this.coords=e.coords),typeof e.entry_mode!="undefined"&&(this.entry_mode=e.entry_mode);const o=this;setTimeout(function(){o.emit_project_change_notification=!0},50)}}}),ge=n("div",{class:"text-h6"},"Location",-1),he={class:"row"};function be(e,o,r,c,g,h){return a(),V(k,{inline:"",class:"q-ma-sm card-style"},{default:l(()=>[t(p,null,{default:l(()=>[ge,n("div",he,[t(u,{modelValue:e.coords.lat,"onUpdate:modelValue":o[0]||(o[0]=s=>e.coords.lat=s),label:"Latitude",class:"",readonly:""},null,8,["modelValue"]),t(u,{modelValue:e.coords.long,"onUpdate:modelValue":o[1]||(o[1]=s=>e.coords.long=s),label:"Longitude",class:"",readonly:""},null,8,["modelValue"]),t(u,{modelValue:e.entry_mode,"onUpdate:modelValue":o[2]||(o[2]=s=>e.entry_mode=s),label:"Entered mode",class:"",readonly:""},null,8,["modelValue"])])]),_:1})]),_:1})}var Ae=v(ve,[["render",be]]);const ye=f({name:"BrrCalcTodos",components:{TodoItem:G},setup(){return{backend_connection_store:E()}},data(){return{todos:[]}},computed:{todo_groups(){let e={"":!0};return this.todos.forEach(function(o){e[o.group]=!0}),e},done_todos(){return this.todos.filter(function(e){return e.done===!0})}},methods:{due_todos(e){return this.todos.filter(function(o){return o.group===e&&o.done===!1&&o.due===!0})},notdone_todos(e){return this.todos.filter(function(o){return o.group===e&&o.done===!1&&o.due===!1})},serializer_load_data(e){this.todos=e},add_single_todo(e){this.todos.push(e)},update_todo_item(e){const o=this;o.todos=o.todos.map(function(r){return r.id==e.id&&(r=e),r})},delete_todo_item(e){const o=this;o.todos=o.todos.filter(function(r){return r.id!==e})}}}),$e={class:"text-h6 todos-card-head"},ke={style:{width:"100%","max-width":"400px"}},Te={key:0},Ce={key:0,class:"todos-grouptitle"},Ve=n("div",null,"Completed Items",-1);function Se(e,o,r,c,g,h){const s=y("TodoItem");return a(),i("div",null,[t(k,{inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:l(()=>[t(p,null,{default:l(()=>[n("div",$e,[t(A,{name:"rule",size:"30px"}),L(" Todo Items")]),n("div",ke,[(a(!0),i(T,null,C(Object.keys(e.todo_groups),_=>(a(),i("div",{key:_},[e.due_todos(_).length+e.notdone_todos(_).length>0?(a(),i("div",Te,[_!==""?(a(),i("div",Ce,z(_),1)):$("",!0),n("div",null,[(a(!0),i(T,null,C(e.due_todos(_),m=>(a(),i("div",{key:m.id},[t(s,{todo:m,onUpdate_todo_item:e.update_todo_item,onDelete_todo_item:e.delete_todo_item},null,8,["todo","onUpdate_todo_item","onDelete_todo_item"])]))),128)),(a(!0),i(T,null,C(e.notdone_todos(_),m=>(a(),i("div",{key:m.id},[t(s,{todo:m,onUpdate_todo_item:e.update_todo_item,onDelete_todo_item:e.delete_todo_item},null,8,["todo","onUpdate_todo_item","onDelete_todo_item"])]))),128))])])):$("",!0)]))),128)),n("div",null,[Ve,(a(!0),i(T,null,C(e.done_todos,_=>(a(),i("div",{key:_.id},[t(s,{todo:_,onUpdate_todo_item:e.update_todo_item,onDelete_todo_item:e.delete_todo_item},null,8,["todo","onUpdate_todo_item","onDelete_todo_item"])]))),128))])])]),_:1})]),_:1})])}var ze=v(ye,[["render",Se]]);export{Ne as B,Ae as L,ze as T};
