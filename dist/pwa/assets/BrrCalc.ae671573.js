import{Q as $e,a as ee}from"./QTabs.1c8507dd.js";import{Q as Ce}from"./QPage.127217ca.js";import{d as j,j as qe,_ as P,r as p,o as g,K as T,a as o,Q as $,w as u,aa as z,ae as k,ai as O,e as n,af as B,c as v,L as b,ah as K,aj as J,f as w,ag as L,t as d,M as Ae,O as Te,g as je,k as Pe,q as Be,x as Ie,N as I,a9 as Re,ak as W,al as H,am as te}from"./index.9a2f1438.js";import{Q as X}from"./QSpace.12805879.js";import{C as Z}from"./ClosePopup.683c3c5c.js";import{u as U,a as Ve}from"./backend_connection.1483c074.js";import{u as x}from"./data_caches.b4308b1b.js";import{P as le}from"./PatchAgentNotes.fd9e58d5.js";import{R as ze,S as De,T as Me,a as Ee,L as Ne}from"./Todos.ac0dca4b.js";import{S as Fe,I as ce,G as Oe,P as Le,R as Ue,a as Ge,O as We,F as Qe,D as He}from"./DealRating.5ee2d2c7.js";import{u as N}from"./utils.99aafcb0.js";import{Q as Ye,a as A,b as M,c as Ke}from"./QTable.9d7c3174.js";import{Q as Je}from"./QExpansionItem.97ac7de3.js";import{F as Xe}from"./FeatureTable.fd40f245.js";import{Q as Ze}from"./QSelect.92fb6715.js";import{W as xe,P as et,A as tt,a as at}from"./ProjectSerializer.2851c132.js";import{Q as rt}from"./QItemLabel.307e316a.js";import{Q as st,a as nt}from"./QItemSection.937f6a4e.js";import{u as ot}from"./uuid.6153c38a.js";import{c as it}from"./common_constants.94b43302.js";import"./QResizeObserver.52cbc74d.js";import"./axios.6e1fcf85.js";import"./QMenu.4f7185d1.js";import"./position-engine.c106b2c2.js";import"./QTooltip.88b0010f.js";import"./use-fullscreen.e6bd2078.js";import"./TodoItem.99f390f1.js";import"./TouchPan.877adf5f.js";import"./QList.74a58ef8.js";import"./Workflow_main.512fc34f.js";const lt=j({name:"BrrCalcToolbarCallSellingAgent",emits:["activity_log"],components:{PatchAgentNotes:le},setup(){const e=U(),a=x();return{backend_connection_store:e,dataCachesStore:a}},data(){return{dialog_visible:qe(!1),spoke_to:"",notes:"",project_id:"",patch_id:"",selling_agent_id:""}},computed:{patchagents_data(){if(this.patch_id!=="")return this.dataCachesStore.get_direct_from_cache({object_type:"patchagents",object_id:this.patch_id})},show_selling_agent_notes(){return!(typeof this.patchagents_data=="undefined"||typeof this.project_id=="undefined"||this.project_id===""||this.patch_id===""||this.selling_agent_id==="")},isDisabled(){return this.spoke_to.length<1||this.notes<3}},methods:{set_project_id(e){this.project_id=e},set_patch_id(e){this.patch_id=e},set_selling_agent_id(e){this.selling_agent_id=e},open_dialog(){const e=this;this.dialog_visible=!0,this.spoke_to="",this.notes="",setTimeout(function(){const a=e.patchagents_data.agents[e.selling_agent_id];e.$refs.PatchAgentNotes.init(a.agent_name,a.agent_notes,a.projects,e.project_id)},100)},click_selling_agent_btn(){const e={type:"call_agent",text:"Called selling agent spoke to ("+this.spoke_to+") - "+this.notes,head_notes:void 0};this.save_notes(),this.$emit("activity_log",e),this.dialog_visible=!1},save_notes_and_close(){this.save_notes(),this.dialog_visible=!1},save_notes(){if(!this.show_selling_agent_notes)return;const e=this.$refs.PatchAgentNotes.get_agent_data();this.patchagents_data.agents[this.selling_agent_id].agent_name=e.agent_name,this.patchagents_data.agents[this.selling_agent_id].agent_notes=e.agent_notes;const a={ok:function(s){},error:this.save_notes_fail};this.dataCachesStore.save({backend_connection_store:this.backend_connection_store,object_type:"patchagents",object_data:this.patchagents_data,callback:a})},save_notes_fail(e){if(console.log("save_notes_fail",e),typeof e.response!="undefined"&&typeof e.response.data!="undefined"&&typeof e.response.data.message!="undefined"){Notify.create({color:"bg-grey-2",message:e.response.data.message,timeout:2e3,color:"negative"});return}Notify.create({color:"bg-grey-2",message:e.message,timeout:2e3,color:"negative"})}}}),ct={class:"brrcalctoolbar"},ut=n("div",{class:"text-h6"},"Log call with selling agent",-1),_t={key:0,class:"callsellingagent-agentnotessection"},dt=n("div",{class:"callsellingagent-agentnotessection-title"},"Agent Notes",-1);function ht(e,a,s,r,t,c){const l=p("PatchAgentNotes");return g(),T("div",ct,[o($,{color:"primary",icon:"call",label:"Selling agent",onClick:e.open_dialog},null,8,["onClick"]),o(J,{modelValue:e.dialog_visible,"onUpdate:modelValue":a[3]||(a[3]=i=>e.dialog_visible=i)},{default:u(()=>[o(z,{class:"callsellingagent-qcard"},{default:u(()=>[o(k,{class:"row items-center q-pb-none"},{default:u(()=>[ut,o(X),O(o($,{icon:"close",flat:"",round:"",dense:""},null,512),[[Z]])]),_:1}),o(k,null,{default:u(()=>[n("div",null,[o(B,{filled:"",clearable:"",modelValue:e.spoke_to,"onUpdate:modelValue":a[0]||(a[0]=i=>e.spoke_to=i),label:"Spoke to",rules:[i=>i.length>2||"Too short"]},null,8,["modelValue","rules"])]),n("div",null,[o(B,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":a[1]||(a[1]=i=>e.notes=i),label:"Notes",rules:[i=>i.length>2||"Too short"]},null,8,["modelValue","rules"])]),e.show_selling_agent_notes?(g(),T("div",_t,[dt,o(l,{ref:"PatchAgentNotes"},null,512),e.show_selling_agent_notes?(g(),v($,{key:0,color:"secondary",icon:"call",label:"Save Agent Notes Only",onClick:e.save_notes_and_close,size:"sm"},null,8,["onClick"])):b("",!0)])):b("",!0),o(K,{align:"right",class:"text-primary"},{default:u(()=>[o($,{label:"Cancel",onClick:a[2]||(a[2]=i=>this.dialog_visible=!1)}),o($,{color:"primary",icon:"call",label:"Save",onClick:e.click_selling_agent_btn,disable:e.isDisabled},null,8,["onClick","disable"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var gt=P(lt,[["render",ht]]);const ft=j({name:"BrrCalcToolbar",props:{reason_project_not_savable:{type:String},is_saved_project_with_id:{type:Boolean}},emits:["activity_log","saveproject","createtodo"],components:{CallSellingAgent:gt,ResearchCall:ze,SaveButton:De,TodoButton:Me},data(){return{}},computed:{ever_saved(){return this.$refs.SaveToolbar.ever_saved},is_project_changed(){return this.$refs.SaveToolbar.is_project_changed}},methods:{set_project_id(e){this.$refs.CallSellingAgent.set_project_id(e)},set_patch_id(e){this.$refs.CallSellingAgent.set_patch_id(e)},set_selling_agent_id(e){this.$refs.CallSellingAgent.set_selling_agent_id(e)},click_save_btn(){this.$refs.SaveToolbar.click_btn()},set_changed_true(e){this.$refs.SaveToolbar.set_changed_true(e)},save_project_complete_notification(e){this.$refs.SaveToolbar.save_project_complete_notification(e)},serializer_load_data(e){this.$refs.SaveToolbar.serializer_load_data(e)}}}),pt={class:"row brrcalctoolbar"};function mt(e,a,s,r,t,c){const l=p("SaveButton"),i=p("CallSellingAgent"),_=p("ResearchCall"),f=p("TodoButton");return g(),T("div",pt,[o(l,{ref:"SaveToolbar",onSaveproject:a[0]||(a[0]=h=>e.$emit("saveproject")),reason_project_not_savable:e.reason_project_not_savable},null,8,["reason_project_not_savable"]),o(i,{ref:"CallSellingAgent",onActivity_log:a[1]||(a[1]=h=>e.$emit("activity_log",h))},null,512),o(_,{onActivity_log:a[2]||(a[2]=h=>e.$emit("activity_log",h))}),e.is_saved_project_with_id?(g(),v(f,{key:0,onCreatetodo:a[3]||(a[3]=h=>e.$emit("createtodo",h))})):b("",!0)])}var wt=P(ft,[["render",mt]]);function ae(){return{flip:!1,hmo:!1}}const vt=j({name:"BrrCalcVision",emits:["projectchanged"],data(){return{devplan:"",strategy:ae(),emit_project_change_notification:!0}},computed:{serializer_card_data(){return{devplan:this.devplan,strategy:this.strategy}}},watch:{serializer_card_data(e){this.setchanged()}},methods:{setchanged(){this.emit_project_change_notification&&this.$emit("projectchanged","Vision")},helpdevplan(){this.$q.dialog({title:"What is the development plan?",message:"Enter the development plan. E.g. Split into two flats"}).onOk(()=>{})},serializer_load_data(e){this.emit_project_change_notification=!1,this.devplan=e.devplan,typeof e.strategy=="undefined"?this.strategy=ae():(this.strategy.flip=e.strategy.flip,this.strategy.hmo=e.strategy.hmo);const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}}}),bt=n("div",{class:"text-h6"},"Vision",-1),yt={class:"row"},St=n("div",{class:"text-h6"},"Strategies",-1);function kt(e,a,s,r,t,c){return g(),v(z,{inline:"",class:"q-ma-sm card-style"},{default:u(()=>[o(k,null,{default:u(()=>[bt,n("div",yt,[o(B,{modelValue:e.devplan,"onUpdate:modelValue":a[0]||(a[0]=l=>e.devplan=l),autogrow:"",label:"What is the development plan?",class:"col-grow"},null,8,["modelValue"]),n("div",null,[o($,{round:"",color:"primary",icon:"info",onClick:e.helpdevplan},null,8,["onClick"])])]),w(" \xA0 "),St,n("div",null,[o(L,{modelValue:e.strategy.flip,"onUpdate:modelValue":a[1]||(a[1]=l=>e.strategy.flip=l),label:"Flip",onClick:e.setchanged},null,8,["modelValue","onClick"])]),n("div",null,[o(L,{modelValue:e.strategy.hmo,"onUpdate:modelValue":a[2]||(a[2]=l=>e.strategy.hmo=l),label:"HMO",onClick:e.setchanged},null,8,["modelValue","onClick"])])]),_:1})]),_:1})}var $t=P(vt,[["render",kt]]);function re(){return{min:6,max:6}}function se(){return 2500}function Ct(){return[{name:"Remortgage Arrangment",amount:2500},{name:"Remortgage Solicitors",amount:2300},{name:"Remortgage Valuation",amount:1500}]}const qt=j({name:"BrrCalcFinance",emits:["projectchanged"],props:["gdv_total"],components:{SliderWithTextInput:Fe},data(){return{refinance:{userefinance:!0,ltv:{min:75,max:75},rate:re(),commercial_valuation:!1},emit_project_change_notification:!0}},methods:{format_currency(e){return N.format_currency(e)},serializer_load_data(e){this.emit_project_change_notification=!1,this.refinance.userefinance=e.refinance_userefinance,this.refinance.ltv=e.refinance_userefinance_ltv,typeof e.refinance_userefinance_rate=="undefined"?this.refinance.rate=re():this.refinance.rate=e.refinance_userefinance_rate,typeof e.refinance_commercial_valuation=="undefined"?this.refinance.commercial_valuation=!1:this.refinance.commercial_valuation=e.refinance_commercial_valuation;const a=this;setTimeout(function(){a.emit_project_change_notification=!0},50)}},watch:{serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","Refinance")}},computed:{monthly_payments(){return{worst:this.refinanceamount.worst*(this.refinance.rate.min/(100*12)),best:this.refinanceamount.best*(this.refinance.rate.max/(100*12))}},serializer_card_data(){return{refinance_userefinance:this.refinance.userefinance,refinance_userefinance_ltv:this.refinance.ltv,refinance_userefinance_rate:this.refinance.rate,refinance_commercial_valuation:this.refinance.commercial_valuation}},get_refinance(){return this.refinance},refinanceamount(){return{worst:this.gdv_total.min*(this.refinance.ltv.min/100),best:this.gdv_total.max*(this.refinance.ltv.max/100)}},refinance_costs(){let e=[];return this.refinance.commercial_valuation?(Ct().forEach(function(a){e.push({name:a.name,worst:-1*a.amount,best:-1*a.amount})}),e):(e.push({name:"Remortgage Cost",worst:-1*se(),best:-1*se()}),e)},refinance_out_items(){let e=[];return this.refinance.userefinance&&e.push({name:"Mortgage Refinance",worst:this.refinanceamount.worst,best:this.refinanceamount.best}),this.refinance_costs.map(function(a){e.push(a)}),e}}}),At=n("div",{class:"text-h6"},"Refinance",-1),Tt={key:0},jt=n("hr",null,null,-1),Pt=n("hr",null,null,-1),Bt=n("div",null,[n("b",null,"Refinance Costs:")],-1);function It(e,a,s,r,t,c){const l=p("SliderWithTextInput");return g(),v(z,{inline:"",class:"q-ma-sm card-style"},{default:u(()=>[o(k,null,{default:u(()=>[At,w(" This section is for adding refinance details. After the refurbishment is complete the refinance stage can be used to pull money out of the deal. "),o(L,{modelValue:e.refinance.userefinance,"onUpdate:modelValue":a[0]||(a[0]=i=>e.refinance.userefinance=i),label:"Refinance after refurbishment"},null,8,["modelValue"]),e.refinance.userefinance?(g(),T("div",Tt,[w(" Refinance LTV "+d(e.refinance.ltv.min)+"% - "+d(e.refinance.ltv.max)+"% ",1),o(l,{ref:"slider",range:e.refinance.ltv,"onUpdate:range":a[1]||(a[1]=i=>e.refinance.ltv=i),min:0,max:100,step:5,left_label_value:e.refinance.ltv.min+"%",right_label_value:e.refinance.ltv.max+"%",min_label_text:"Worst LTV %",max_label_text:"Best LTV %"},null,8,["range","left_label_value","right_label_value"]),jt,w(" Intrest rate "+d(e.refinance.rate.min)+"% - "+d(e.refinance.rate.max)+"% ",1),o(l,{ref:"slider",range:e.refinance.rate,"onUpdate:range":a[2]||(a[2]=i=>e.refinance.rate=i),min:0,max:10,step:.1,left_label_value:e.refinance.rate.min+"%",right_label_value:e.refinance.rate.max+"%",min_label_text:"Worst %",max_label_text:"Best %"},null,8,["range","left_label_value","right_label_value"]),n("div",null,[o(L,{modelValue:e.refinance.commercial_valuation,"onUpdate:modelValue":a[3]||(a[3]=i=>e.refinance.commercial_valuation=i),label:"Commercial Valuation"},null,8,["modelValue"])]),Pt,n("div",null,"Refinance amount: "+d(e.format_currency(e.refinanceamount.worst))+" - "+d(e.format_currency(e.refinanceamount.best)),1),n("div",null,"Monthly Payments: "+d(e.format_currency(e.monthly_payments.worst))+" - "+d(e.format_currency(e.monthly_payments.best)),1),n("div",null,[Bt,(g(!0),T(Ae,null,Te(e.refinance_costs,i=>(g(),T("div",{key:i.name},[n("div",null,d(i.name)+": "+d(e.format_currency(i.worst*-1))+" - "+d(e.format_currency(i.best*-1)),1)]))),128))])])):b("",!0)]),_:1})]),_:1})}var Rt=P(qt,[["render",It]]),F=je({name:"QTr",props:{props:Object,noHover:Boolean},setup(e,{slots:a}){const s=Pe(()=>"q-tr"+(e.props===void 0||e.props.header===!0?"":" "+e.props.__trClass)+(e.noHover===!0?" q-tr--no-hover":""));return()=>Be("tr",{class:s.value},Ie(a.default))}});function ue(e){return e.filter(function(a){return a.type==="ledger"})}function Y(e,a){e.push({type:"blank",key:e.length}),e.push({type:"title",key:e.length,name:a})}function D(e,a,s,r){let t=ue(e);var c=void 0,l=void 0;t.length>0&&(c=t[t.length-1].worst,l=t[t.length-1].best);function i(_,f){var h=0;typeof _!="undefined"&&(h=_.bal);var q="",R="";return f>0?q=f:R=f,{in:q,out:R,bal:h+f}}e.push({type:"ledger",key:e.length,name:a,worst:i(c,s),best:i(l,r)})}const Vt=j({name:"BrrCalcDealSummary",props:["is_valid_input","purchaserange","finance_in_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","finance_out_items","refinance_out_items","finance_during_items"],components:{InvalidMessage:ce},data(){return{table:{columns:[{name:"item",label:"Item",field:"item"},{name:"win",label:"In",field:"win"},{name:"wout",label:"Out",field:"wout"},{name:"wbal",label:"Balance",field:"wbal"},{name:"bin",label:"In",field:"bin"},{name:"bout",label:"Out",field:"bout"},{name:"bbal",label:"Balance",field:"bbal"}]}}},methods:{format_currency(e){return typeof e=="string"&&e===""?"":N.format_currency(e)}},computed:{final_bal(){let e=ue(this.items);return e.length===0?{worst:0,best:0}:{worst:e[e.length-1].worst.bal,best:e[e.length-1].best.bal}},money_in(){var e=this.finance_in_items.reduce((s,r)=>s+r.worst,0),a=this.finance_in_items.reduce((s,r)=>s+r.best,0);return{worst:e,best:a}},items(){var e=[];typeof this.finance_in_items!="undefined"&&this.finance_in_items.map(function(s){D(e,s.name,s.worst,s.best)}),typeof this.purchase_items!="undefined"&&this.purchase_items.map(function(s){D(e,s.name,s.worst,s.best)}),typeof this.stampduty_items!="undefined"&&this.stampduty_items.map(function(s){D(e,s.name,s.worst,s.best)}),typeof this.othercosts_items!="undefined"&&this.othercosts_items.map(function(s){D(e,s.name,s.worst,s.best)}),Y(e,"During Project"),typeof this.finance_during_items!="undefined"&&this.finance_during_items.map(function(s){D(e,s.name,s.worst,s.best)}),typeof this.refurb_cost_items!="undefined"&&this.refurb_cost_items.map(function(s){D(e,s.name,s.worst,s.best)});let a=!1;return typeof this.refinance_out_items!="undefined"&&(this.refinance_out_items.length>0&&(a=!0,Y(e,"Exit finance")),this.refinance_out_items.map(function(s){D(e,s.name,s.worst,s.best)})),typeof this.finance_out_items!="undefined"&&(this.finance_out_items.length>0&&(a||Y(e,"Exit finance")),this.finance_out_items.map(function(s){D(e,s.name,s.worst,s.best)})),e}}}),zt=n("div",{class:"text-h6"},"Cashflow Summary",-1),Dt=n("div",{class:"text-subtitle2"},"This section gives a break down of money in and out of the deal. It is broken down twice, for best and worst case figures.",-1),Mt=n("div",null," \xA0 ",-1);function Et(e,a,s,r,t,c){const l=p("InvalidMessage");return g(),v(z,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:u(()=>[o(k,null,{default:u(()=>[zt,Dt]),_:1}),o(k,null,{default:u(()=>[o(l,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),n("div",null,[o(Ye,{columns:e.table.columns,rows:e.items,"hide-bottom":"","rows-per-page-options":[100]},{header:u(i=>[o(F,null,{default:u(()=>[o(A),o(A,{colspan:"3",class:"worstcasetablecell"},{default:u(()=>[w("Worst Case")]),_:1}),o(A,{colspan:"3"},{default:u(()=>[w("Best Case")]),_:1})]),_:1}),o(F,{props:i},{default:u(()=>[o(A,null,{default:u(()=>[w(" Item ")]),_:1}),o(A,{class:"worstcasetablecell"},{default:u(()=>[w(" In ")]),_:1}),o(A,{class:"worstcasetablecell"},{default:u(()=>[w(" Out ")]),_:1}),o(A,{class:"worstcasetablecell"},{default:u(()=>[w(" Balance ")]),_:1}),o(A,null,{default:u(()=>[w(" In ")]),_:1}),o(A,null,{default:u(()=>[w(" Out ")]),_:1}),o(A,null,{default:u(()=>[w(" Balance ")]),_:1})]),_:2},1032,["props"])]),body:u(i=>[i.row.type==="ledger"?(g(),v(F,{key:0},{default:u(()=>[o(M,{class:"tablerowcell"},{default:u(()=>[w(d(i.row.name),1)]),_:2},1024),o(M,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.worst.in)),1)]),_:2},1024),o(M,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.worst.out)),1)]),_:2},1024),o(M,{class:"worstcasetablecell valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.worst.bal)),1)]),_:2},1024),o(M,{class:"valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.best.in)),1)]),_:2},1024),o(M,{class:"valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.best.out)),1)]),_:2},1024),o(M,{class:"valuetablecell tablerowcell"},{default:u(()=>[w(d(e.format_currency(i.row.best.bal)),1)]),_:2},1024)]),_:2},1024)):b("",!0),i.row.type==="blank"?(g(),v(F,{key:1},{default:u(()=>[o(A,{colspan:"7"},{default:u(()=>[w("\xA0")]),_:1})]),_:1})):b("",!0),i.row.type==="title"?(g(),v(F,{key:2},{default:u(()=>[o(A,{colspan:"7"},{default:u(()=>[w(d(i.row.name),1)]),_:2},1024)]),_:2},1024)):b("",!0)]),_:1},8,["columns","rows"])]),Mt]),_:1})]),_:1})}var Nt=P(Vt,[["render",Et]]);const Ft=j({name:"BrrCalcDealRatingAlternativeSummary",props:["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"],methods:{format_currency(e){return N.format_currency(e)}},computed:{mortgage_rate_display(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max+"%",worst:this.finance_refinance.ltv.min+"%"}:{best:"N/A",worst:"N/A"}},mortgage(){return this.finance_refinance.userefinance?{best:this.finance_refinance.ltv.max/100*this.purchaserange.min,worst:this.finance_refinance.ltv.min/100*this.purchaserange.max}:{best:0,worst:0}},deposit(){return{best:this.purchaserange.min-this.mortgage.best,worst:this.purchaserange.max-this.mortgage.worst}},total_money_in(){return{best:this.mortgage.best+this.deposit.best+this.stampduty_total.min+this.othercosts_total.min+this.refurb_cost_total.min,worst:this.mortgage.worst+this.deposit.worst+this.stampduty_total.max+this.othercosts_total.max+this.refurb_cost_total.max}},new_mortgage_amount(){return{best:this.gdv_total.max*(this.finance_refinance.ltv.max/100),worst:this.gdv_total.min*(this.finance_refinance.ltv.min/100)}},monay_pulled_out(){return{best:this.gdv_total.max-this.new_mortgage_amount.best,worst:this.gdv_total.min-this.new_mortgage_amount.worst}},profit(){return{best:this.gdv_total.max-this.total_money_in.best,worst:this.gdv_total.min-this.total_money_in.worst}},money_left_in(){return{best:this.monay_pulled_out.best-this.profit.best,worst:this.monay_pulled_out.worst-this.profit.worst}}}}),Ot={class:"alternativetable"},Lt=n("thead",null,[n("tr",null,[n("th",{class:"text-left alternativetablecell"}),n("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),n("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Ut=n("td",{class:"text-left alternativetablecell"},"Price offered",-1),Gt={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Wt={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Qt=n("td",{class:"text-left alternativetablecell"},"Mortgage %",-1),Ht={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Yt={class:"text-right alternativetablecell yellowtablecell totaltablecell"},Kt=n("td",{class:"text-left alternativetablecell"},"Mortgage",-1),Jt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Xt={class:"text-right alternativetablecell totaltablecell"},Zt=n("td",{class:"text-left alternativetablecell"},"Deposit",-1),xt={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ea={class:"text-right alternativetablecell totaltablecell"},ta=n("td",{class:"text-left alternativetablecell"},"Stamp Duty",-1),aa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ra={class:"text-right alternativetablecell yellowtablecell totaltablecell"},sa=n("td",{class:"text-left alternativetablecell"},"Other costs (Legals, etc)",-1),na={class:"text-right alternativetablecell yellowtablecell totaltablecell"},oa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ia=n("td",{class:"text-left alternativetablecell"},"Total Refurb Costs",-1),la={class:"text-right alternativetablecell bluetablecell totaltablecell"},ca={class:"text-right alternativetablecell bluetablecell totaltablecell"},ua=n("td",{class:"text-left alternativetablecell"},"Total Money In",-1),_a={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},da={class:"text-right alternativetablecell totaltablecell"},ha=n("tr",null,[n("td",null,"\xA0"),n("td",{class:"worstcasetablecell"}),n("td")],-1),ga=n("td",{class:"text-left alternativetablecell"},"End Value",-1),fa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},pa={class:"text-right alternativetablecell yellowtablecell totaltablecell"},ma=n("td",{class:"text-left alternativetablecell"},"New Mortgage Amount",-1),wa={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},va={class:"text-right alternativetablecell totaltablecell"},ba=n("td",{class:"text-left alternativetablecell"},"Money Pulled Out",-1),ya={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Sa={class:"text-right alternativetablecell totaltablecell"},ka=n("tr",null,[n("td",null,"\xA0"),n("td",{class:"worstcasetablecell"}),n("td")],-1),$a=n("td",{class:"text-left alternativetablecell"},"Profit",-1),Ca={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},qa={class:"text-right alternativetablecell totaltablecell"},Aa=n("td",{class:"text-left alternativetablecell"},"Money Left In",-1),Ta={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},ja={class:"text-right alternativetablecell totaltablecell"};function Pa(e,a,s,r,t,c){return g(),v(Je,{"expand-separator":"",label:"Alternative summary format"},{default:u(()=>[n("div",null,[w(" This is another way of viewing the project numbers that is commonly used. I have included this for comparison. "),n("table",Ot,[Lt,n("tbody",null,[n("tr",null,[Ut,n("td",Gt,d(e.format_currency(e.purchaserange.max)),1),n("td",Wt,d(e.format_currency(e.purchaserange.min)),1)]),n("tr",null,[Qt,n("td",Ht,d(e.mortgage_rate_display.worst),1),n("td",Yt,d(e.mortgage_rate_display.best),1)]),n("tr",null,[Kt,n("td",Jt,d(e.format_currency(e.mortgage.worst)),1),n("td",Xt,d(e.format_currency(e.mortgage.best)),1)]),n("tr",null,[Zt,n("td",xt,d(e.format_currency(e.deposit.worst)),1),n("td",ea,d(e.format_currency(e.deposit.best)),1)]),n("tr",null,[ta,n("td",aa,d(e.format_currency(e.stampduty_total.max)),1),n("td",ra,d(e.format_currency(e.stampduty_total.min)),1)]),n("tr",null,[sa,n("td",na,d(e.format_currency(e.othercosts_total.max)),1),n("td",oa,d(e.format_currency(e.othercosts_total.min)),1)]),n("tr",null,[ia,n("td",la,d(e.format_currency(e.refurb_cost_total.max)),1),n("td",ca,d(e.format_currency(e.refurb_cost_total.min)),1)]),n("tr",null,[ua,n("th",_a,d(e.format_currency(e.total_money_in.worst)),1),n("th",da,d(e.format_currency(e.total_money_in.best)),1)]),ha,n("tr",null,[ga,n("td",fa,d(e.format_currency(e.gdv_total.min)),1),n("td",pa,d(e.format_currency(e.gdv_total.max)),1)]),n("tr",null,[ma,n("td",wa,d(e.format_currency(e.new_mortgage_amount.worst)),1),n("td",va,d(e.format_currency(e.new_mortgage_amount.best)),1)]),n("tr",null,[ba,n("td",ya,d(e.format_currency(e.monay_pulled_out.worst)),1),n("td",Sa,d(e.format_currency(e.monay_pulled_out.best)),1)]),ka,n("tr",null,[$a,n("td",Ca,d(e.format_currency(e.profit.worst)),1),n("td",qa,d(e.format_currency(e.profit.best)),1)]),n("tr",null,[Aa,n("td",Ta,d(e.format_currency(e.money_left_in.worst)),1),n("td",ja,d(e.format_currency(e.money_left_in.best)),1)])])]),w(" Note: The profit amounts may not match because this method does not take into account finance costs. ")])]),_:1})}var Ba=P(Ft,[["render",Pa]]);const Ia=j({name:"BrrCalcDealRatingCompareDoneup",props:["purchaserange","refurb_cost_total","gdv_total"],methods:{format_currency(e){return N.format_currency(e)},format_percent(e){return N.format_percent(e)}},computed:{total_spent(){return{worst:this.purchaserange.max+this.refurb_cost_total.max,best:this.purchaserange.min+this.refurb_cost_total.min}},gain(){return{worst:this.gdv_total.min-this.total_spent.worst,best:this.gdv_total.max-this.total_spent.best}},profit_percentage(){return{worst:this.gain.worst/this.total_spent.worst,best:this.gain.best/this.total_spent.best}}}}),Ra=n("div",{class:"text-h5"},"Compare this project to buying a done up property",-1),Va=n("div",null,"This section compares this project with buying a property that is already done up. To account for the time and risk involved with a refurbishment we expect the end value of the property to be more than if we had just bought one.",-1),za={class:"alternativetable"},Da=n("thead",null,[n("tr",null,[n("th",{class:"text-left alternativetablecell"}),n("th",{class:"text-center alternativetablecell worstcasetablecell"},"Worst case"),n("th",{class:"text-center alternativetablecell"},"Best case")])],-1),Ma=n("td",{class:"text-left alternativetablecell"},"Purchase + Refurb",-1),Ea={class:"text-right alternativetablecell worstcasetablecell"},Na={class:"text-right alternativetablecell"},Fa=n("td",{class:"text-left alternativetablecell"},"End Value",-1),Oa={class:"text-right alternativetablecell worstcasetablecell"},La={class:"text-right alternativetablecell"},Ua=n("td",{class:"text-left alternativetablecell totaltablecell"},"Gain",-1),Ga={class:"text-right alternativetablecell worstcasetablecell totaltablecell"},Wa={class:"text-right alternativetablecell totaltablecell"},Qa=n("td",{class:"text-left alternativetablecell totaltablecell"},"Percentage",-1),Ha={class:"text-right alternativetablecell worstcasetablecell finaltotaltablecell"},Ya={class:"text-right alternativetablecell finaltotaltablecell"};function Ka(e,a,s,r,t,c){return g(),T("div",null,[Ra,Va,n("table",za,[Da,n("tbody",null,[n("tr",null,[Ma,n("td",Ea,d(e.format_currency(e.total_spent.worst)),1),n("td",Na,d(e.format_currency(e.total_spent.best)),1)]),n("tr",null,[Fa,n("td",Oa,d(e.format_currency(e.gdv_total.min)),1),n("td",La,d(e.format_currency(e.gdv_total.max)),1)]),n("tr",null,[Ua,n("td",Ga,d(e.format_currency(e.gain.worst)),1),n("td",Wa,d(e.format_currency(e.gain.best)),1)]),n("tr",null,[Qa,n("td",Ha,d(e.format_percent(e.profit_percentage.worst)),1),n("td",Ya,d(e.format_percent(e.profit_percentage.best)),1)])])])])}var Ja=P(Ia,[["render",Ka]]);const Xa=j({name:"BrrCalcDealRating",props:["is_valid_input","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","purchaserange","stampduty_total","othercosts_total","refurb_cost_total"],components:{dealRatingAlternativeSummary:Ba,FeatureTable:Xe,InvalidMessage:ce,dealRatingCompareDoneup:Ja},data(){return{}},methods:{format_currency(e){return N.format_currency(e)}},computed:{features(){let e=[];var a=Math.min(this.cash_out_of_deal_minus_cash_in.best,this.cash_out_of_deal_minus_cash_in.worst);a>0?e.push({type:"positive",text:"All money out deal! - All initial investment returned plus at least "+this.format_currency(a)}):e.push({type:"negative",text:"Not all money out deal! - Might leave "+this.format_currency(-1*a)+" in."});var s=Math.min(this.profit.best,this.profit.worst);s<0?e.push({type:"negative",text:"Deal makes a loss! - End value might be "+this.format_currency(-1*s)+" less than investment."}):s<this.gdv_total.min*.25?e.push({type:"negative",text:"Low amount of profit! - Low profit "+this.format_currency(s)+" less than 25% of gdv."}):e.push({type:"positive",text:"Profit making deal! - Profit of "+this.format_currency(s)+"!"});var r=Math.min(this.annualroi.worst,this.annualroi.best);return r<3?e.push({type:"negative",text:"Very low ROI! "+r.toFixed(1)+"%"}):r>10&&e.push({type:"positive",text:"Good ROI! "+r.toFixed(1)+"%"}),e},cash_out_of_deal_minus_cash_in(){return{best:this.deal_summary_final_bal.best-this.finance_totalmoneyneeded.best,worst:this.deal_summary_final_bal.worst-this.finance_totalmoneyneeded.worst}},percent_left_in(){return this.finance_refinance.userefinance?{best:100-this.finance_refinance.ltv.max,worst:100-this.finance_refinance.ltv.min}:{best:100,worst:100}},amount_equity_left_in(){return{best:this.gdv_total.max*(this.percent_left_in.best/100),worst:this.gdv_total.min*(this.percent_left_in.worst/100)}},total_end_value(){return{best:this.amount_equity_left_in.best+this.deal_summary_final_bal.best,worst:this.amount_equity_left_in.worst+this.deal_summary_final_bal.worst}},profit(){return{best:this.total_end_value.best-this.finance_totalmoneyneeded.best,worst:this.total_end_value.worst-this.finance_totalmoneyneeded.worst}},roi(){return{best:100*this.profit.best/this.finance_totalmoneyneeded.best,worst:100*this.profit.worst/this.finance_totalmoneyneeded.worst}},annualroi(){return{worst:this.roi.worst*(12/this.refurbmonths.worst),best:this.roi.best*(12/this.refurbmonths.best)}}}}),Za=n("div",{class:"text-h6"},"Project Rating",-1),xa=n("div",{class:"text-subtitle2"},"How good is this project?",-1),er=n("div",{class:"text-h5"},"Profit/Loss",-1),tr=n("div",null,"Compare what we have put into the deal vs what we get out of it. These calculations won't account for time invested or the risk taken on in the project",-1),ar={class:"text-h5"},rr=n("div",{class:"text-h6"},"Deal Features",-1);function sr(e,a,s,r,t,c){const l=p("InvalidMessage"),i=p("dealRatingCompareDoneup"),_=p("dealRatingAlternativeSummary"),f=p("FeatureTable");return g(),v(z,{inline:"",class:"q-ma-sm card-style maincard col-grow"},{default:u(()=>[o(k,null,{default:u(()=>[Za,xa]),_:1}),o(k,null,{default:u(()=>[o(l,{is_valid_input:e.is_valid_input},null,8,["is_valid_input"]),er,tr,n("div",ar,"Total cash in: "+d(e.format_currency(e.finance_totalmoneyneeded.worst))+" - "+d(e.format_currency(e.finance_totalmoneyneeded.best))+" Worst - Best",1),o(i,{purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","refurb_cost_total","gdv_total"])]),_:1}),o(k,null,{default:u(()=>[o(_,{purchaserange:e.purchaserange,finance_refinance:e.finance_refinance,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,gdv_total:e.gdv_total},null,8,["purchaserange","finance_refinance","stampduty_total","othercosts_total","refurb_cost_total","gdv_total"])]),_:1}),o(k,null,{default:u(()=>[rr,o(f,{features:e.features,"onUpdate:features":a[0]||(a[0]=h=>e.features=h)},null,8,["features"])]),_:1})]),_:1})}var nr=P(Xa,[["render",sr]]);const or=j({name:"PatchAgentInput",props:["ever_saved","loaded_project_id","patch_id","selling_agent","selling_agent_id"],emits:["update:selling_agent","update:selling_agent_id"],components:{PatchAgentNotes:le},setup(){const e=U(),a=x();return{backend_connection_store:e,dataCachesStore:a}},data(){return{add_dialog:{visible:!1,agent_name:""},edit_dialog:{visible:!1},loaded:!1}},watch:{patch_id(e,a){this.loaded=!1,this.refresh()}},computed:{patchagents_data(){return this.dataCachesStore.get_direct_from_cache({object_type:"patchagents",object_id:this.patch_id})},caculated_selling_agent(){return typeof this.patchagents_data=="undefined"||typeof this.patchagents_data.agents=="undefined"||typeof this.selling_agent_id=="undefined"||this.selling_agent_id===""?"":this.patchagents_data.agents[this.selling_agent_id].agent_name},notesbtnicon(){return this.selling_agent_id===""?"note_add":"edit_document"},notesbtncolour(){return this.selling_agent_id===""?"undefined":"primary"},createbtndisable(){return this.add_dialog.agent_name===""?!0:!this.loaded},add_dialog_linking_item(){const e=this,a=this.known_agent_list_unfiltered.filter(function(s){var t;const r=(t=e==null?void 0:e.add_dialog)==null?void 0:t.agent_name;return r==null||r===""?!1:s.label.toLowerCase()===e.add_dialog.agent_name.toLowerCase()});return a.length===0?{id:void 0,label:"None"}:a[0]},adddialogcreatebuttonlabel(){return typeof this.add_dialog_linking_item.id=="undefined"?"Create":"Link"},known_agent_list_unfiltered(){const e=this;if(typeof this.patchagents_data.agents=="undefined")return[];var a=[];return Object.keys(this.patchagents_data.agents).forEach(function(s){a.push({id:s,label:e.patchagents_data.agents[s].agent_name})}),a},known_agent_list(){const e=this;return this.known_agent_list_unfiltered.filter(function(a){var r;const s=(r=e==null?void 0:e.add_dialog)==null?void 0:r.agent_name;return s==null||s===""?!0:a.label.toLowerCase().includes(e.add_dialog.agent_name.toLowerCase())})}},methods:{refresh(){var e=this;if(e.patch_id==="notset"){console.log("Patch ID not set can not load");return}const a={ok:e.load_patchagents_api_success,error:e.load_patchagents_api_fail};e.dataCachesStore.get({backend_connection_store:e.backend_connection_store,object_type:"patchagents",object_id:e.patch_id,skip_cache:!1,callback:a})},load_patchagents_api_fail(e){console.log("patchagents load failed",e)},load_patchagents_api_success(e){this.loaded=!0},updateSellingAgent(e){this.$emit("update:selling_agent",e)},updateSellingAgentId(e){this.$emit("update:selling_agent_id",e)},notesbtnclick(){const e=this;!this.ever_saved||(this.selling_agent_id===""?(this.add_dialog.agent_name=this.selling_agent,this.add_dialog.visible=!0):(this.edit_dialog.visible=!0,setTimeout(function(){const a=e.patchagents_data.agents[e.selling_agent_id];e.$refs.PatchAgentNotes.init(a.agent_name,a.agent_notes,a.projects,e.loaded_project_id)},100)))},createbtnclick(){const e=this;if(this.add_dialog.agent_name==="")return;const a={ok:e.createbtnclick_create_saveagentpatches_success,error:e.createbtnclick_create_saveagentpatches_fail};if(typeof this.add_dialog_linking_item.id=="undefined"){const s=ot(),r={agent_name:this.add_dialog.agent_name,agent_notes:"",projects:[this.loaded_project_id]};this.patchagents_data.agents[s]=r,this.updateSellingAgentId(s),this.updateSellingAgent(""),e.dataCachesStore.save({backend_connection_store:e.backend_connection_store,object_type:"patchagents",object_data:e.patchagents_data,callback:a})}else{if(this.updateSellingAgentId(this.add_dialog_linking_item.id),this.updateSellingAgent(""),this.patchagents_data.agents[this.add_dialog_linking_item.id].projects.includes(this.loaded_project_id)){this.add_dialog.visible=!1,this.edit_dialog.visible=!0,setTimeout(function(){const s=e.patchagents_data.agents[e.selling_agent_id];e.$refs.PatchAgentNotes.init(s.agent_name,s.agent_notes,s.projects,e.loaded_project_id)},100);return}e.patchagents_data.agents[this.add_dialog_linking_item.id].projects.push(e.loaded_project_id),e.dataCachesStore.save({backend_connection_store:e.backend_connection_store,object_type:"patchagents",object_data:e.patchagents_data,callback:a})}},createbtnclick_create_saveagentpatches_fail(e){if(console.log("createbtnclick_create_saveagentpatches_fail",e),typeof e.response!="undefined"&&typeof e.response.data!="undefined"&&typeof e.response.data.message!="undefined"){I.create({color:"bg-grey-2",message:e.response.data.message,timeout:2e3,color:"negative"});return}I.create({color:"bg-grey-2",message:e.message,timeout:2e3,color:"negative"})},createbtnclick_create_saveagentpatches_success(e){const a=this;this.add_dialog.visible=!1,this.edit_dialog.visible=!0,setTimeout(function(){const s=a.patchagents_data.agents[a.selling_agent_id];a.$refs.PatchAgentNotes.init(s.agent_name,s.agent_notes,s.projects,a.loaded_project_id)},100)},editdialogsavebtnclick(){const e=this.$refs.PatchAgentNotes.get_agent_data();this.patchagents_data.agents[this.selling_agent_id].agent_name=e.agent_name,this.patchagents_data.agents[this.selling_agent_id].agent_notes=e.agent_notes;const a={ok:this.createbtnclick_create_editagentpatches_success,error:this.createbtnclick_create_saveagentpatches_fail};this.dataCachesStore.save({backend_connection_store:this.backend_connection_store,object_type:"patchagents",object_data:this.patchagents_data,callback:a})},createbtnclick_create_editagentpatches_success(e){this.edit_dialog.visible=!1},unlinkfromagentnotesbtnclick(){const e=this,a=e.dataCachesStore.get_direct_from_cache({object_type:"projects",object_id:this.loaded_project_id});var s="";typeof a.project_name!="undefined"&&(s=a.project_name),this.$q.dialog({title:"Unlink agent notes",message:'This will unlink these notes from the project "'+s+'". Are you sure?',html:!1,ok:{push:!0,label:"Unlink",color:"red"},cancel:{push:!0,label:"Cancel",color:"primary"}}).onOk(r=>{e.unlinkfromagentnotesbtn()})},unlinkfromagentnotesbtn(){const e=this;if(!this.selling_agent_id in this.patchagents_data.agents){console.log("WARNING - agent not found. Just unlinking agentid",this.selling_agent_id),console.log("agents",this.patchagents_data.agents),this.edit_dialog.visible=!1,this.updateSellingAgentId("");return}if(!1 in this.patchagents_data.agents[this.selling_agent_id]){console.log("WARNING - invalid agent format. Just unlinking"),this.edit_dialog.visible=!1,this.updateSellingAgentId("");return}this.patchagents_data.agents[this.selling_agent_id].projects=this.patchagents_data.agents[this.selling_agent_id].projects.filter(function(s){return s!==e.loaded_project_id}),this.updateSellingAgentId("");const a={ok:this.createbtnclick_create_editagentpatches_success,error:this.createbtnclick_create_saveagentpatches_fail};this.dataCachesStore.save({backend_connection_store:this.backend_connection_store,object_type:"patchagents",object_data:this.patchagents_data,callback:a})}},mounted(){this.refresh()}}),ir={class:"row"},lr=n("div",{class:"text-h6"},"Add notes to selling agent",-1),cr={class:"row"},ur=n("div",{class:"text-h6"},"Selling Agent Notes",-1),_r={class:"row full-width"};function dr(e,a,s,r,t,c){const l=p("PatchAgentNotes");return g(),T("div",ir,[e.selling_agent_id===""?(g(),v(B,{key:0,filled:"",clearable:"","model-value":e.selling_agent,"onUpdate:modelValue":e.updateSellingAgent,label:"Selling Agent",class:"col"},null,8,["model-value","onUpdate:modelValue"])):b("",!0),e.selling_agent_id!==""?(g(),v(B,{key:1,filled:"",readonly:"","model-value":e.caculated_selling_agent,label:"Selling Agent",class:"col"},null,8,["model-value"])):b("",!0),e.ever_saved?(g(),v($,{key:2,color:e.notesbtncolour,onClick:e.notesbtnclick,class:"patchagentinput-notesbutton",icon:e.notesbtnicon},null,8,["color","onClick","icon"])):b("",!0),o(J,{modelValue:e.add_dialog.visible,"onUpdate:modelValue":a[2]||(a[2]=i=>e.add_dialog.visible=i)},{default:u(()=>[o(z,null,{default:u(()=>[o(k,{class:"row items-center q-pb-none"},{default:u(()=>[lr,o(X),O(o($,{icon:"close",flat:"",round:"",dense:""},null,512),[[Z]])]),_:1}),o(k,null,{default:u(()=>[n("div",cr,[o(B,{filled:"",clearable:"",modelValue:e.add_dialog.agent_name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.add_dialog.agent_name=i),label:"Agent Name",class:"col"},null,8,["modelValue"]),o($,{color:"primary",onClick:e.createbtnclick,label:e.adddialogcreatebuttonlabel,class:"patchagentinput-adddialogcreatebutton",disable:e.createbtndisable},null,8,["onClick","label","disable"])]),n("div",null,[o(Ke,{style:{height:"200px"},items:e.known_agent_list,separator:""},{default:u(({item:i,index:_})=>[(g(),v(nt,{key:_,dense:""},{default:u(()=>[o(st,{onClick:f=>this.add_dialog.agent_name=i.label},{default:u(()=>[o(rt,null,{default:u(()=>[w(d(i.label),1)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))]),_:1},8,["items"])]),o(K,{align:"right",class:"text-primary"},{default:u(()=>[o($,{label:"Cancel",onClick:a[1]||(a[1]=i=>this.add_dialog.visible=!1)})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(J,{modelValue:e.edit_dialog.visible,"onUpdate:modelValue":a[4]||(a[4]=i=>e.edit_dialog.visible=i)},{default:u(()=>[o(z,{class:"patchagentinput-qcard"},{default:u(()=>[o(k,{class:"row items-center q-pb-none"},{default:u(()=>[ur,o(X),O(o($,{icon:"close",flat:"",round:"",dense:""},null,512),[[Z]])]),_:1}),o(k,{class:"full-width"},{default:u(()=>[n("div",_r,[o(l,{ref:"PatchAgentNotes"},null,512)]),o(K,{align:"right",class:"text-primary full-width"},{default:u(()=>[o($,{icon:"link_off",onClick:e.unlinkfromagentnotesbtnclick},null,8,["onClick"]),o($,{label:"Cancel",onClick:a[3]||(a[3]=i=>this.edit_dialog.visible=!1)}),o($,{color:"primary",label:"Save",onClick:e.editdialogsavebtnclick},null,8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var hr=P(or,[["render",dr]]);function ne(){return{type:"self",value:""}}const gr=j({name:"DealBasicInfo",emits:["projectchanged","navigate_away","patchidchanged","sellingagentidchanged"],props:["ever_saved","loaded_project_id"],components:{Weblinks:xe,PatchAgentInput:hr},setup(){return{backend_connection_store:U()}},data(){return{patch:{id:"notset",name:"Not Set"},address:"",postcode:"",weblinks:[],new_patch_value:"",selling_agent:"",selling_agent_id:"",notes:"",emit_project_change_notification:!0,deal_source:ne(),deal_source_local_only:{self_check_box:!0,value:""}}},watch:{"patch.id"(e,a){this.$emit("patchidchanged",e)},selling_agent_id(e,a){this.$emit("sellingagentidchanged",e)},serializer_card_data(e){this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:serializer")}},computed:{deal_source_is_self(){return this.deal_source.type==="self"},serializer_card_data(){return{patch_id:this.patch.id,address:this.address,postcode:this.postcode,weblinks:this.weblinks,selling_agent:this.selling_agent,selling_agent_id:this.selling_agent_id,notes:this.notes,deal_source:this.deal_source}},reason_project_not_savable(){return this.patch.id==="notset"?"Select patch":typeof this.address=="undefeind"||this.address===null||this.address.length<3?"Enter address":""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},patch_list(){return this.backend_connection_store.user_profile.patches.concat([{id:"create",name:"Add..."}])}},methods:{apiaddweblink(e){return this.$refs.Weblinks.apiaddweblink(e)},updatedealsource(){let e="self";this.deal_source_local_only.self_check_box===!1&&(e="text");let a=this.deal_source_local_only.value;this.deal_source={type:e,value:a}},updateweblinks(e){this.weblinks=e,this.emit_project_change_notification&&this.$emit("projectchanged","DealBasicInfo:updateweblinks")},serializer_load_data(e){this.emit_project_change_notification=!1,this.address=e.address,this.postcode=e.postcode,this.weblinks=e.weblinks,this.selling_agent=e.selling_agent,typeof e.selling_agent_id=="undefined"?this.selling_agent_id="":this.selling_agent_id=e.selling_agent_id,this.notes=e.notes,this.patch=this.patch_list.filter(function(s){return s.id===e.patch_id})[0],typeof e.deal_source=="undefined"?this.deal_source=ne():this.deal_source=e.deal_source,this.deal_source_local_only.self_check_box=this.deal_source.type==="self",this.deal_source_local_only.value=this.deal_source.value,this.updatedealsource();const a=this;setTimeout(function(){a.emit_project_change_notification=!0,a.changed=!1,a.autosave_seconds_left=-1},50)},select_patch_by_id(e){this.patch=this.patch_list.filter(function(a){return a.id===e})[0]},select_patch(e){if(e.id==="create"){const a=this;this.$q.dialog({title:"Add new patch",message:"Enter the name for the new patch",html:!1,ok:{push:!0,label:"Ok"},cancel:{push:!0,label:"Cancel"},prompt:{model:"",type:"text"}}).onOk(s=>{a.new_patch_value=s;const r={ok:a.createpatchcallback,error:function(c){I.create({color:"negative",message:"Create patch failed "+c.response.data.message,timeout:2e3})}},t={patch_name:s};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/me/patches",method:"POST",data:t,callback:r})})}},createpatchcallback(e){this.backend_connection_store.update_user_profile({user_profile:e.data.user_profile,then:this.createpatchcallback2})},createpatchcallback2(){const e=this;this.patch=this.patch_list.filter(function(a){return a.name===e.new_patch_value})[0],this.new_patch_value=""},isEmpty(e){return e==null?!0:e.length==0},copy_text(e){const a={ok:function(s){I.create({color:"bg-grey-2",message:"Copied to clipboard",timeout:2e3})},error:function(s){I.create({color:"negative",message:"Copy failed",timeout:2e3})}};Ve.copyTextToClipboard2(e,a)}}}),fr=n("div",{class:"text-h6"},"Basic Information",-1),pr=n("div",{class:"text-subtitle2"},"Basic information about this project",-1),mr={key:0},wr={key:1,class:"brrcalc-dealbasicinfo-patch"},vr=n("div",{class:"text-h6"},"Weblinks",-1),br=n("div",null,"Deal Source",-1);function yr(e,a,s,r,t,c){const l=p("Weblinks"),i=p("PatchAgentInput");return e.security_role_cansave?(g(),v(z,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:u(()=>[o(k,null,{default:u(()=>[fr,pr]),_:1}),o(k,null,{default:u(()=>[e.ever_saved?b("",!0):(g(),T("div",mr,[o(Ze,{modelValue:e.patch,"onUpdate:modelValue":[a[0]||(a[0]=_=>e.patch=_),e.select_patch],options:e.patch_list,label:"Patch","emit-value":"","option-label":"name"},null,8,["modelValue","options","onUpdate:modelValue"])])),e.ever_saved?(g(),T("div",wr,[w(" Patch: "),o($,{flat:"",onClick:a[1]||(a[1]=_=>e.$emit("navigate_away",{dest:"/tools/cansave/patches/"+e.patch.id}))},{default:u(()=>[w(d(e.patch.name),1)]),_:1})])):b("",!0),n("div",null,[o(B,{filled:"",clearable:"",modelValue:e.address,"onUpdate:modelValue":a[2]||(a[2]=_=>e.address=_),label:"Address"},null,8,["modelValue"])]),n("div",null,[o(B,{filled:"",clearable:"",modelValue:e.postcode,"onUpdate:modelValue":a[4]||(a[4]=_=>e.postcode=_),label:"Postcode"},{append:u(()=>[e.isEmpty(e.postcode)?b("",!0):(g(),v(Re,{key:0,class:"q-field__focusable-action",name:"content_copy",onClick:a[3]||(a[3]=_=>e.copy_text(e.postcode))}))]),_:1},8,["modelValue"])])]),_:1}),o(W,{class:"basic-info-seperator"}),o(k,null,{default:u(()=>[n("div",null,[vr,o(l,{ref:"Weblinks",weblinks:e.weblinks,onUpdateweblinks:e.updateweblinks},null,8,["weblinks","onUpdateweblinks"])]),o(W,{class:"basic-info-seperator"}),n("div",null,[o(i,{ever_saved:e.ever_saved,loaded_project_id:e.loaded_project_id,patch_id:e.patch.id,selling_agent:e.selling_agent,selling_agent_id:e.selling_agent_id,"onUpdate:selling_agent":a[5]||(a[5]=_=>e.selling_agent=_),"onUpdate:selling_agent_id":a[6]||(a[6]=_=>e.selling_agent_id=_)},null,8,["ever_saved","loaded_project_id","patch_id","selling_agent","selling_agent_id"])]),o(W,{class:"basic-info-seperator"}),n("div",null,[o(B,{filled:"",autogrow:"",modelValue:e.notes,"onUpdate:modelValue":a[7]||(a[7]=_=>e.notes=_),label:"Notes"},null,8,["modelValue"])]),o(W,{class:"basic-info-seperator"}),br,n("div",null,[o(L,{modelValue:e.deal_source_local_only.self_check_box,"onUpdate:modelValue":[a[8]||(a[8]=_=>e.deal_source_local_only.self_check_box=_),e.updatedealsource],label:"Self sourced"},null,8,["modelValue","onUpdate:modelValue"])]),n("div",null,[o(B,{filled:"",autogrow:"",modelValue:e.deal_source_local_only.value,"onUpdate:modelValue":[a[9]||(a[9]=_=>e.deal_source_local_only.value=_),e.updatedealsource],label:"Name of source",disable:e.deal_source_local_only.self_check_box},null,8,["modelValue","disable","onUpdate:modelValue"])])]),_:1})]),_:1})):b("",!0)}var Sr=P(gr,[["render",yr]]);function kr(e,a,s){const r=[];r.push({range:"Main!A1",values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),r.push({range:"Main!A2:B2",values:[["Patch:",a.patch.name]]}),r.push({range:"Main!A3:B3",values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),r.push({range:"Main!E3:E3",values:[[a.serialized_data.dealbasicinfo.postcode]]}),r.push({range:"Main!A4:A4",values:[["Links:"]]});let t=3;return a.serialized_data.dealbasicinfo.weblinks.forEach(function(c){t=t+1,r.push({range:"Main!B"+t.toString()+":B"+t.toString(),values:[['=HYPERLINK("'+c.label+'", "'+c.label+'")']]})}),t=t+1,t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Selling Agent:",a.serialized_data.dealbasicinfo.selling_agent]]}),t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Notes:",a.serialized_data.dealbasicinfo.notes]]}),t=t+1,r.push({range:"Main!A"+t.toString()+":B"+t.toString(),values:[["Vision:",a.serialized_data.vision.devplan]]}),t=t+1,t=t+1,r.push({range:"Main!A"+t.toString()+":A"+t.toString(),values:[["Caculations provided here are for reference only and should be manually checked."]]}),r}function $r(e,a,s){const r=[];return r.push({repeatCell:{range:{sheetId:s.Main,startRowIndex:0,endRowIndex:a.serialized_data.dealbasicinfo.weblinks.length+6+1,startColumnIndex:0,endColumnIndex:1},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}),r}var oe={get_sheet_main_values:kr,get_sheet_main:$r};function Cr(e){function a(s,r,t,c,l){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:c},cell:{userEnteredFormat:{numberFormat:{type:"NUMBER",pattern:l}}},fields:"userEnteredFormat.numberFormat"}}}return{makeboldandvaligntop:function(s,r,t,c){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:c},cell:{userEnteredFormat:{textFormat:{bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeitalicandvaligntop:function(s,r,t,c){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:c},cell:{userEnteredFormat:{textFormat:{italic:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},makeboldandvaligntopandsetfontsize:function(s,r,t,c,l){return{repeatCell:{range:{sheetId:e,startRowIndex:s,endRowIndex:r,startColumnIndex:t,endColumnIndex:c},cell:{userEnteredFormat:{textFormat:{fontSize:l,bold:!0},verticalAlignment:"TOP"}},fields:"userEnteredFormat(textFormat, verticalAlignment)"}}},formatnumbermisc:function(s,r,t,c,l){return a(s,r,t,c,l)},formatcurrency:function(s,r,t,c){return a(s,r,t,c,"[$\xA3-809]#,##0.00")},formatpercentage:function(s,r,t,c){return a(s,r,t,c,"0.00%")},adjustcolumnwidth:function(s,r){return{updateDimensionProperties:{range:{sheetId:e,dimension:"COLUMNS",startIndex:s,endIndex:s+1},properties:{pixelSize:r},fields:"pixelSize"}}}}}var G={get_sheet_utils:Cr};const m="Purchase Phase",_e="Bridge Amount";function qr(e,a,s){return{name:"Buying Cash",pre_stage:function(r){},start_details:function(r){return[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(r){return[]}}}function Ar(e,a,s){return{name:"Buying with a Mortgage",pre_stage:function(r,t){const c=[],l=r.cur_row;r.cur_row=r.cur_row+1,r.value_requests.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["","Worst","Best"]]}),r.requests.push(t.makeboldandvaligntop(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]}),r.requests.push(t.formatcurrency(l,r.cur_row,1,3)),r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Mortage Rate",a.serialized_data.finance.mortgage.rate.max/100,a.serialized_data.finance.mortgage.rate.min/100]]}),r.requests.push(t.formatpercentage(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Mortgage LTV",a.serialized_data.finance.mortgage.ltv.max/100,a.serialized_data.finance.mortgage.ltv.min/100]]}),r.requests.push(t.formatpercentage(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Total Mortgage","=B"+(l+2).toString()+"*B"+(r.cur_row-1).toString(),"=C"+(l+2).toString()+"*C"+(r.cur_row-1).toString()]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Monthly Payments","=(B"+(r.cur_row-1).toString()+"*B"+(l+3).toString()+")/12","=(C"+(r.cur_row-1).toString()+"*C"+(l+3).toString()+")/12"]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.misc_data.monthly_payments_row=r.cur_row,r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Deposit","=B"+(l+2).toString()+"-B"+(r.cur_row-2).toString(),"=C"+(l+2).toString()+"-C"+(r.cur_row-2).toString()]]}),r.requests.push(t.formatcurrency(r.cur_row-1,r.cur_row,1,3)),r.misc_data.deposit_row=r.cur_row,r.cur_row=r.cur_row+1,c.push({range:m+"!A"+r.cur_row.toString()+":C"+r.cur_row.toString(),values:[["Refurb Duration Months",a.serialized_data.refurbcost.refurbtimerange.max,a.serialized_data.refurbcost.refurbtimerange.min]]}),r.requests.push(t.formatnumbermisc(r.cur_row-1,r.cur_row,1,3,"0")),r.misc_data.refurb_duration_row=r.cur_row,r.requests.push(t.makeboldandvaligntop(l,r.cur_row,0,1)),r.cur_row=r.cur_row+1,r.value_requests.push(c)},start_details:function(r){return[["Deposit","=B"+r.misc_data.deposit_row.toString(),"=C"+r.misc_data.deposit_row.toString()],["Mortgage Arangement",a.serialized_data.finance.mortgage.arrangementfee,a.serialized_data.finance.mortgage.arrangementfee]]},end_details:function(r){return[["Mortgage Payments","=B"+r.misc_data.monthly_payments_row.toString()+"*B"+r.misc_data.refurb_duration_row.toString(),"=C"+r.misc_data.monthly_payments_row.toString()+"*C"+r.misc_data.refurb_duration_row.toString()],["(During refurbishment)","",""]]}}}function Tr(e,a,s){return{name:"Buying with a Bridge",pre_stage:function(r){},start_details:function(r){return[["Purchase Price",a.serialized_data.purchaseprice.purchaserangevalue.max,a.serialized_data.purchaseprice.purchaserangevalue.min]]},end_details:function(r){return[["Bridge Costs",a.finance_bridgecost.worst,a.finance_bridgecost.best],[_e,a.finance_bridgeamount.worst*-1,a.finance_bridgeamount.best*-1]]}}}function jr(e,a,s){return a.serialized_data.finance.mortgage.usemortgage?Ar(e,a):a.serialized_data.finance.bridge.usebridge?Tr(e,a):qr(e,a)}function Pr(e,a,s){const r=G.get_sheet_utils(s[m]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};t.requests.push(r.adjustcolumnwidth(0,170)),t.cur_row=t.cur_row+1,t.value_requests.push({range:m+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",a.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:m+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[a.serialized_data.dealbasicinfo.postcode]]}),t.requests.push(r.makeboldandvaligntop(0,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const c=jr(e,a);t.cur_row=t.cur_row+1,t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[c.name]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),c.pre_stage(t,r),t.cur_row=t.cur_row+1,t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["","Worst","Best"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,1,3));const l=t.cur_row;let i=c.start_details(t);i.push(["Refurbishment",a.refurb_cost_total.max,a.refurb_cost_total.min]),i.push(["Stamp Duty",a.stampduty_total.max,a.stampduty_total.min]),a.othercosts_items_detail.forEach(function(h){i.push([h.name,-1*h.worst,-1*h.best])}),a.caculated_loan_details.forEach(function(h){i.push([h.name,h.amount*-1,h.amount*-1]),i.push([h.name+" interest",h.interest,h.interest])}),i=i.concat(c.end_details(t));let _={};i.forEach(function(h){t.cur_row=t.cur_row+1,_[h[0]]=t.cur_row,t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[[h[0],h[1],h[2]]]}),h[0]==="(During refurbishment)"?t.requests.push(r.makeitalicandvaligntop(t.cur_row-1,t.cur_row,0,1)):t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1))}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const f=t.cur_row;return t.value_requests.push({range:m+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Total Money needed","=SUM(B"+(l+1).toString()+":B"+(t.cur_row-1).toString()+")","=SUM(C"+(l+1).toString()+":C"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,3)),t.requests.push(r.formatcurrency(l,t.cur_row,1,3)),a.serialized_data.refinance.refinance_userefinance&&Br(t,r,a,f,_),{value_requests:t.value_requests,requests:t.requests}}function Br(e,a,s,r,t){e.cur_row=e.cur_row+1,e.cur_row=e.cur_row+1,e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Refinance"]]}),e.requests.push(a.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,1)),e.cur_row=e.cur_row+1;const c=e.cur_row;e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["GDV",s.gdv_total.min,s.gdv_total.max]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const l=e.cur_row;e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance LTV",s.serialized_data.refinance.refinance_userefinance_ltv.min/100,s.serialized_data.refinance.refinance_userefinance_ltv.max/100]]}),e.requests.push(a.formatpercentage(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1,e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance Rate",s.serialized_data.refinance.refinance_userefinance_rate.min/100,s.serialized_data.refinance.refinance_userefinance_rate.max/100]]}),e.requests.push(a.formatpercentage(e.cur_row-1,e.cur_row,1,3)),e.cur_row=e.cur_row+1;const i=e.cur_row;e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Refinance mortgage total","=B"+c.toString()+"*B"+l.toString(),"=C"+c.toString()+"*C"+l.toString()]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3));let _,f;function h(){typeof _=="undefined"&&(_=e.cur_row),f=e.cur_row}if(s.serialized_data.finance.bridge.usebridge){const S=t[_e];e.cur_row=e.cur_row+1,h(),e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Pay back bridge","=B"+S.toString()+" * -1","=C"+S.toString()+" * -1"]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3))}s.refinance_costs.forEach(function(S){e.cur_row=e.cur_row+1,h(),e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[[S.name,S.worst*-1,S.best*-1]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3))}),s.caculated_loan_details.forEach(function(S){e.cur_row=e.cur_row+1,h(),e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Pay back "+S.name,S.amount,S.amount]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3))}),e.cur_row=e.cur_row+1;const q=e.cur_row;e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Total after deductions","=B"+i.toString()+"-sum(B"+_.toString()+":B"+f.toString()+")","=C"+i.toString()+"-sum(C"+_.toString()+":C"+f.toString()+")"]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.requests.push(a.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,3)),e.cur_row=e.cur_row+1;const R=e.cur_row;e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Original Money in","=B"+r.toString(),"=C"+r.toString()]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.requests.push(a.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,3)),e.cur_row=e.cur_row+1,e.value_requests.push({range:m+"!A"+e.cur_row.toString()+":C"+e.cur_row.toString(),values:[["Amount Left in the deal","=B"+R.toString()+"-B"+q.toString(),"=C"+R.toString()+"-C"+q.toString()]]}),e.requests.push(a.formatcurrency(e.cur_row-1,e.cur_row,1,3)),e.requests.push(a.makeboldandvaligntop(e.cur_row-1,e.cur_row,0,3))}var Ir={sheet_name:m,get_sheet_values:Pr};const V="GDV Comparables";function Rr(e,a,s){const r=G.get_sheet_utils(s[V]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const c=[120,246,100,74,100,100,47,100,100,100,145,100,198];let l=0;for(;l<c.length;)t.requests.push(r.adjustcolumnwidth(l,c[l])),l++;t.cur_row=t.cur_row+1,t.value_requests.push({range:V+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:V+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",a.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:V+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:V+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[a.serialized_data.dealbasicinfo.postcode]]}),t.cur_row=t.cur_row+1,["EPC Floorspace:","Type:","Condition:","Sold History"].forEach(function(q){t.value_requests.push({range:V+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[[q]]}),t.cur_row=t.cur_row+1}),t.requests.push(r.makeboldandvaligntop(0,t.cur_row-1,0,1)),t.cur_row=t.cur_row+6,t.value_requests.push({range:V+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["Source","Address","Type","Price type","Amount","Date","SQM","price per sqm","Condition","Value of ours","Distance","Place","Notes"]]}),t.cur_row=t.cur_row+1,t.requests.push(r.makeboldandvaligntop(t.cur_row-2,t.cur_row-1,0,13));const _=t.cur_row;let f=0;for(;f<15;)t.value_requests.push({range:V+"!A"+t.cur_row.toString()+":M"+t.cur_row.toString(),values:[["","","","SOLD","","","","=E"+t.cur_row.toString()+"/G"+t.cur_row.toString(),"","=H"+t.cur_row.toString()+"*$B$4","","",""]]}),t.cur_row=t.cur_row+1,f++;const h=t.cur_row;return t.requests.push(r.formatcurrency(_-1,h-1,4,5)),t.requests.push(r.formatcurrency(_-1,h-1,7,8)),t.requests.push(r.formatcurrency(_-1,h-1,9,10)),{value_requests:t.value_requests,requests:t.requests}}var Vr={sheet_name:V,get_sheet_values:Rr};function zr(e,a,s,r,t){e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString(),values:[[t]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Patch:",s.patch.name]]}),e.cur_row=e.cur_row+1,e.value_requests.push({range:a+"!A"+e.cur_row.toString()+":B"+e.cur_row.toString(),values:[["Address:",s.serialized_data.dealbasicinfo.address]]}),e.requests.push(r.makeboldandvaligntop(0,e.cur_row,0,1)),e.cur_row=e.cur_row+1}var de={header:zr};const y="HMO Monthly Profit Estimate";function Dr(e,a,s){const r=G.get_sheet_utils(s[y]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const c=[100,100,100,100,30];let l=0;for(;l<c.length;)t.requests.push(r.adjustcolumnwidth(l,c[l])),l++;de.header(t,y,a,r,"Comparison of HMO income vs running costs"),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Caculation"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":F"+t.cur_row.toString(),values:[["Option 1","","","","","Option 2"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Room","Num","Monthly Rate","Total","","Room","Num","Monthly Rate","Total"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9));const i=[["Ensuite","-1","550"],["Non-ensuite","-1","500"],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]],_=t.cur_row;i.forEach(function(S){t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[[S[0],S[1],S[2],"=B"+t.cur_row.toString()+"*C"+t.cur_row.toString(),"",S[0],S[1],S[2],"=G"+t.cur_row.toString()+"*H"+t.cur_row.toString()]]})}),t.cur_row=t.cur_row+1;const f=t.cur_row;t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":I"+t.cur_row.toString(),values:[["Total","=sum(B"+(_+1).toString()+":B"+(t.cur_row-1).toString()+")","","=sum(D"+(_+1).toString()+":D"+(t.cur_row-1).toString()+")","","Total","=sum(G"+(_+1).toString()+":G"+(t.cur_row-1).toString()+")","","=sum(I"+(_+1).toString()+":I"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,9)),t.requests.push(r.formatcurrency(_-1,t.cur_row,2,4)),t.requests.push(r.formatcurrency(_-1,t.cur_row,7,9)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const h=t.cur_row;t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Used Figure","=D"+f.toString(),"(Select the total of the option above to use for the profit caculation)"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Monthly Costs"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const q=t.cur_row;t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Management","=B"+h.toString()+"*0.15","(assumed 15%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Maintainance","=B"+h.toString()+"*0.1","(10%)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["Council tax","=1370.41/12","TODO VERIFY","(Put Band and link to local authority council tax page here as a note)"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Gas","155","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Electric","120","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Water","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Internet","40","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Building insurance","60","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company insurance",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["Company account",""]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":C"+t.cur_row.toString(),values:[["TV Licence","14.13","TODO VERIFY"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":D"+t.cur_row.toString(),values:[["HMO Licence","16.25","TODO VERIFY","(Place link to council HMO licencing page here)"]]}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const R=t.cur_row;return t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Spend","=sum(B"+q.toString()+":B"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:y+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Monthly Profit","=B"+h.toString()+"-B"+R.toString()]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,2)),t.requests.push(r.formatcurrency(q-1,t.cur_row,1,2)),{value_requests:t.value_requests,requests:t.requests}}var Mr={sheet_name:y,get_sheet_values:Dr};const E="HMO Room Sizes";function Er(e,a,s){const r=G.get_sheet_utils(s[E]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};const c=[130,100,58,58,100,200,200];let l=0;for(;l<c.length;)t.requests.push(r.adjustcolumnwidth(l,c[l])),l++;de.header(t,E,a,r,"List of room sizes to check against licence standards"),t.cur_row=t.cur_row+1,t.value_requests.push({range:E+"!A"+t.cur_row.toString()+":A"+t.cur_row.toString(),values:[["Total area (sqm)"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,1)),t.cur_row=t.cur_row+1;const i=t.cur_row;return t.value_requests.push({range:E+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["Level","Room on plan","x","y","sqm","Reconfig Use","Notes"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),[["Ground","Kitchen","-1","-1"],["Ground","Dinning Room","-1","-1"],["Bedroom","Dinning Room","-1","-1"],["","","2",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""],["","","",""]].forEach(function(f){t.cur_row=t.cur_row+1,t.value_requests.push({range:E+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[[f[0],f[1],f[2],f[3],"=C"+t.cur_row.toString()+"*D"+t.cur_row.toString(),"",""]]})}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:E+"!A"+t.cur_row.toString()+":G"+t.cur_row.toString(),values:[["","","","Total","=sum(E"+(i+1).toString()+":E"+(t.cur_row-1).toString()+")","",""]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,7)),{value_requests:t.value_requests,requests:t.requests}}var Nr={sheet_name:E,get_sheet_values:Er};const C="Refurb Cost",ie=["Clear out (Skips)?","Windows?","Electric?","Boiler?","Fire Doors?","Fire alarm system?","Roof?","Decorate?","EPC Works?"],Fr=25;function Or(e,a,s){const r=G.get_sheet_utils(s[C]);let t={cur_row:0,requests:[],value_requests:[],misc_data:{}};t.requests.push(r.adjustcolumnwidth(0,115)),t.requests.push(r.adjustcolumnwidth(1,149)),t.requests.push(r.adjustcolumnwidth(2,182)),t.requests.push(r.adjustcolumnwidth(3,110)),t.requests.push(r.adjustcolumnwidth(4,110)),t.cur_row=t.cur_row+1,t.value_requests.push({range:C+"!A"+t.cur_row.toString(),values:[['=HYPERLINK("www.evernetproperties.com", "Project calculation generated by www.evernetproperties.com")']]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Patch:",a.patch.name]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":B"+t.cur_row.toString(),values:[["Address:",a.serialized_data.dealbasicinfo.address]]}),t.value_requests.push({range:C+"!E"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[[a.serialized_data.dealbasicinfo.postcode]]}),t.requests.push(r.makeboldandvaligntop(0,t.cur_row,0,1)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const c=t.cur_row;t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["Room","Item","Description","Labour","Materials"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,0,5));let l=0;for(;l<Fr;)t.cur_row=t.cur_row+1,l<ie.length&&t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["",ie[l],"","",""]]}),l++;t.cur_row=t.cur_row+1;const i=t.cur_row;t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","Total","=sum(D"+(c+1).toString()+":D"+(t.cur_row-1).toString()+")","=sum(E"+(c+1).toString()+":E"+(t.cur_row-1).toString()+")"]]}),t.requests.push(r.makeboldandvaligntop(t.cur_row-1,t.cur_row,2,5)),t.requests.push(r.formatcurrency(c,t.cur_row,3,5)),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1;const _=t.cur_row;t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Gross Total","=sum(D"+i.toString()+":E"+i.toString()+")"]]}),t.cur_row=t.cur_row+1;const f=t.cur_row;return t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Contingency","=E"+_.toString()+"*0.1"]]}),t.cur_row=t.cur_row+1,t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","VAT","=sum(E"+_.toString()+":E"+f.toString()+")*0.2"]]}),t.cur_row=t.cur_row+1,t.cur_row=t.cur_row+1,t.value_requests.push({range:C+"!A"+t.cur_row.toString()+":E"+t.cur_row.toString(),values:[["","","","Net Total","=sum(E"+_.toString()+":E"+(t.cur_row-22).toString()+")"]]}),t.requests.push(r.makeboldandvaligntopandsetfontsize(t.cur_row-1,t.cur_row,3,5,13)),t.requests.push(r.formatcurrency(_,t.cur_row,4,5)),{value_requests:t.value_requests,requests:t.requests}}var Lr={sheet_name:C,get_sheet_values:Or};const Ur=j({name:"SaveToGoogleSheetCompoennt",emits:["apiaddweblink","activity_log"],props:["serialized_data","patch","refurb_cost_total","stampduty_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost","finance_bridgeamount","gdv_total","refinance_costs"],setup(){return{backend_connection_store:U()}},data(){return{}},computed:{security_role_cansave(){return this.backend_connection_store.security_role_cansave}},methods:{click_export(){H.show();const e=google.accounts.oauth2.initTokenClient({client_id:this.$rjmgclientid,scope:this.$rjmgscopes,callback:this.execute_export});gapi.client.getToken()===null?e.requestAccessToken({prompt:"consent"}):e.requestAccessToken({prompt:""})},execute_export(){try{gapi.client.sheets.spreadsheets.create({properties:{title:"evernetproperties.com-"+this.patch.name+"-"+this.serialized_data.dealbasicinfo.address}}).then(e=>{this.spreadsheets_batchupdate(e.result)})}catch(e){this.sheet_api_error_handler(e);return}},spreadsheets_batchupdate(e){let a={Main:e.sheets[0].properties.sheetId},s=[];s.push({updateSheetProperties:{properties:{sheetId:e.sheets[0].properties.sheetId,title:"Main"},fields:"title"}});let r=[Ir,Vr];typeof this.serialized_data.vision.strategy!="undefined"&&this.serialized_data.vision.strategy.hmo&&(r.push(Mr),r.push(Nr)),r.push(Lr);let t=0;for(;t<r.length;)s.push({addSheet:{properties:{title:r[t].sheet_name}}}),t++;s=s.concat(oe.get_sheet_main(e,this,a));const c={requests:s};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:c}).then(l=>{const i=l.result;console.log("spreadsheet Batch Update result",l.result.replies),l.result.replies.forEach(function(_){if(typeof _.addSheet!="undefined"){let f=0;for(;f<r.length;)_.addSheet.properties.title===r[f].sheet_name&&(a[r[f].sheet_name]=_.addSheet.properties.sheetId),f++}}),this.spreadsheets_batchupdate_after_all_sheets_added(e,a,r)})}catch(l){this.sheet_api_error_handler(l);return}},spreadsheets_batchupdate_after_all_sheets_added(e,a,s){let r=[],t=[];t=t.concat(oe.get_sheet_main_values(e,this,a));let c=0;for(;c<s.length;){let i=s[c].get_sheet_values(e,this,a);r=r.concat(i.requests),t=t.concat(i.value_requests),c++}if(r.length===0){console.log("No requests required"),this.spreadsheets_values_batchupdate(e,a,t);return}const l={requests:r};try{gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.spreadsheetId,resource:l}).then(i=>{const _=i.result;console.log("spreadsheet Batch Update after all sheets added result",i.result.replies),this.spreadsheets_values_batchupdate(e,a,t)})}catch(i){this.sheet_api_error_handler(i);return}},spreadsheets_values_batchupdate(e,a,s){const r={data:s,valueInputOption:"USER_ENTERED"};try{gapi.client.sheets.spreadsheets.values.batchUpdate({spreadsheetId:e.spreadsheetId,resource:r}).then(t=>{const c=t.result;console.log(`${c.totalUpdatedCells} cells updated.`),this.sheet_final_complete(e)})}catch(t){this.sheet_api_error_handler(t);return}},open_sheet(e){window.open(e.spreadsheetUrl,"_blank").focus()},sheet_api_error_handler(e){H.hide(),console.log("Error-"+e.message),I.create({color:"negative",message:"Export to google sheets failed "+e.message,timeout:2e3})},sheet_final_complete(e){this.$emit("apiaddweblink",{url:e.spreadsheetUrl,displaytext:"My Calc"});const a={type:"admin",text:"Generated google sheet",head_notes:"Calculation"};this.$emit("activity_log",a),this.open_sheet(e),H.hide()}}}),Gr=n("div",{class:"text-h6"},"Export to Spreadsheet",-1),Wr=n("div",{class:"text-subtitle2"},"Export figures into a google docs spreadsheet.",-1),Qr=n("div",{class:"textdiv"}," This feature will generate a spreadsheet containing all the current values for this project and output it to a document in your google drive. ",-1);function Hr(e,a,s,r,t,c){return e.security_role_cansave?(g(),v(z,{key:0,inline:"",class:"q-ma-sm card-style featurecard col-grow"},{default:u(()=>[o(k,null,{default:u(()=>[Gr,Wr]),_:1}),o(k,null,{default:u(()=>[n("div",null,[o($,{color:"primary",icon:"save",label:"Export to google sheets",onClick:e.click_export},null,8,["onClick"])]),Qr]),_:1})]),_:1})):b("",!0)}var Yr=P(Ur,[["render",Hr]]);const Kr=j({name:"CalcBrrToFlip",components:{GdvCard:Oe,PurchasePrice:Le,RefurbCost:Ue,StampDuty:Ge,OtherCosts:We,DealSummary:Nt,Finance:Qe,Vision:$t,DealRating:nr,Refinance:Rt,DealBasicInfo:Sr,ProjectSerializer:et,SaveToGoogleSheet:Yr,ActivityLog:tt,BrrCalcToolbar:wt,Workflow:at,FlipDealRating:He,Todos:Ee,Location:Ne},setup(){const e=U(),a=x();return{backend_connection_store:e,dataCachesStore:a}},data(){return{tab:"main",isMounted:!1,purchaserange:{min:18e4,max:19e4},loaded_project_id:""}},watch:{loaded_project_id:{handler(e,a){this.projectidchanged(e)},immediate:!0}},computed:{project_type(){return it.project_type_constants.project_type_purchase},is_saved_project_with_id(){return this.loaded_project_id!==""},ever_saved(){return this.isMounted?this.security_role_cansave?this.$refs.BrrCalcToolbar.ever_saved:(console.log("WARNING ever_saved checked when cansave is false"),!1):!1},reason_project_not_savable(){return this.isMounted?this.$refs.DealBasicInfo.reason_project_not_savable:""},security_role_cansave(){return this.backend_connection_store.security_role_cansave},is_valid_input(){return this.isMounted?!(!this.$refs.PurchasePrice.isValid||!this.$refs.GdvCard.isValid):!0},deal_summary_final_bal(){return this.isMounted?this.$refs.DealSummary.final_bal:{best:0,worst:0}},finance_refinance(){return this.isMounted?this.$refs.Refinance.get_refinance:{userefinance:!1,ltv:{min:75,max:75}}},caculated_loan_details(){return this.isMounted?this.$refs.Finance.caculated_loan_details:[]},finance_bridgecost(){return this.isMounted?this.$refs.Finance.bridgecost:{best:0,worst:0}},finance_bridgeamount(){return this.isMounted?this.$refs.Finance.bridgeamount:{best:0,worst:0}},finance_totalmoneyneeded(){return this.isMounted?this.$refs.Finance.totalmoneyneeded:{best:0,worst:0}},finance_in_items(){return this.isMounted?this.$refs.Finance.finance_in_items:[]},finance_in_items_without_cash(){return this.isMounted?this.$refs.Finance.finance_in_items_without_cash:[]},finance_during_items(){return this.isMounted?this.$refs.Finance.finance_during_items:[]},finance_out_items(){return this.isMounted?this.$refs.Finance.finance_out_items:[]},refinance_out_items(){return this.isMounted?this.$refs.Refinance.refinance_out_items:[]},refinance_costs(){return this.isMounted?this.$refs.Refinance.refinance_costs:[]},purchase_items(){return this.isMounted?this.$refs.PurchasePrice.purchase_items:[]},stampduty_items(){return this.isMounted?this.$refs.StampDuty.stampduty_items:[]},othercosts_items(){return this.isMounted?this.$refs.OtherCosts.othercosts_items:[]},othercosts_items_detail(){return this.isMounted?this.$refs.OtherCosts.othercosts_items_detail:[]},refurb_cost_items(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_items:[]},refurb_cost_total(){return this.isMounted?this.$refs.RefurbCost.refurb_cost_total:[]},refurbmonths(){return this.isMounted?this.$refs.RefurbCost.refurbmonths:[]},stampduty_total(){return this.isMounted?this.$refs.StampDuty.stampduty:[]},othercosts_total(){return this.isMounted?this.$refs.OtherCosts.total:[]},gdv_total(){return this.isMounted?this.$refs.GdvCard.total:[]},serialized_data(){return this.security_role_cansave?this.isMounted?{dealbasicinfo:this.$refs.DealBasicInfo.serializer_card_data,vision:this.$refs.Vision.serializer_card_data,gdvcard:this.$refs.GdvCard.serializer_card_data,purchaseprice:this.$refs.PurchasePrice.serializer_card_data,refurbcost:this.$refs.RefurbCost.serializer_card_data,stampduty:this.$refs.StampDuty.serializer_card_data,othercosts:this.$refs.OtherCosts.serializer_card_data,finance:this.$refs.Finance.serializer_card_data,refinance:this.$refs.Refinance.serializer_card_data}:{}:(console.log("WARNING serialized_data checked when cansave is false"),{})},patch(){return this.isMounted?this.security_role_cansave?this.$refs.DealBasicInfo.patch:(console.log("WARNING patch method called when cansave is false"),{id:"notset",name:"Not Set"}):{id:"notset",name:"Not Set"}}},methods:{projectidchanged(e){e!==""&&this.$refs.BrrCalcToolbar.set_project_id(e)},patchidchanged(e){this.$refs.BrrCalcToolbar.set_patch_id(e)},sellingagentidchanged(e){this.$refs.BrrCalcToolbar.set_selling_agent_id(e)},navigate_away(e){const a=this;if(!this.$refs.BrrCalcToolbar.is_project_changed){this.$router.push(e.dest);return}this.$refs.BrrCalcToolbar.click_save_btn(),setTimeout(function(){a.navigate_away(e)},100)},createtodo(e){const a=this,s={ok:function(r){a.$refs.todos.add_single_todo(r.data.todo),I.create({color:"bg-grey-2",message:"Todo added",timeout:2e3,color:"positive"})},error:function(r){I.create({color:"bg-grey-2",message:r.message,timeout:2e3,color:"negative"})}};a.dataCachesStore.invalidate({object_type:"projects",object_id:a.loaded_project_id}),a.dataCachesStore.invalidate({object_type:"patches",object_id:a.serialized_data.dealbasicinfo.patch_id}),a.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/projects/"+a.loaded_project_id+"/todos",method:"POST",data:e,callback:s})},apiaddweblink(e){return this.$refs.DealBasicInfo.apiaddweblink(e)},activity_log(e){if(!this.isMounted){console.log("ERROR - trying to log activity unmounted",e);return}this.$refs.ActivityLog.log_activity(e)},projectchanged(e){if(console.log("BrrCalc page received project changed from ",e),!this.security_role_cansave)return!1;if(!this.isMounted){console.log("WARNING = projectchanged called when mounted is false");return}if(typeof this.$refs.BrrCalcToolbar=="undefined")return console.log("WARNING = projectchanged called when BrrCalcToolbar is undefined"),!1;e==="ActivityLog:log_activity:forcesave"?this.$refs.BrrCalcToolbar.set_changed_true({autosave_seconds:0}):this.$refs.BrrCalcToolbar.set_changed_true()},click_save_btn(){this.$refs.BrrCalcToolbar.click_save_btn()},save_project(){this.$refs.ProjectSerializer.save_project({dict_of_card_info:this.serialized_data,activity_log:this.$refs.ActivityLog.serializer_card_data,workflow:this.$refs.Workflow.serializer_card_data,patch_id:this.serialized_data.dealbasicinfo.patch_id,location:this.$refs.Location.serializer_card_data,passthroughdata:void 0})},load_project_into_cards(e){this.$refs.ProjectSerializer.serializer_load_data(e),this.$refs.DealBasicInfo.serializer_load_data(e.sub_section_details.dealbasicinfo),typeof e.sub_section_details.vision!="undefined"&&this.$refs.Vision.serializer_load_data(e.sub_section_details.vision),typeof e.sub_section_details.gdvcard!="undefined"&&this.$refs.GdvCard.serializer_load_data(e.sub_section_details.gdvcard),typeof e.sub_section_details.purchaseprice!="undefined"&&this.$refs.PurchasePrice.serializer_load_data(e.sub_section_details.purchaseprice),typeof e.sub_section_details.refurbcost!="undefined"&&this.$refs.RefurbCost.serializer_load_data(e.sub_section_details.refurbcost),typeof e.sub_section_details.stampduty!="undefined"&&this.$refs.StampDuty.serializer_load_data(e.sub_section_details.stampduty),typeof e.sub_section_details.othercosts!="undefined"&&this.$refs.OtherCosts.serializer_load_data(e.sub_section_details.othercosts),typeof e.sub_section_details.finance!="undefined"&&this.$refs.Finance.serializer_load_data(e.sub_section_details.finance),typeof e.sub_section_details.refinance!="undefined"&&this.$refs.Refinance.serializer_load_data(e.sub_section_details.refinance),typeof e.location!="undefined"&&this.$refs.Location.serializer_load_data(e.location),this.$refs.ActivityLog.serializer_load_data(e.activity_log),this.$refs.Workflow.serializer_load_data(e.workflow),this.$refs.BrrCalcToolbar.serializer_load_data({}),this.$refs.todos.serializer_load_data(e.todos)},save_project_complete({success:e,response:a,passthroughdata:s}){e&&(this.loaded_project_id=a.data.id),this.$refs.BrrCalcToolbar.save_project_complete_notification({success:e,response:a})},load_project_api_fail(e){I.create({color:"bg-grey-2",message:"Error loading project "+e,timeout:2e3,color:"negative"}),this.load_complete()},load_project_api_success(e){this.loaded_project_id=e.data.id,this.load_project_into_cards(e.data),I.create({color:"bg-grey-2",message:"Project Loaded",timeout:2e3,color:"positive"}),this.load_complete()},load_complete(){const e=this;setTimeout(function(){e.isMounted=!0},105)},call_load_api(){const e=this,a={ok:e.load_project_api_success,error:e.load_project_api_fail};e.dataCachesStore.get({backend_connection_store:e.backend_connection_store,object_type:"projects",object_id:e.$route.query.projectid,skip_cache:!1,callback:a})}},mounted(){const e=this;if(typeof e.$route.query.projectid=="undefined"){if(e.load_complete(),typeof e.$route.query.patchid!="undefined"){if(!e.security_role_cansave)return;this.$refs.DealBasicInfo.select_patch_by_id(e.$route.query.patchid)}return}if(e.security_role_cansave){e.call_load_api();return}setTimeout(function(){e.call_load_api()},1e3)}}),Jr={class:"main-page fit col wrap justify-center items-center content-center"},Xr={key:0},Zr=n("h1",null,"Project Analysis",-1),xr=[Zr],es={key:1},ts=n("h1",null,"Buy Refurbish Rent Refinance Calculator",-1),as=[ts],rs={class:"row"},ss={class:"row"};function ns(e,a,s,r,t,c){const l=p("BrrCalcToolbar"),i=p("DealBasicInfo"),_=p("Vision"),f=p("GdvCard"),h=p("PurchasePrice"),q=p("RefurbCost"),R=p("StampDuty"),S=p("OtherCosts"),he=p("Finance"),ge=p("Refinance"),fe=p("DealSummary"),pe=p("FlipDealRating"),me=p("DealRating"),we=p("Location"),ve=p("ProjectSerializer"),be=p("Workflow"),ye=p("Todos"),Se=p("ActivityLog"),ke=p("SaveToGoogleSheet");return g(),v(Ce,{class:"flex"},{default:u(()=>[n("div",Jr,[e.security_role_cansave?(g(),T("div",Xr,xr)):b("",!0),e.security_role_cansave?b("",!0):(g(),T("div",es,as)),e.security_role_cansave?(g(),v(l,{key:2,ref:"BrrCalcToolbar",reason_project_not_savable:e.reason_project_not_savable,is_saved_project_with_id:e.is_saved_project_with_id,onActivity_log:e.activity_log,onSaveproject:e.save_project,onCreatetodo:e.createtodo},null,8,["reason_project_not_savable","is_saved_project_with_id","onActivity_log","onSaveproject","onCreatetodo"])):b("",!0),e.security_role_cansave?(g(),v($e,{key:3,modelValue:e.tab,"onUpdate:modelValue":a[0]||(a[0]=Q=>e.tab=Q),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[o(ee,{name:"main",label:"Main"}),o(ee,{name:"project",label:"Project"})]),_:1},8,["modelValue"])):b("",!0),O(n("div",rs,[e.security_role_cansave?(g(),v(i,{key:0,ref:"DealBasicInfo",ever_saved:e.ever_saved,loaded_project_id:e.loaded_project_id,onProjectchanged:e.projectchanged,onNavigate_away:e.navigate_away,onPatchidchanged:e.patchidchanged,onSellingagentidchanged:e.sellingagentidchanged},null,8,["ever_saved","loaded_project_id","onProjectchanged","onNavigate_away","onPatchidchanged","onSellingagentidchanged"])):b("",!0),o(_,{ref:"Vision",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),o(f,{ref:"GdvCard",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),o(h,{ref:"PurchasePrice",purchaserange:e.purchaserange,"onUpdate:purchaserange":a[1]||(a[1]=Q=>e.purchaserange=Q),onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),o(q,{ref:"RefurbCost",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),o(R,{ref:"StampDuty",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),o(S,{ref:"OtherCosts",purchaserange:e.purchaserange,onProjectchanged:e.projectchanged},null,8,["purchaserange","onProjectchanged"]),o(he,{ref:"Finance",purchaserange:e.purchaserange,refurb_cost_total:e.refurb_cost_total,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurbmonths:e.refurbmonths,gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["purchaserange","refurb_cost_total","stampduty_total","othercosts_total","refurbmonths","gdv_total","onProjectchanged"]),o(ge,{ref:"Refinance",gdv_total:e.gdv_total,onProjectchanged:e.projectchanged},null,8,["gdv_total","onProjectchanged"]),o(fe,{ref:"DealSummary",purchaserange:e.purchaserange,finance_in_items:e.finance_in_items,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,refinance_out_items:e.refinance_out_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items","finance_out_items","finance_during_items","refinance_out_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),o(pe,{ref:"FlipDealRating",purchaserange:e.purchaserange,finance_in_items_without_cash:e.finance_in_items_without_cash,finance_out_items:e.finance_out_items,finance_during_items:e.finance_during_items,purchase_items:e.purchase_items,stampduty_items:e.stampduty_items,othercosts_items:e.othercosts_items,refurb_cost_items:e.refurb_cost_items,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_in_items_without_cash","finance_out_items","finance_during_items","purchase_items","stampduty_items","othercosts_items","refurb_cost_items","gdv_total","refurbmonths","is_valid_input"]),o(me,{ref:"DealRating",purchaserange:e.purchaserange,finance_totalmoneyneeded:e.finance_totalmoneyneeded,deal_summary_final_bal:e.deal_summary_final_bal,finance_refinance:e.finance_refinance,gdv_total:e.gdv_total,refurbmonths:e.refurbmonths,stampduty_total:e.stampduty_total,othercosts_total:e.othercosts_total,refurb_cost_total:e.refurb_cost_total,is_valid_input:e.is_valid_input},null,8,["purchaserange","finance_totalmoneyneeded","deal_summary_final_bal","finance_refinance","gdv_total","refurbmonths","stampduty_total","othercosts_total","refurb_cost_total","is_valid_input"]),o(we,{ref:"Location",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"]),e.security_role_cansave?(g(),v(ve,{key:1,ref:"ProjectSerializer",onSaveprojectcomplete:e.save_project_complete,project_type:e.project_type},null,8,["onSaveprojectcomplete","project_type"])):b("",!0)],512),[[te,e.tab==="main"]]),O(n("div",ss,[e.security_role_cansave?(g(),v(be,{key:0,ref:"Workflow",onProjectchanged:e.projectchanged,onActivity_log:e.activity_log,onClick_save_btn:e.click_save_btn},null,8,["onProjectchanged","onActivity_log","onClick_save_btn"])):b("",!0),e.security_role_cansave?(g(),v(ye,{key:1,ref:"todos"},null,512)):b("",!0),e.security_role_cansave?(g(),v(Se,{key:2,ref:"ActivityLog",onProjectchanged:e.projectchanged},null,8,["onProjectchanged"])):b("",!0),e.security_role_cansave?(g(),v(ke,{key:3,ref:"SaveToGoogleSheet",serialized_data:e.serialized_data,patch:e.patch,stampduty_total:e.stampduty_total,refurb_cost_total:e.refurb_cost_total,othercosts_items_detail:e.othercosts_items_detail,caculated_loan_details:e.caculated_loan_details,finance_bridgecost:e.finance_bridgecost,finance_bridgeamount:e.finance_bridgeamount,refinance_costs:e.refinance_costs,gdv_total:e.gdv_total,onApiaddweblink:e.apiaddweblink,onActivity_log:e.activity_log},null,8,["serialized_data","patch","stampduty_total","refurb_cost_total","othercosts_items_detail","caculated_loan_details","finance_bridgecost","finance_bridgeamount","refinance_costs","gdv_total","onApiaddweblink","onActivity_log"])):b("",!0)],512),[[te,e.tab==="project"]])])]),_:1})}var Ds=P(Kr,[["render",ns]]);export{Ds as default};
