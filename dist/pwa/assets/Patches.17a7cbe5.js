import{_ as v,d as w,r as b,o as l,c as y,w as m,e as s,K as i,M as f,a as u,ag as C,t as c,f as j,L as p,ar as h,a8 as B,a9 as T}from"./index.152c68fe.js";import{Q as P}from"./QPage.452239c0.js";import{u as R}from"./backend_connection.89bc65ad.js";import{C as S}from"./CommonBRRToolLink.0d6131c1.js";import{W as k}from"./Workflow_main.48c4f03b.js";import"./axios.6e1fcf85.js";var $="/assets/patch_icon.880b248a.png";const L=w({name:"ToolsCansavePatchesPage",components:{CommonBRRToolLink:S},setup(){return{backend_connection_store:R()}},data(){return{patches_data:{}}},computed:{user_profile(){return this.backend_connection_store.user_profile}},methods:{todo_text(e){let o=0,r=0,a=0;return Object.keys(e.detail.todogroups).forEach(function(t){o=o+e.detail.todogroups[t].due,r=r+e.detail.todogroups[t].not_due.length,a=a+e.detail.todogroups[t].done}),o.toString()+"/"+(r+o).toString()+" ("+a.toString()+")"},num_todos(e){let o=0,r=0,a=0;return Object.keys(e.detail.todogroups).forEach(function(t){o=o+e.detail.todogroups[t].due,r=r+e.detail.todogroups[t].not_due.length,a=a+e.detail.todogroups[t].done}),o+r+a},get_workflow_name(e){return k.workflows[e].name},get_workflow_stage_name(e,o){return k.workflows[e].stages[o].name},click_patch(e){this.$router.push("/tools/cansave/patches/"+e)},click_brrr_card(){this.$router.push("/tools/brrcalc")},recursive_load_project_details(){const e=this.patches_data.filter(function(t){return t.loaded===!1});if(e.length===0)return;const o=e[0],r=this,a={ok:function(t){o.loaded=!0,o.loadsuccess=!0,o.detail=t.data,r.recursive_load_project_details()},error:function(t){o.loaded=!0,o.loadsuccess=!1,r.recursive_load_project_details()}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/patches/"+o.from_user_profile.id,method:"GET",data:void 0,callback:a})}},mounted(){this.patches_data=this.user_profile.patches.map(function(e){return{from_user_profile:e,loaded:!1,loadsuccess:!0,detail:{}}}),this.recursive_load_project_details()}}),Q=s("h1",null,"Select Patch",-1),V={class:"text-h6"},E={class:"row"},N=s("div",null,[s("img",{alt:"Item Picture",src:$,class:"tool-picture"})],-1),O={class:"col q-ma-sm"},q={align:"right"},x={key:0},D={class:"workflow_stage_block"},I={key:0,class:"todo_stage_block"},U=s("h1",null,"Todos",-1),W={key:0},A=s("div",null,"You have not saved any projects. Use the BRR tool to create your first project:",-1);function F(e,o,r,a,t,G){const g=b("CommonBRRToolLink");return l(),y(P,{class:"flex flex-center"},{default:m(()=>[s("div",null,[Q,(l(!0),i(p,null,f(e.patches_data,n=>(l(),i("div",{key:n},[u(T,{inline:"",class:"q-ma-sm card-style tool-card",onClick:d=>e.click_patch(n.from_user_profile.id)},{default:m(()=>[u(C,null,{default:m(()=>[s("div",V,c(n.from_user_profile.name),1),s("div",E,[N,s("div",O,[s("div",q,[j(" View your projects in "+c(n.from_user_profile.name)+". ",1),n.loaded?(l(),i("div",x,[s("div",D,[(l(!0),i(p,null,f(Object.keys(n.detail.workflow_lookup),d=>(l(),i("div",{key:d},[s("h1",null,c(e.get_workflow_name(d)),1),(l(!0),i(p,null,f(Object.keys(n.detail.workflow_lookup[d]),_=>(l(),i("div",{key:_},c(e.get_workflow_stage_name(d,_))+": "+c(n.detail.workflow_lookup[d][_].length),1))),128))]))),128))]),e.num_todos(n)>0?(l(),i("div",I,[U,s("div",null,"Due: "+c(e.todo_text(n)),1)])):h("",!0)])):h("",!0),u(B,{round:"",color:"primary",icon:"info"})])])])]),_:2},1024)]),_:2},1032,["onClick"])]))),128)),e.user_profile.patches.length===0?(l(),i("div",W,[A,u(g)])):h("",!0)])]),_:1})}var X=v(L,[["render",F]]);export{X as default};
