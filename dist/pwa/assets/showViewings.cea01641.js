import{_ as w,d as g,o as i,c as k,w as c,e as r,K as d,f as y,a as u,Q as p,L as f,M as b,O as C,ae as $,t as m,aa as B}from"./index.15dd544b.js";import{Q}from"./QPage.eb9d952a.js";import{u as V}from"./use-quasar.2ce1b6fe.js";import{u as P}from"./backend_connection.a421ea6a.js";import"./axios.6e1fcf85.js";const _="2",h="2",v="3";function S(e){var t=0,o=0;return typeof e.detail.workflow_lookup[_]!="undefined"&&(typeof e.detail.workflow_lookup[_][h]!="undefined"&&(t=e.detail.workflow_lookup[_][h].length),typeof e.detail.workflow_lookup[_][v]!="undefined"&&(o=e.detail.workflow_lookup[_][v].length)),{num:t+o,num_arranged:t,num_ready:o}}const T=g({name:"ShowViewingsPage",setup(){const e=V(),t=P();return{q:e,backend_connection_store:t}},data(){return{patches_data:[]}},computed:{total_number_of_viewings(){return this.display_array.filter(function(e){return e.id==="all"})[0].num},display_array(){var e=[],t=0,o=0,l=0;return this.patches_data.map(function(a){if(a.loaded&&a.loadsuccess){const n=S(a);n.num>0&&(t+=n.num,o+=n.num_arranged,l+=n.num_ready,e.push({id:a.from_user_profile.id,title:a.from_user_profile.name,num:n.num,num_arranged:n.num_arranged,num_ready:n.num_ready}))}else e.push({id:a.from_user_profile.id,title:a.from_user_profile.name,num:1,num_arranged:1,num_ready:1})}),e.unshift({id:"all",title:"All Patches",num:t,num_arranged:o,num_ready:l}),e},user_profile(){return this.backend_connection_store.user_profile}},methods:{recursive_load_patch_details(){const e=this.patches_data.filter(function(a){return a.loaded===!1});if(e.length===0)return;const t=e[0],o=this,l={ok:function(a){t.loaded=!0,t.loadsuccess=!0,t.detail=a.data,o.recursive_load_patch_details()},error:function(a){t.loaded=!0,t.loadsuccess=!1,o.recursive_load_patch_details()}};this.backend_connection_store.call_api({apiprefix:"privateUserAPIPrefix",url:"/patches/"+t.from_user_profile.id,method:"GET",data:void 0,callback:l})}},mounted(){this.patches_data=this.user_profile.patches.map(function(e){return{from_user_profile:e,loaded:!1,loadsuccess:!0,detail:{}}}),this.recursive_load_patch_details()}}),q={class:"fit column wrap justify-start items-start content-center"},L=r("h2",null,"Viewings for Rental Leads",-1),N=r("p",null,"List of all deals that need to be viewed",-1),j={key:0,class:"flex"},A={class:"text-h6"},E={key:1,class:"flex"},D={class:"text-h6"},F={class:"row"},G={key:0,class:"col q-ma-sm"};function I(e,t,o,l,a,n){return i(),k(Q,{class:"flex flex-center"},{default:c(()=>[r("div",q,[L,N,e.total_number_of_viewings===0?(i(),d("div",j,[r("div",A,[y(" You have no outstanding viewings. "),u(p,{color:"primary",label:"Back to tools",onClick:t[0]||(t[0]=s=>e.$router.push("/tools"))})])])):f("",!0),e.total_number_of_viewings>0?(i(),d("div",E,[(i(!0),d(b,null,C(e.display_array,s=>(i(),d("div",{key:s.id},[u(B,{inline:"",class:"q-ma-sm card-style",onClick:K=>e.$router.push("/tools/rentproject/showviewingsforpatch?patchid="+s.id)},{default:c(()=>[u($,null,{default:c(()=>[r("div",D,m(s.title),1),r("div",F,[s.num!==0?(i(),d("div",G,[r("div",null,m(s.num_arranged)+" viewings arranged",1),r("div",null,m(s.num_ready)+" ready to view",1),r("div",null,[u(p,{color:"primary",icon:"home",label:"Show"})])])):f("",!0)])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])):f("",!0)])]),_:1})}var z=w(T,[["render",I]]);export{z as default};
